<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.16: http://docutils.sourceforge.net/" />
<title>CLAP (CLever Audio Plugin)</title>
<style type="text/css">

.document {
    width: 755px;
}

.title {
    text-align: center;
}

.subtitle {
    text-align: center;
}

.reference, .toc-backref {
    text-decoration: none;
    color: #942;
}

.reference:hover, .toc-backref:hover {
    color: #294;
}

tt.docutils {
    color: #237;
    font-size: 100%;
}

</style>
<style type="text/css">

.code .hll { background-color: #49483e }
.code  { background: #272822; color: #f8f8f2 }
.code .c { color: #75715e } /* Comment */
.code .err { color: #960050; background-color: #1e0010 } /* Error */
.code .k { color: #66d9ef } /* Keyword */
.code .l { color: #ae81ff } /* Literal */
.code .n { color: #f8f8f2 } /* Name */
.code .o { color: #f92672 } /* Operator */
.code .p { color: #f8f8f2 } /* Punctuation */
.code .cm { color: #A56E27 } /* Comment.Multiline */
.code .cp { color: #B5A869 } /* Comment.Preproc */
.code .c1 { color: #A56E27 } /* Comment.Single */
.code .cs { color: #A56E27 } /* Comment.Special */
.code .ge { font-style: italic } /* Generic.Emph */
.code .gs { font-weight: bold } /* Generic.Strong */
.code .kc { color: #66d9ef } /* Keyword.Constant */
.code .kd { color: #66d9ef } /* Keyword.Declaration */
.code .kn { color: #f92672 } /* Keyword.Namespace */
.code .kp { color: #66d9ef } /* Keyword.Pseudo */
.code .kr { color: #66d9ef } /* Keyword.Reserved */
.code .kt { color: #66d9ef } /* Keyword.Type */
.code .ld { color: #e6db74 } /* Literal.Date */
.code .m { color: #ae81ff } /* Literal.Number */
.code .s { color: #e6db74 } /* Literal.String */
.code .na { color: #a6e22e } /* Name.Attribute */
.code .nb { color: #f8f8f2 } /* Name.Builtin */
.code .nc { color: #a6e22e } /* Name.Class */
.code .no { color: #66d9ef } /* Name.Constant */
.code .nd { color: #a6e22e } /* Name.Decorator */
.code .ni { color: #f8f8f2 } /* Name.Entity */
.code .ne { color: #a6e22e } /* Name.Exception */
.code .nf { color: #a6e22e } /* Name.Function */
.code .nl { color: #f8f8f2 } /* Name.Label */
.code .nn { color: #f8f8f2 } /* Name.Namespace */
.code .nx { color: #a6e22e } /* Name.Other */
.code .py { color: #f8f8f2 } /* Name.Property */
.code .nt { color: #f92672 } /* Name.Tag */
.code .nv { color: #f8f8f2 } /* Name.Variable */
.code .ow { color: #f92672 } /* Operator.Word */
.code .w { color: #f8f8f2 } /* Text.Whitespace */
.code .mf { color: #ae81ff } /* Literal.Number.Float */
.code .mh { color: #ae81ff } /* Literal.Number.Hex */
.code .mi { color: #ae81ff } /* Literal.Number.Integer */
.code .mo { color: #ae81ff } /* Literal.Number.Oct */
.code .sb { color: #e6db74 } /* Literal.String.Backtick */
.code .sc { color: #e6db74 } /* Literal.String.Char */
.code .sd { color: #e6db74 } /* Literal.String.Doc */
.code .s2 { color: #e6db74 } /* Literal.String.Double */
.code .se { color: #ae81ff } /* Literal.String.Escape */
.code .sh { color: #e6db74 } /* Literal.String.Heredoc */
.code .si { color: #e6db74 } /* Literal.String.Interpol */
.code .sx { color: #e6db74 } /* Literal.String.Other */
.code .sr { color: #e6db74 } /* Literal.String.Regex */
.code .s1 { color: #e6db74 } /* Literal.String.Single */
.code .ss { color: #e6db74 } /* Literal.String.Symbol */
.code .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
.code .vc { color: #f8f8f2 } /* Name.Variable.Class */
.code .vg { color: #f8f8f2 } /* Name.Variable.Global */
.code .vi { color: #f8f8f2 } /* Name.Variable.Instance */
.code .il { color: #ae81ff } /* Literal.Number.Integer.Long */

</style>
</head>
<body>
<div class="document" id="clap-clever-audio-plugin">
<h1 class="title">CLAP (CLever Audio Plugin)</h1>
<h2 class="subtitle" id="a-free-audio-plugin-format">A free audio plugin format</h2>

<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#goals" id="id1">Goals</a></li>
<li><a class="reference internal" href="#specification" id="id2">Specification</a><ul>
<li><a class="reference internal" href="#how-to-read-the-specification" id="id3">How to read the specification</a></li>
<li><a class="reference internal" href="#encoding" id="id4">Encoding</a></li>
<li><a class="reference internal" href="#c-exceptions" id="id5">C++ exceptions</a></li>
<li><a class="reference internal" href="#multi-threading" id="id6">Multi-Threading</a></li>
<li><a class="reference internal" href="#naming-conventions" id="id7">Naming conventions</a></li>
<li><a class="reference internal" href="#plugins-location" id="id8">Plugins location</a><ul>
<li><a class="reference internal" href="#common" id="id9">Common</a></li>
<li><a class="reference internal" href="#installation-paths" id="id10">Installation Paths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#instantiate-a-plugin" id="id11">Instantiate a plugin</a><ul>
<li><a class="reference internal" href="#release-a-plugin" id="id12">Release a plugin</a></li>
<li><a class="reference internal" href="#plugin-description" id="id13">Plugin description</a></li>
<li><a class="reference internal" href="#extension-system" id="id14">Extension system</a></li>
<li><a class="reference internal" href="#audio-ports-configuration" id="id15">Audio ports configuration</a><ul>
<li><a class="reference internal" href="#standard-channel-mappings" id="id16">Standard channel mappings</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#activation" id="id17">Activation</a></li>
<li><a class="reference internal" href="#processing" id="id18">Processing</a><ul>
<li><a class="reference internal" href="#audio-buffers" id="id19">Audio buffers</a></li>
<li><a class="reference internal" href="#events" id="id20">Events</a><ul>
<li><a class="reference internal" href="#parameters-events" id="id21">Parameters Events</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameters" id="id22">Parameters</a><ul>
<li><a class="reference internal" href="#types" id="id23">Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphical-user-interface" id="id24">Graphical User Interface</a><ul>
<li><a class="reference internal" href="#showing-the-gui" id="id25">Showing the GUI</a></li>
<li><a class="reference internal" href="#sending-events-to-the-host" id="id26">Sending events to the host</a></li>
<li><a class="reference internal" href="#hiding-the-gui" id="id27">Hiding the GUI</a></li>
<li><a class="reference internal" href="#embedding" id="id28">Embedding</a><ul>
<li><a class="reference internal" href="#example-on-windows" id="id29">Example on Windows</a></li>
<li><a class="reference internal" href="#resizing-the-window" id="id30">Resizing the window</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#save-and-restore-plugin-s-state" id="id31">Save and restore plugin's state</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id32">References</a><ul>
<li><a class="reference internal" href="#clap-clap-h" id="id33">clap/clap.h</a></li>
<li><a class="reference internal" href="#clap-ext-state-h" id="id34">clap/ext/state.h</a></li>
<li><a class="reference internal" href="#clap-ext-audio-ports-h" id="id35">clap/ext/audio-ports.h</a></li>
<li><a class="reference internal" href="#clap-ext-params-h" id="id36">clap/ext/params.h</a></li>
<li><a class="reference internal" href="#clap-ext-gui-h" id="id37">clap/ext/gui.h</a></li>
<li><a class="reference internal" href="#clap-ext-gui-win32-h" id="id38">clap/ext/gui-win32.h</a></li>
<li><a class="reference internal" href="#clap-ext-gui-x11-h" id="id39">clap/ext/gui-x11.h</a></li>
<li><a class="reference internal" href="#clap-ext-gui-cocoa-h" id="id40">clap/ext/gui-cocoa.h</a></li>
<li><a class="reference internal" href="#clap-ext-draft-key-name-h" id="id41">clap/ext/draft/key-name.h</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="goals">
<h1><a class="toc-backref" href="#id1">Goals</a></h1>
<ul class="simple">
<li>Make a free digital instrument and effect plugin interface</li>
<li>Be easy to understand and implement</li>
<li>Don't require alien technology, or masoshist design<ul>
<li>Based on C, not Objective-C or C++</li>
<li>No dependancy on external libraries</li>
<li>No serialization format</li>
<li>No C++ multiple inheritence</li>
<li>No C++ exceptions</li>
<li>No macro obfuscation</li>
<li>No object file to compile in the SDK, CLAP is an interface only.</li>
<li>Simple resource management</li>
</ul>
</li>
<li>Designed to work on any operating system and processor architecture</li>
<li>Be event oriented</li>
<li>Be extensible</li>
<li>Be easy to bridge</li>
<li>Be dynamic</li>
<li>Full MIDI access</li>
<li>Use flexible designs, give the option:<ul>
<li>Today most plugin and host manufacturer have their own ideas,
and supports multiple formats. CLAP should not force one into
a particular idea/design. For example, an host which do not
want to send MIDI data to the plugin, should be able to translate
MIDI CCs into parameter automation. On the other hand, an host
which wants to give full MIDI access to the plugins, should be
able to as well.</li>
<li>32 bits or 64 bits audio? 32 bits is mandatory and 64 bits is
an option.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id2">Specification</a></h1>
<div class="section" id="how-to-read-the-specification">
<h2><a class="toc-backref" href="#id3">How to read the specification</a></h2>
<p>The specification should be read along the reference headers.
<a class="reference external" href="https://free-audio.github.io/clap/">https://free-audio.github.io/clap/</a> gives a convinient splet
view for that.</p>
</div>
<div class="section" id="encoding">
<h2><a class="toc-backref" href="#id4">Encoding</a></h2>
<p>All the strings exchanged through the CLAP interface must be encoded
in valid UTF-8.</p>
</div>
<div class="section" id="c-exceptions">
<h2><a class="toc-backref" href="#id5">C++ exceptions</a></h2>
<p>A CLAP interface must not send exception. It is supposed to work width
C programs.</p>
</div>
<div class="section" id="multi-threading">
<h2><a class="toc-backref" href="#id6">Multi-Threading</a></h2>
<p>Every function should have a specifier which tells you if it is thread safe,
from which thread it can be used and if it must be lock-free and wait-free.</p>
<p>The design is pretty simple. Every thing which is closely related to the
audio processing, has to be realtime; <strong>so it can't block or wait!</strong></p>
<p>Functions marked with <strong>[audio-thread]</strong>, can only be called from the audio
processing context and can not lock mutexes, or use any non deterministic
synchronization method. It is implicit that calling a <strong>[thread-safe]</strong>
might lead to wait on synchronization and it is forbidden.</p>
<p>Then the other functions, shall be marked as <strong>[thread-safe]</strong>, which indicates
that it can be called from multiple threads concurrently.</p>
<p><strong>[thread-safe,lock-wait-free]</strong> means that the function can be called from
anywhere and must not lock or wait. It is suitable to use from an audio thread.</p>
<p><strong>[main-thread]</strong> is the thread from which the user interacts with the GUI,
and most of the application happens. You can use synchronization there.</p>
</div>
<div class="section" id="naming-conventions">
<h2><a class="toc-backref" href="#id7">Naming conventions</a></h2>
<p>Extensions name as <tt class="docutils literal">struct <span class="pre">clap_plugin_...</span></tt> are meant to be provided by the
plugin, while extensions name as <tt class="docutils literal">struct <span class="pre">clap_host_...</span></tt> are meant to be
provided by the host.</p>
</div>
<div class="section" id="plugins-location">
<h2><a class="toc-backref" href="#id8">Plugins location</a></h2>
<div class="section" id="common">
<h3><a class="toc-backref" href="#id9">Common</a></h3>
<ul class="simple">
<li>Directories should be scanned recursively.</li>
</ul>
</div>
<div class="section" id="installation-paths">
<h3><a class="toc-backref" href="#id10">Installation Paths</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">OS</th>
<th class="head">path</th>
</tr>
</thead>
<tbody valign="top">
<tr><td rowspan="2">Linux</td>
<td><tt class="docutils literal">/usr/lib/clap</tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">~/.local/lib/clap</span></tt></td>
</tr>
<tr><td>Windows</td>
<td><tt class="docutils literal"><span class="pre">C:\Program</span> Files\clap\</tt></td>
</tr>
<tr><td>OSX</td>
<td><tt class="docutils literal">TBD</tt></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="instantiate-a-plugin">
<h2><a class="toc-backref" href="#id11">Instantiate a plugin</a></h2>
<p>Plugin instantiation can be done in a few steps:</p>
<ul class="simple">
<li>load the dynamic library with <tt class="docutils literal">dlopen()</tt> or symilar functions</li>
<li>find the symbol <tt class="docutils literal">clap_plugin_factory</tt></li>
<li>call <tt class="docutils literal"><span class="pre">factory-&gt;init(plugin_path);</span></tt></li>
<li>use the factory to:<ul>
<li>get the number of plugins available <tt class="docutils literal"><span class="pre">factory-&gt;get_plugin_count();</span></tt></li>
<li>create plugins by index to enumerate the collection <tt class="docutils literal"><span class="pre">factory-&gt;create_plugin_by_index(host,</span> index);</tt></li>
<li>create plugins by identifier to create a specific one <tt class="docutils literal"><span class="pre">factory-&gt;create_plugin_by_id(host,</span> id);</tt></li>
</ul>
</li>
</ul>
<div class="section" id="release-a-plugin">
<h3><a class="toc-backref" href="#id12">Release a plugin</a></h3>
<p>To release a plugin, call <tt class="docutils literal"><span class="pre">plugin-&gt;destroy(plugin);</span></tt>.</p>
</div>
<div class="section" id="plugin-description">
<h3><a class="toc-backref" href="#id13">Plugin description</a></h3>
<p><tt class="docutils literal">struct clap_plugin</tt> contains an interger <tt class="docutils literal">clap_version</tt> which
indicates which version of the clap interface has been used to build the plugin, and
a few methods. The attribute <tt class="docutils literal">clap_version</tt> must be initialized by the plugin with
<tt class="docutils literal">CLAP_PLUGIN_VERSION</tt>.</p>
<p>See <tt class="docutils literal">#include &lt;clap/clap.h&gt;</tt> for more information.</p>
</div>
<div class="section" id="extension-system">
<h3><a class="toc-backref" href="#id14">Extension system</a></h3>
<p>To extend clap's functionnality, there is a pretty simple mechanism:</p>
<pre class="code c literal-block">
<span class="c1">// query a plugin extension
</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">plug_ext</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plug</span><span class="p">,</span> <span class="s">&quot;company/ext-name&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">plug_ext</span><span class="p">)</span> <span class="c1">// check if the interface was implemented
</span><span class="p">{</span>
  <span class="c1">// cast to the concrete type
</span>  <span class="k">const</span> <span class="k">struct</span> <span class="nc">interface_type</span> <span class="o">*</span><span class="n">plug_ext1</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">interface_type</span> <span class="o">*</span><span class="p">)</span><span class="n">plug_ext</span><span class="p">;</span>

  <span class="c1">// use the interface ...
</span>  <span class="n">plug_ext1</span><span class="o">-&gt;</span><span class="n">my_fct</span><span class="p">(</span><span class="n">plug</span><span class="p">,</span> <span class="p">...);</span>
<span class="p">}</span>

<span class="c1">// For the host, this is similar:
</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">host_ext</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="s">&quot;company/ext-name&quot;</span><span class="p">);</span>
<span class="p">...</span>
</pre>
<p>If the extension is not supported, the plugin must return <tt class="docutils literal">NULL</tt>.</p>
<p>Extensions are interface, and <strong>there is no need for the caller to free the pointer</strong>.</p>
<p>By convention, extensions should provide a define for the extension name.</p>
<pre class="code c literal-block">
<span class="c1">// defined in &lt;clap/ext/ports.h&gt;
</span><span class="cp"># define CLAP_EXT_AUDIO_PORTS &quot;clap/audio-ports&quot;</span>
</pre>
</div>
<div class="section" id="audio-ports-configuration">
<h3><a class="toc-backref" href="#id15">Audio ports configuration</a></h3>
<p>A plugin may have multiple audio ports.</p>
<dl class="docutils">
<dt>An audio port has:</dt>
<dd><ul class="first last simple">
<li>a direction (input or output)</li>
<li>a channel count: the number of pin in the bus</li>
<li>a channel mapping (eg: stereo left then right)</li>
<li>a name</li>
</ul>
</dd>
</dl>
<p>There can be only one main input and one main output.</p>
<div class="section" id="standard-channel-mappings">
<h4><a class="toc-backref" href="#id16">Standard channel mappings</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="14%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">type</th>
<th class="head">pin</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>mono</td>
<td>0</td>
<td>mono</td>
</tr>
<tr><td rowspan="2">stereo</td>
<td>0</td>
<td>left</td>
</tr>
<tr><td>1</td>
<td>right</td>
</tr>
<tr><td rowspan="8">surround</td>
<td>0</td>
<td>front left</td>
</tr>
<tr><td>1</td>
<td>front right</td>
</tr>
<tr><td>2</td>
<td>center</td>
</tr>
<tr><td>3</td>
<td>low frequency</td>
</tr>
<tr><td>4</td>
<td>surround left</td>
</tr>
<tr><td>5</td>
<td>surround right</td>
</tr>
<tr><td>6</td>
<td>surround back left</td>
</tr>
<tr><td>7</td>
<td>surround back right</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="activation">
<h2><a class="toc-backref" href="#id17">Activation</a></h2>
<p>Before doing any processing, the plugin must be activated by calling
<tt class="docutils literal">bool succeed = <span class="pre">plugin-&gt;activate(plugin);</span></tt>.</p>
<p>If <tt class="docutils literal">succeed == true</tt> then the activation succeed. If the activation failed,
then the plugin is unusable.</p>
<p><tt class="docutils literal">activate()</tt> <strong>must not</strong> be called if the plugin is already activated.</p>
<p>The plugin activation could be nothing, or could be a task which takes time,
like allocating and initializing buffers.
So the host <strong>must not</strong> activate plugins in the audio processing thread.</p>
<p>To deactivate the plugin, just call <tt class="docutils literal"><span class="pre">plugin-&gt;deactivate(plugin)</span></tt>. Like
<tt class="docutils literal">activate()</tt>, <tt class="docutils literal">deactivate()</tt> should not be called from the audio processing
thread as it may take time.</p>
<p><tt class="docutils literal">deactivate()</tt> <strong>must not</strong> be called if the plugin is not activated.</p>
<p>The host <strong>must</strong> de-activate the plugin before destroying it.</p>
<dl class="docutils">
<dt>Once activated the plugin can't change:</dt>
<dd><ul class="first last simple">
<li>its parameter list</li>
<li>its latency</li>
<li>its audio ports list</li>
</ul>
</dd>
<dt>Before activating the plugin the host should cache:</dt>
<dd><ul class="first last simple">
<li>the parameter list</li>
<li>the latency</li>
<li>the audio ports list</li>
</ul>
</dd>
</dl>
<p>Once the plugin is activated, when the plugin changes a parameter from its GUI.
It should inform the host by using <tt class="docutils literal">clap_host_params</tt> extension and the host
will update the audio processor with a <tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> event. At the
same time, when a parameter changes from the DAW, it will inform the plugin GUI
by using <tt class="docutils literal"><span class="pre">clap_plugin_params-&gt;set_param_value(...)</span></tt> and the processor using
<tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> event.</p>
</div>
<div class="section" id="processing">
<h2><a class="toc-backref" href="#id18">Processing</a></h2>
<p>The processing is done in one call: <tt class="docutils literal"><span class="pre">plugin-&gt;process(plugin,</span> process);</tt>.
The data structure process regroup everything needed by the plugin:</p>
<ul class="simple">
<li>number of frames</li>
<li>transport info</li>
<li>audio buffers</li>
<li>events stream</li>
</ul>
<p>Once the processing is finished, the methods returns a process status
which can be:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Status</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">CLAP_PROCESS_ERROR</tt></td>
<td>An error happened, and the output should be discarded</td>
</tr>
<tr><td><tt class="docutils literal">CLAP_PROCESS_CONTINUE</tt></td>
<td>Succeed, the plugins wants to process the next block</td>
</tr>
<tr><td><tt class="docutils literal">CLAP_PROCESS_SLEEP</tt></td>
<td>Succeed, I'm quiet and can go to sleep</td>
</tr>
</tbody>
</table>
<p>If <tt class="docutils literal">process()</tt> returns <tt class="docutils literal">CLAP_PROCESS_SLEEP</tt> and some parameters were ramping
(see <tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt> event), then the host must send a <tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt>
or  <tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt> for those parameters at the next call to process.</p>
<div class="section" id="audio-buffers">
<h3><a class="toc-backref" href="#id19">Audio buffers</a></h3>
<ul class="simple">
<li>The audio buffers are allocated by the host.</li>
<li>In-place processing is not supported by default, yet the host can use it
if the plugin has the attribute <tt class="docutils literal">CLAP_ATTR_SUPPORTS_IN_PLACE_PROCESSING</tt>.</li>
<li>See <a class="reference internal" href="#standard-channel-mappings">Standard channel mappings</a>.</li>
</ul>
</div>
<div class="section" id="events">
<h3><a class="toc-backref" href="#id20">Events</a></h3>
<ul class="simple">
<li>Event's time is relative to the first sample of the processing block.</li>
<li>The plugin must not modify the events input events.</li>
<li>The host output event stream must make a copy of the plugin events.</li>
</ul>
<div class="section" id="parameters-events">
<h4><a class="toc-backref" href="#id21">Parameters Events</a></h4>
<p>Parameters can be automated by the host using <tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt>.
The ramp only applies to float parameters, and applies until an other
<tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> event is received.</p>
</div>
</div>
</div>
<div class="section" id="parameters">
<h2><a class="toc-backref" href="#id22">Parameters</a></h2>
<p>The host can get the plugin's parameters tree by using the params extension:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">params-&gt;count(plugin);</span></tt> to know the number of parameters</li>
<li><tt class="docutils literal"><span class="pre">params-&gt;get_param_info(plugin,</span> param_index, &amp;param_info);</tt> to get the parameter
value and description</li>
</ul>
<pre class="code c literal-block">
<span class="cp">#include</span> <span class="cpf">&lt;clap/ext/params.h&gt;</span><span class="cp">
</span>
<span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_plugin_params</span> <span class="o">*</span><span class="n">params</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_PARAMS</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">params</span><span class="p">)</span>
  <span class="k">return</span><span class="p">;</span> <span class="c1">// no params extensions
</span><span class="kt">uint32_t</span> <span class="n">count</span> <span class="o">=</span> <span class="n">params</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">struct</span> <span class="nc">clap_param_info</span> <span class="n">param_info</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">params</span><span class="o">-&gt;</span><span class="n">get_param_info</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">param_info</span><span class="p">))</span>
    <span class="k">continue</span><span class="p">;</span>
  <span class="c1">// ...
</span><span class="p">}</span>
</pre>
<p>See <a class="reference internal" href="#clap-ext-params-h">clap/ext/params.h</a>.</p>
<div class="section" id="types">
<h3><a class="toc-backref" href="#id23">Types</a></h3>
<p>There are a few parameter types:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="22%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">type</th>
<th class="head">value attribute</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>bool</td>
<td><tt class="docutils literal">value.b</tt></td>
<td>a boolean value, can be true or false</td>
</tr>
<tr><td>double</td>
<td><tt class="docutils literal">value.d</tt></td>
<td>a double value</td>
</tr>
<tr><td>int</td>
<td><tt class="docutils literal">value.i</tt></td>
<td>an integer value</td>
</tr>
<tr><td>enum</td>
<td><tt class="docutils literal">value.i</tt></td>
<td>an enumeration, it uses integer values, and the host
should rely on <tt class="docutils literal">display_text</tt> to show its value.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="graphical-user-interface">
<h2><a class="toc-backref" href="#id24">Graphical User Interface</a></h2>
<div class="section" id="showing-the-gui">
<h3><a class="toc-backref" href="#id25">Showing the GUI</a></h3>
<p>To show the plugin's GUI, you need to use the gui extension: <tt class="docutils literal"><span class="pre">gui-&gt;open(plugin)</span></tt>.
If the plugin succeed to show the GUI, it returns <tt class="docutils literal">true</tt>, <tt class="docutils literal">false</tt>
otherwise.</p>
<pre class="code c literal-block">
<span class="cp">#include</span> <span class="cpf">&lt;clap/ext/gui.h&gt;</span><span class="cp">
</span>
<span class="k">struct</span> <span class="nc">clap_plugin_gui</span> <span class="o">*</span><span class="n">gui</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_GUI</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">gui</span><span class="p">)</span>
  <span class="n">gui</span><span class="o">-&gt;</span><span class="n">open</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
</pre>
<p>See <a class="reference internal" href="#clap-ext-gui-h">clap/ext/gui.h</a>.</p>
</div>
<div class="section" id="sending-events-to-the-host">
<h3><a class="toc-backref" href="#id26">Sending events to the host</a></h3>
<p>The plugin can notify the host of parameter changes by sending events to:
<tt class="docutils literal"><span class="pre">host-&gt;events(host,</span> plugin, events);</tt>.</p>
<p>Events sent to the host should be stamped:</p>
<pre class="code c literal-block">
<span class="k">struct</span> <span class="nc">clap_event</span> <span class="n">ev</span><span class="p">;</span>
<span class="c1">// ...
</span><span class="n">ev</span><span class="p">.</span><span class="n">steady_time</span> <span class="o">=</span> <span class="o">*</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span><span class="p">;</span>
<span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="hiding-the-gui">
<h3><a class="toc-backref" href="#id27">Hiding the GUI</a></h3>
<p>The plugin should hide the GUI after a call to <tt class="docutils literal"><span class="pre">gui-&gt;close(plugin)</span></tt>.
If the plugin window has been closed by the user, then the plugin should
send an event <tt class="docutils literal">CLAP_EVENT_GUI_CLOSED</tt> to the host.</p>
<pre class="code c literal-block">
<span class="k">struct</span> <span class="nc">clap_event</span> <span class="n">ev</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">CLAP_EVENT_GUI_CLOSED</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">sample_offset</span> <span class="o">=</span> <span class="o">*</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span><span class="p">;</span>
<span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="embedding">
<h3><a class="toc-backref" href="#id28">Embedding</a></h3>
<p>Some host are designed to embed plugin's window.
As embedding is not a requirement and is OS specific, it is then offered as
an extension.</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="35%" />
<col width="29%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">GUI</th>
<th class="head">header</th>
<th class="head">extension</th>
<th class="head">comment</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Generic</td>
<td><a class="reference internal" href="#clap-ext-gui-h">clap/ext/gui.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED</tt></td>
<td>For the host</td>
</tr>
<tr><td>Windows</td>
<td><a class="reference internal" href="#clap-ext-gui-win32-h">clap/ext/gui-win32.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED_WIN32</tt></td>
<td>For the plugin</td>
</tr>
<tr><td>X11</td>
<td><a class="reference internal" href="#clap-ext-gui-x11-h">clap/ext/gui-x11.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED_X11</tt></td>
<td>For the plugin</td>
</tr>
<tr><td>Cocoa</td>
<td><a class="reference internal" href="#clap-ext-gui-cocoa-h">clap/ext/gui-cocoa.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED_COCOA</tt></td>
<td>For the plugin</td>
</tr>
</tbody>
</table>
<div class="section" id="example-on-windows">
<h4><a class="toc-backref" href="#id29">Example on Windows</a></h4>
<pre class="code c literal-block">
<span class="cp">#include</span> <span class="cpf">&lt;clap/clap.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;clap/ext/gui.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;clap/ext/embed-win32.h&gt;</span><span class="cp">
</span>
<span class="k">struct</span> <span class="nc">clap_plugin_embed_win32</span> <span class="o">*</span><span class="n">embed</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EMBED_WIN32</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">embed</span><span class="p">)</span>
  <span class="n">embed</span><span class="o">-&gt;</span><span class="n">embed</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">window</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="resizing-the-window">
<h4><a class="toc-backref" href="#id30">Resizing the window</a></h4>
<pre class="code c literal-block">
<span class="cp">#include</span> <span class="cpf">&lt;clap/clap.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;clap/ext/embed.h&gt;</span><span class="cp">
</span>
<span class="c1">// plugin code
</span><span class="k">struct</span> <span class="nc">clap_host_gui</span> <span class="o">*</span><span class="n">host_gui</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_GUI</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">host_gui</span> <span class="o">&amp;&amp;</span> <span class="n">host_gui</span><span class="o">-&gt;</span><span class="n">resize</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// resize succeed
</span><span class="p">}</span>
</pre>
</div>
</div>
</div>
<div class="section" id="save-and-restore-plugin-s-state">
<h2><a class="toc-backref" href="#id31">Save and restore plugin's state</a></h2>
<p>Saving the plugin's state is done by using the state extension:</p>
<pre class="code c literal-block">
<span class="cp">#include</span> <span class="cpf">&lt;clap/clap.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;clap/ext/state.h&gt;</span><span class="cp">
</span>
<span class="k">struct</span> <span class="nc">clap_ostream</span> <span class="o">*</span><span class="n">stream</span> <span class="o">=</span> <span class="p">...;</span>

<span class="k">struct</span> <span class="nc">clap_plugin_state</span> <span class="o">*</span><span class="n">state</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_STATE</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">&amp;&amp;</span> <span class="n">state</span><span class="o">-&gt;</span><span class="n">save</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">stream</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// save succeed
</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// save failed
</span><span class="p">}</span>
</pre>
<p>Restoring the plugin's state is done by:</p>
<pre class="code c literal-block">
<span class="n">state</span><span class="o">-&gt;</span><span class="n">restore</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">stream</span><span class="p">);</span>
</pre>
<p>The state of the plugin should be independent of the machine: you can save a
plugin state on a little endian machine and send it through the network to a
big endian machine, it should load again successfully.</p>
<p>See <a class="reference internal" href="#clap-ext-state-h">clap/ext/state.h</a>.</p>
<p>Note: if the plugin do not have the state extension, the host can save the
plugin's parameters and restore them.</p>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id32">References</a></h1>
<div class="section" id="clap-clap-h">
<h2><a class="toc-backref" href="#id33">clap/clap.h</a></h2>
<pre class="code c literal-block">
<span class="cm">/*
 * CLAP - CLever Audio Plugin
 * ~~~~~~~~~~~~~~~~~~~~~~~~~~
 *
 * Copyright (c) 2014...2021 Alexandre BIQUE &lt;bique.alexandre&#64;gmail.com&gt;
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the &quot;Software&quot;), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */</span>

<span class="cp">#pragma once
</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdbool.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stddef.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="cp">#define CLAP_VERSION_MAKE(Major, Minor, Revision)                              \
   ((((Major)&amp;0xff) &lt;&lt; 16) | (((Minor)&amp;0xff) &lt;&lt; 8) | ((Revision)&amp;0xff))
#define CLAP_VERSION CLAP_VERSION_MAKE(0, 2, 0)
#define CLAP_VERSION_MAJ(Version) (((Version) &gt;&gt; 16) &amp; 0xff)
#define CLAP_VERSION_MIN(Version) (((Version) &gt;&gt; 8) &amp; 0xff)
#define CLAP_VERSION_REV(Version) ((Version)&amp;0xff)
</span>
<span class="cp">#if defined _WIN32 || defined __CYGWIN__
#   ifdef __GNUC__
#      define CLAP_EXPORT __attribute__((dllexport))
#   else
#      define CLAP_EXPORT __declspec(dllexport)
#   endif
#else
#   if __GNUC__ &gt;= 4
#      define CLAP_EXPORT __attribute__((visibility(&quot;default&quot;)))
#   else
#      define CLAP_EXPORT
#   endif
#endif
</span>
<span class="c1">///////////////////////////
// FORWARD DELCLARATIONS //
///////////////////////////
</span>
<span class="k">struct</span> <span class="nc">clap_plugin</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">clap_host</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">clap_string_size</span> <span class="p">{</span>
   <span class="n">CLAP_ID_SIZE</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
   <span class="n">CLAP_NAME_SIZE</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">clap_log_severity</span> <span class="p">{</span>
   <span class="n">CLAP_LOG_DEBUG</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
   <span class="n">CLAP_LOG_INFO</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
   <span class="n">CLAP_LOG_WARNING</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
   <span class="n">CLAP_LOG_ERROR</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
   <span class="n">CLAP_LOG_FATAL</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">};</span>

<span class="c1">// Description of the plugin
</span><span class="cp">#define CLAP_ATTR_DESCRIPTION &quot;clap/description&quot;
</span><span class="c1">// Manufacturer name
</span><span class="cp">#define CLAP_ATTR_MANUFACTURER &quot;clap/manufacturer&quot;
</span><span class="c1">// Url to product
</span><span class="cp">#define CLAP_ATTR_URL &quot;clap/url&quot;
</span><span class="c1">// Url to support page, or mail to support
</span><span class="cp">#define CLAP_ATTR_SUPPORT &quot;clap/support&quot;
</span>
<span class="c1">////////////////
// PARAMETERS //
////////////////
</span>
<span class="k">union</span> <span class="nc">clap_param_value</span> <span class="p">{</span>
   <span class="kt">bool</span>    <span class="n">b</span><span class="p">;</span>
   <span class="kt">double</span>  <span class="n">d</span><span class="p">;</span>
   <span class="kt">int64_t</span> <span class="n">i</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">////////////
// EVENTS //
////////////
</span>
<span class="k">enum</span> <span class="n">clap_event_type</span> <span class="p">{</span>
   <span class="n">CLAP_EVENT_NOTE_ON</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>   <span class="c1">// note attribute
</span>   <span class="n">CLAP_EVENT_NOTE_OFF</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1">// note attribute
</span>   <span class="n">CLAP_EVENT_CHOKE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1">// no attribute
</span>   <span class="n">CLAP_EVENT_PARAM_SET</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">// param attribute
</span>
   <span class="cm">/* MIDI Style */</span>
   <span class="n">CLAP_EVENT_CONTROL</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>    <span class="c1">// control attribute
</span>   <span class="n">CLAP_EVENT_PROGRAM</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>    <span class="c1">// program attribute
</span>   <span class="n">CLAP_EVENT_MIDI</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>       <span class="c1">// midi attribute
</span>   <span class="n">CLAP_EVENT_MIDI_SYSEX</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="c1">// midi attribute
</span><span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_event_param</span> <span class="p">{</span>
   <span class="kt">int32_t</span>                <span class="n">key</span><span class="p">;</span>
   <span class="kt">int32_t</span>                <span class="n">channel</span><span class="p">;</span>
   <span class="kt">uint32_t</span>               <span class="n">index</span><span class="p">;</span> <span class="c1">// parameter index
</span>   <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">normalized_value</span><span class="p">;</span>
   <span class="kt">double</span>                 <span class="n">normalized_ramp</span><span class="p">;</span> <span class="c1">// only applies to float values
</span><span class="p">};</span>

<span class="cm">/** Note On/Off event. */</span>
<span class="k">struct</span> <span class="nc">clap_event_note</span> <span class="p">{</span>
   <span class="kt">int32_t</span> <span class="n">key</span><span class="p">;</span>      <span class="c1">// 0..127
</span>   <span class="kt">int32_t</span> <span class="n">channel</span><span class="p">;</span>  <span class="c1">// 0..15
</span>   <span class="kt">double</span>  <span class="n">velocity</span><span class="p">;</span> <span class="c1">// 0..1
</span><span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_event_control</span> <span class="p">{</span>
   <span class="kt">int32_t</span> <span class="n">key</span><span class="p">;</span>     <span class="c1">// 0..127, or -1 to match all keys
</span>   <span class="kt">int32_t</span> <span class="n">channel</span><span class="p">;</span> <span class="c1">// 0..15, or -1 to match all channels
</span>   <span class="kt">int32_t</span> <span class="n">control</span><span class="p">;</span> <span class="c1">// 0..127
</span>   <span class="kt">double</span>  <span class="n">value</span><span class="p">;</span>   <span class="c1">// 0..1
</span><span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_event_midi</span> <span class="p">{</span>
   <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_event_midi_sysex</span> <span class="p">{</span>
   <span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span> <span class="c1">// midi buffer
</span>   <span class="kt">uint32_t</span>       <span class="n">size</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**
 * Asks the plugin to load a program.
 * This is analogue to the midi program change.
 *
 * The main advantage of setting a program instead of loading
 * a preset, is that the program should already be in the plugin's
 * memory, and can be set instantly.
 */</span>
<span class="k">struct</span> <span class="nc">clap_event_program</span> <span class="p">{</span>
   <span class="kt">int32_t</span> <span class="n">channel</span><span class="p">;</span>  <span class="c1">// 0..15, -1 unspecified
</span>   <span class="kt">int32_t</span> <span class="n">bank_msb</span><span class="p">;</span> <span class="c1">// 0..0x7FFFFFFF, -1 unspecified
</span>   <span class="kt">int32_t</span> <span class="n">bank_lsb</span><span class="p">;</span> <span class="c1">// 0..0x7FFFFFFF, -1 unspecified
</span>   <span class="kt">int32_t</span> <span class="n">program</span><span class="p">;</span>  <span class="c1">// 0..0x7FFFFFFF
</span><span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_event</span> <span class="p">{</span>
   <span class="k">enum</span> <span class="n">clap_event_type</span> <span class="n">type</span><span class="p">;</span>
   <span class="kt">uint32_t</span> <span class="n">time</span><span class="p">;</span> <span class="c1">// offset from the first sample in the process block
</span>
   <span class="k">union</span> <span class="p">{</span>
      <span class="k">struct</span> <span class="nc">clap_event_note</span>       <span class="n">note</span><span class="p">;</span>
      <span class="k">struct</span> <span class="nc">clap_event_control</span>    <span class="n">control</span><span class="p">;</span>
      <span class="k">struct</span> <span class="nc">clap_event_param</span>      <span class="n">param</span><span class="p">;</span>
      <span class="k">struct</span> <span class="nc">clap_event_midi</span>       <span class="n">midi</span><span class="p">;</span>
      <span class="k">struct</span> <span class="nc">clap_event_midi_sysex</span> <span class="n">midi_sysex</span><span class="p">;</span>
      <span class="k">struct</span> <span class="nc">clap_event_program</span>    <span class="n">program</span><span class="p">;</span>
   <span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_event_list</span> <span class="p">{</span>
   <span class="kt">void</span> <span class="o">*</span><span class="n">ctx</span><span class="p">;</span>

   <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_event_istream</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>
   <span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_event</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">get</span><span class="p">)(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_event_istream</span> <span class="o">*</span><span class="n">stream</span><span class="p">,</span>
                                   <span class="kt">int</span>                              <span class="n">index</span><span class="p">);</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">push_back</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_event_istream</span> <span class="o">*</span><span class="n">stream</span><span class="p">,</span>
                     <span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_event</span> <span class="o">*</span>  <span class="n">event</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">/////////////
// PROCESS //
/////////////
</span>
<span class="k">enum</span> <span class="n">clap_process_status</span> <span class="p">{</span>
   <span class="cm">/* Processing failed. The output buffer must be discarded. */</span>
   <span class="n">CLAP_PROCESS_ERROR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

   <span class="cm">/* Processing succeed. */</span>
   <span class="n">CLAP_PROCESS_CONTINUE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>

   <span class="cm">/* Processing succeed, but no more processing is required, until next event.
    */</span>
   <span class="n">CLAP_PROCESS_SLEEP</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_audio_buffer</span> <span class="p">{</span>
   <span class="c1">// Either data32 or data64 will be set, but not both.
</span>   <span class="c1">// If none are set, assume that the input has the value 0 for each samples.
</span>   <span class="c1">// data[i] for channel i buffer
</span>   <span class="kt">float</span> <span class="o">**</span> <span class="n">data32</span><span class="p">;</span>
   <span class="kt">double</span> <span class="o">**</span><span class="n">data64</span><span class="p">;</span>
   <span class="kt">int32_t</span>  <span class="n">channel_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_transport</span> <span class="p">{</span>
   <span class="kt">bool</span> <span class="n">is_playing</span><span class="p">;</span>
   <span class="kt">bool</span> <span class="n">is_recording</span><span class="p">;</span>
   <span class="kt">bool</span> <span class="n">is_looping</span><span class="p">;</span>

   <span class="kt">double</span> <span class="n">tempo</span><span class="p">;</span> <span class="c1">// tempo in bpm
</span>
   <span class="kt">double</span> <span class="n">song_pos</span><span class="p">;</span>  <span class="c1">// position in beats
</span>   <span class="kt">double</span> <span class="n">bar_start</span><span class="p">;</span> <span class="c1">// start pos of the current bar
</span>   <span class="kt">double</span> <span class="n">loop_start</span><span class="p">;</span>
   <span class="kt">double</span> <span class="n">loop_end</span><span class="p">;</span>

   <span class="kt">int16_t</span> <span class="n">tsig_num</span><span class="p">;</span>   <span class="c1">// time signature numerator
</span>   <span class="kt">int16_t</span> <span class="n">tsig_denom</span><span class="p">;</span> <span class="c1">// time signature denominator
</span>
   <span class="kt">int64_t</span> <span class="n">steady_time</span><span class="p">;</span> <span class="c1">// the steady time in samples
</span><span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_process</span> <span class="p">{</span>
   <span class="kt">int32_t</span> <span class="n">frames_count</span><span class="p">;</span> <span class="c1">// number of frame to process
</span>
   <span class="k">struct</span> <span class="nc">clap_transport</span> <span class="n">transport</span><span class="p">;</span>

   <span class="cm">/* audio ports */</span>
   <span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_audio_buffer</span> <span class="o">*</span><span class="n">audio_in</span><span class="p">;</span>
   <span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_audio_buffer</span> <span class="o">*</span><span class="n">audio_out</span><span class="p">;</span>
   <span class="kt">int</span>                             <span class="n">audio_in_count</span><span class="p">;</span>
   <span class="kt">int</span>                             <span class="n">audio_out_count</span><span class="p">;</span>

   <span class="cm">/* events */</span>
   <span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_event_list</span> <span class="o">*</span><span class="n">in_events</span><span class="p">;</span>
   <span class="k">struct</span> <span class="nc">clap_event_list</span> <span class="o">*</span>      <span class="n">out_events</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">//////////
// HOST //
//////////
</span>
<span class="k">struct</span> <span class="nc">clap_host</span> <span class="p">{</span>
   <span class="kt">int32_t</span> <span class="n">clap_version</span><span class="p">;</span> <span class="c1">// initialized to CLAP_VERSION
</span>
   <span class="kt">void</span> <span class="o">*</span><span class="n">host_data</span><span class="p">;</span> <span class="c1">// reserved pointer for the host
</span>
   <span class="cm">/* Name and version could be attributes but it is convenient to
    * have it when debugging. Also they are mandatory. */</span>
   <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>    <span class="c1">// plugin name, eg: &quot;BitwigStudio&quot;
</span>   <span class="kt">char</span> <span class="n">version</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span> <span class="c1">// the plugin version, eg: &quot;1.3.14&quot;
</span>
   <span class="cm">/* Returns the size of the original string. If this is larger than size, then
    * the function did not have enough space to copy all the data.
    * [thread-safe] */</span>
   <span class="kt">int32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_attribute</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                            <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>      <span class="n">attr</span><span class="p">,</span>
                            <span class="kt">char</span> <span class="o">*</span>            <span class="n">buffer</span><span class="p">,</span>
                            <span class="kt">int32_t</span>           <span class="n">size</span><span class="p">);</span>

   <span class="cm">/* Log a message through the host.
    * [thread-safe] */</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">log</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span>     <span class="n">host</span><span class="p">,</span>
               <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>   <span class="n">plugin</span><span class="p">,</span>
               <span class="k">enum</span> <span class="n">clap_log_severity</span> <span class="n">severity</span><span class="p">,</span>
               <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>           <span class="n">msg</span><span class="p">);</span>

   <span class="cm">/* Query an extension.
    * [thread-safe] */</span>
   <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">extension</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extension_id</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">////////////
// PLUGIN //
////////////
</span>
<span class="cm">/* bitfield
 * This gives an hint to the host what the plugin might do. */</span>
<span class="k">enum</span> <span class="n">clap_plugin_type</span> <span class="p">{</span>
   <span class="cm">/* Instruments can play notes, and generate audio */</span>
   <span class="n">CLAP_PLUGIN_INSTRUMENT</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">),</span>

   <span class="cm">/* Audio effects, process audio input and produces audio.
    * Exemple: delay, reverb, compressor. */</span>
   <span class="n">CLAP_PLUGIN_AUDIO_EFFECT</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">),</span>

   <span class="cm">/* Event effects, takes events as input and produces events.
    * Exemple: arpegiator */</span>
   <span class="n">CLAP_PLUGIN_EVENT_EFFECT</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">),</span> <span class="c1">// can be seen as midi effect
</span>
   <span class="cm">/* Analyze audio and/or events, and produces analysis results */</span>
   <span class="n">CLAP_PLUGIN_ANALYZER</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="p">{</span>
   <span class="kt">int32_t</span> <span class="n">clap_version</span><span class="p">;</span> <span class="c1">// initialized to CLAP_VERSION
</span>
   <span class="kt">void</span> <span class="o">*</span><span class="n">plugin_data</span><span class="p">;</span> <span class="c1">// reserved pointer for the plugin
</span>
   <span class="cm">/* The 3 following strings are here because:
    * - they are mandatory
    * - it is convenient when you debug, to be able to see
    *   the plugin name, id and version by displaying
    *   the structure.
    */</span>
   <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>    <span class="c1">// plugin name, eg: &quot;Diva&quot;
</span>   <span class="kt">char</span> <span class="n">id</span><span class="p">[</span><span class="n">CLAP_ID_SIZE</span><span class="p">];</span>        <span class="c1">// plugin id, eg: &quot;com.u-he.diva&quot;
</span>   <span class="kt">char</span> <span class="n">version</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span> <span class="c1">// the plugin version, eg: &quot;1.3.2&quot;
</span>
   <span class="kt">uint64_t</span> <span class="n">plugin_type</span><span class="p">;</span> <span class="c1">// bitfield of enum clap_plugin_type
</span>
   <span class="cm">/* Free the plugin and its resources.
    * It is not required to deactivate the plugin prior to this call. */</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">destroy</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

   <span class="cm">/* Copy at most size of the attribute's value into buffer.
    * This function must place a '\0' byte at the end of the string.
    * Returns the size of the original string or 0 if there is no
    * value for this attributes.
    * [thread-safe] */</span>
   <span class="kt">int32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_attribute</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                            <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>        <span class="n">attr</span><span class="p">,</span>
                            <span class="kt">char</span> <span class="o">*</span>              <span class="n">buffer</span><span class="p">,</span>
                            <span class="kt">int32_t</span>             <span class="n">size</span><span class="p">);</span>

   <span class="cm">/* activation/deactivation
    * [main-thread] */</span>
   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">activate</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sample_rate</span><span class="p">);</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">deactivate</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

   <span class="cm">/* process audio, events, ...
    * [audio-thread] */</span>
   <span class="k">enum</span> <span class="nf">clap_process_status</span> <span class="p">(</span><span class="o">*</span><span class="n">process</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>       <span class="n">plugin</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_process</span> <span class="o">*</span><span class="n">process</span><span class="p">);</span>

   <span class="cm">/* query an extension
    * [thread-safe] */</span>
   <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">extension</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* This interface is the entry point of the dynamic library.
 *
 * Every methods must be thread-safe. */</span>
<span class="k">struct</span> <span class="nc">clap_plugin_entry</span> <span class="p">{</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">plugin_path</span><span class="p">);</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">deinit</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>

   <span class="cm">/* Get the number of plugins available.
    * [thread-safe] */</span>
   <span class="kt">int32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_plugin_count</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>

   <span class="cm">/* Create a clap_plugin by its index.
    * Returns null in case of error.
    * [thread-safe] */</span>
   <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">create_plugin_by_index</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                                                 <span class="kt">int32_t</span>           <span class="n">index</span><span class="p">);</span>

   <span class="cm">/* Create a clap_plugin by its plugin_id.
    * Returns null in case of error.
    * [thread-safe] */</span>
   <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">create_plugin_by_id</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                                              <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>      <span class="n">plugin_id</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* Entry point */</span>
<span class="n">CLAP_EXPORT</span> <span class="k">extern</span> <span class="k">const</span> <span class="k">struct</span> <span class="nc">clap_plugin_entry</span> <span class="o">*</span><span class="n">clap_plugin_entry</span><span class="p">;</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
<div class="section" id="clap-ext-state-h">
<h2><a class="toc-backref" href="#id34">clap/ext/state.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#pragma once
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../clap.h&quot;</span><span class="cp">
#include</span> <span class="cpf">&quot;stream.h&quot;</span><span class="cp">
</span>
<span class="cp">#define CLAP_EXT_STATE &quot;clap/state&quot;
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="k">struct</span> <span class="nc">clap_plugin_state</span> <span class="p">{</span>
   <span class="cm">/* Saves the plugin state into stream.
    * [main-thread] */</span>
   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">save</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">struct</span> <span class="nc">clap_ostream</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>

   <span class="cm">/* Loads the plugin state from stream.
    * [main-thread] */</span>
   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">restore</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">struct</span> <span class="nc">clap_istream</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_host_state</span> <span class="p">{</span>
   <span class="cm">/* Tell the host that the plugin state has changed.
    * [thread-safe] */</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_dirty</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
<div class="section" id="clap-ext-audio-ports-h">
<h2><a class="toc-backref" href="#id35">clap/ext/audio-ports.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#pragma once
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../clap.h&quot;</span><span class="cp">
</span>
<span class="cp">#define CLAP_EXT_AUDIO_PORTS &quot;clap/audio-ports&quot;
</span>
<span class="k">enum</span> <span class="n">clap_audio_port_channel_mapping</span> <span class="p">{</span>
   <span class="n">CLAP_AUDIO_PORT_UNSPECIFIED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
   <span class="n">CLAP_AUDIO_PORT_MONO</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>

   <span class="c1">// left, right
</span>   <span class="n">CLAP_AUDIO_PORT_STEREO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>

   <span class="c1">// front left, front right, center, low, surround left, surround right
</span>   <span class="c1">// surround back left, surround back right
</span>   <span class="n">CLAP_AUDIO_PORT_SURROUND</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_audio_port_info</span> <span class="p">{</span>
   <span class="kt">char</span>    <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span> <span class="c1">// useful in the debugger
</span>   <span class="kt">bool</span>    <span class="n">is_input</span><span class="p">;</span>
   <span class="kt">bool</span>    <span class="n">is_main</span><span class="p">;</span>
   <span class="kt">bool</span>    <span class="n">is_64_bits</span><span class="p">;</span>
   <span class="kt">int32_t</span> <span class="n">channel_count</span><span class="p">;</span>
   <span class="k">enum</span> <span class="n">clap_audio_port_channel_mapping</span> <span class="n">channel_mapping</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// The audio ports scan has to be done while the plugin is deactivated.
</span><span class="k">struct</span> <span class="nc">clap_plugin_audio_ports</span> <span class="p">{</span>
   <span class="c1">// number of ports, both inputs and outputs
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">int32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_count</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

   <span class="c1">// get info about about an audio port.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_info</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>         <span class="n">plugin</span><span class="p">,</span>
                    <span class="kt">int32_t</span>                      <span class="n">index</span><span class="p">,</span>
                    <span class="k">struct</span> <span class="nc">clap_audio_port_info</span> <span class="o">*</span><span class="n">info</span><span class="p">);</span>

   <span class="c1">// Returns the port latency.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">int32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_latency</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="kt">int32_t</span> <span class="n">index</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_host_audio_ports</span> <span class="p">{</span>
   <span class="c1">// Tell the host that the plugin ports has changed.
</span>   <span class="c1">// The host shall deactivate the plugin and then scan the ports again.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">changed</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

   <span class="c1">// Tell the host that the latency changed.
</span>   <span class="c1">// The host should call get_port_latency on each ports.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">latency_changed</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
<div class="section" id="clap-ext-params-h">
<h2><a class="toc-backref" href="#id36">clap/ext/params.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#pragma once
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../clap.h&quot;</span><span class="cp">
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="cp">#define CLAP_EXT_PARAMS &quot;clap/params&quot;
</span>
<span class="k">enum</span> <span class="n">clap_param_type</span> <span class="p">{</span>
   <span class="n">CLAP_PARAM_FLOAT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// uses value.d
</span>   <span class="n">CLAP_PARAM_BOOL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1">// uses value.b
</span>   <span class="n">CLAP_PARAM_INT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>   <span class="c1">// uses value.i
</span>   <span class="n">CLAP_PARAM_ENUM</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1">// uses value.i
</span><span class="p">};</span>

<span class="cm">/* This describes the parameter and provides the current value */</span>
<span class="k">struct</span> <span class="nc">clap_param_info</span> <span class="p">{</span>
   <span class="cm">/* param info */</span>
   <span class="kt">int32_t</span> <span class="n">index</span><span class="p">;</span>
   <span class="kt">int32_t</span> <span class="n">id</span><span class="p">;</span>                   <span class="c1">// a string which identify the param
</span>   <span class="kt">char</span>    <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span> <span class="c1">// the display name
</span>   <span class="kt">bool</span>    <span class="n">is_per_note</span><span class="p">;</span>
   <span class="kt">bool</span>    <span class="n">is_per_channel</span><span class="p">;</span>
   <span class="kt">bool</span>    <span class="n">is_used</span><span class="p">;</span>     <span class="c1">// is this parameter used by the patch?
</span>   <span class="kt">bool</span>    <span class="n">is_periodic</span><span class="p">;</span> <span class="c1">// after the last value, go back to the first one
</span>   <span class="kt">bool</span>    <span class="n">is_locked</span><span class="p">;</span>   <span class="c1">// if true, the parameter can't be changed by the host
</span>   <span class="kt">bool</span>    <span class="n">is_automatable</span><span class="p">;</span>

   <span class="cm">/* value */</span>
   <span class="k">enum</span> <span class="n">clap_param_type</span>   <span class="n">type</span><span class="p">;</span>
   <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">value</span><span class="p">;</span>         <span class="c1">// current plain value
</span>   <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">min_value</span><span class="p">;</span>     <span class="c1">// minimum plain value
</span>   <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">max_value</span><span class="p">;</span>     <span class="c1">// maximum plain value
</span>   <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">default_value</span><span class="p">;</span> <span class="c1">// default plain value
</span><span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_plugin_params</span> <span class="p">{</span>
   <span class="c1">// Returns the number of parameters.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">int32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">count</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

   <span class="c1">// Copies the parameter's info to param_info and returns true on success.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_param_info</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>    <span class="n">plugin</span><span class="p">,</span>
                          <span class="kt">int32_t</span>                 <span class="n">param_index</span><span class="p">,</span>
                          <span class="k">struct</span> <span class="nc">clap_param_info</span> <span class="o">*</span><span class="n">param_info</span><span class="p">);</span>

   <span class="c1">// Gets the parameter plain value.
</span>   <span class="c1">// [main-thread]
</span>   <span class="k">union</span> <span class="nf">clap_param_value</span> <span class="p">(</span><span class="o">*</span><span class="n">get_param_value</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                                             <span class="kt">int32_t</span>             <span class="n">param_index</span><span class="p">);</span>

   <span class="c1">// Sets the parameter plain value.
</span>   <span class="c1">// If the plupin is activated, then the host must send a param event
</span>   <span class="c1">// in the next process call to update the audio processor.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_param_value</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>   <span class="n">plugin</span><span class="p">,</span>
                           <span class="kt">int32_t</span>                <span class="n">param_index</span><span class="p">,</span>
                           <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">plain_value</span><span class="p">);</span>

   <span class="c1">// Normalization only exists for float values
</span>   <span class="c1">// [thread-safe,lock-wait-free]
</span>   <span class="kt">double</span> <span class="p">(</span><span class="o">*</span><span class="n">plain_to_norm</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                           <span class="kt">int32_t</span>             <span class="n">param_index</span><span class="p">,</span>
                           <span class="kt">double</span>              <span class="n">plain_value</span><span class="p">);</span>
   <span class="kt">double</span> <span class="p">(</span><span class="o">*</span><span class="n">norm_to_plain</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                           <span class="kt">int32_t</span>             <span class="n">param_index</span><span class="p">,</span>
                           <span class="kt">double</span>              <span class="n">normalized_value</span><span class="p">);</span>

   <span class="c1">// Formats the display text for the given parameter value.
</span>   <span class="c1">// [thread-safe,lock-wait-free]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_param_display</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>   <span class="n">plugin</span><span class="p">,</span>
                             <span class="kt">int32_t</span>                <span class="n">param_index</span><span class="p">,</span>
                             <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">plain_value</span><span class="p">,</span>
                             <span class="kt">char</span> <span class="o">*</span>                 <span class="n">display</span><span class="p">,</span>
                             <span class="kt">uint32_t</span>               <span class="n">size</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_host_params</span> <span class="p">{</span>
   <span class="cm">/* [main-thread] */</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">touch_begin</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span>  <span class="n">host</span><span class="p">,</span>
                       <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                       <span class="kt">int32_t</span>             <span class="n">index</span><span class="p">);</span>

   <span class="cm">/* [main-thread] */</span>
   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">touch_end</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span>  <span class="n">host</span><span class="p">,</span>
                     <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                     <span class="kt">int32_t</span>             <span class="n">index</span><span class="p">);</span>

   <span class="c1">// If the plugin is activated, the host must send a parameter update
</span>   <span class="c1">// in the next process call to update the audio processor.
</span>   <span class="c1">// Only for value changes that happens in the gui.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">changed</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span>     <span class="n">host</span><span class="p">,</span>
                   <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>   <span class="n">plugin</span><span class="p">,</span>
                   <span class="kt">int32_t</span>                <span class="n">index</span><span class="p">,</span>
                   <span class="k">union</span> <span class="nc">clap_param_value</span> <span class="n">plain_value</span><span class="p">,</span>
                   <span class="kt">bool</span>                   <span class="n">is_recordable</span><span class="p">);</span>

   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rescan</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
<div class="section" id="clap-ext-gui-h">
<h2><a class="toc-backref" href="#id37">clap/ext/gui.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_GUI_H
#define CLAP_EXT_GUI_H
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../clap.h&quot;</span><span class="cp">
</span>
<span class="cp">#define CLAP_EXT_GUI &quot;clap/gui&quot;
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="k">struct</span> <span class="nc">clap_plugin_gui</span> <span class="p">{</span>
   <span class="c1">// Get the size of the plugin UI.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_size</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                    <span class="kt">int32_t</span> <span class="o">*</span>           <span class="n">width</span><span class="p">,</span>
                    <span class="kt">int32_t</span> <span class="o">*</span>           <span class="n">height</span><span class="p">);</span>

   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">close</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_host_gui</span> <span class="p">{</span>
   <span class="cm">/* Request the host to resize the client area to width, height.
    * Return true on success, false otherwise.
    * [thread-safe] */</span>
   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">resize</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="kt">int32_t</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int32_t</span> <span class="n">height</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif
</span>
<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_GUI_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-gui-win32-h">
<h2><a class="toc-backref" href="#id38">clap/ext/gui-win32.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#pragma once
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../clap.h&quot;</span><span class="cp">
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="cp">#define CLAP_EXT_GUI_WIN32 &quot;clap/gui/win32&quot;
</span>
<span class="c1">// we don't want to include windows.h from this file.
</span><span class="k">typedef</span> <span class="kt">void</span> <span class="o">*</span><span class="n">clap_hwnd</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">clap_plugin_gui_win32</span> <span class="p">{</span>
   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">attach</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="n">clap_hwnd</span> <span class="n">window</span><span class="p">);</span>

   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">detach</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
<div class="section" id="clap-ext-gui-x11-h">
<h2><a class="toc-backref" href="#id39">clap/ext/gui-x11.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#pragma once
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../clap.h&quot;</span><span class="cp">
</span>
<span class="cp">#define CLAP_EXT_GUI_X11 &quot;clap/gui/x11&quot;
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="k">struct</span> <span class="nc">clap_plugin_gui_x11</span> <span class="p">{</span>
   <span class="c1">// Use the protocol XEmbed
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">attach</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span>        <span class="n">display_name</span><span class="p">,</span>
                  <span class="kt">unsigned</span> <span class="kt">long</span>       <span class="n">window</span><span class="p">);</span>

   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">detach</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
<div class="section" id="clap-ext-gui-cocoa-h">
<h2><a class="toc-backref" href="#id40">clap/ext/gui-cocoa.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#pragma once
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../clap.h&quot;</span><span class="cp">
</span>
<span class="cp">#define CLAP_EXT_GUI_COCOA &quot;clap/gui/cocoa&quot;
</span>
<span class="k">struct</span> <span class="nc">clap_plugin_embed_cocoa</span> <span class="p">{</span>
   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">attach</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">nsView</span><span class="p">);</span>

   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">detach</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
<div class="section" id="clap-ext-draft-key-name-h">
<h2><a class="toc-backref" href="#id41">clap/ext/draft/key-name.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#pragma once
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp">#endif
</span>
<span class="cp">#include</span> <span class="cpf">&quot;../../clap.h&quot;</span><span class="cp">
</span>
<span class="cp">#define CLAP_EXT_KEY_NAME &quot;clap/draft/key-name&quot;
</span>
<span class="k">struct</span> <span class="nc">clap_key_name</span> <span class="p">{</span>
   <span class="kt">char</span>   <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
   <span class="kt">int8_t</span> <span class="n">key</span><span class="p">;</span>
   <span class="kt">int8_t</span> <span class="n">channel</span><span class="p">;</span> <span class="c1">// -1 for every channels
</span><span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_plugin_key_name</span> <span class="p">{</span>
   <span class="c1">// Return the number of key names
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">count</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

   <span class="c1">// Returns true on success and stores the result into key_name
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span>  <span class="n">plugin</span><span class="p">,</span>
               <span class="kt">int</span>                   <span class="n">index</span><span class="p">,</span>
               <span class="k">struct</span> <span class="nc">clap_key_name</span> <span class="o">*</span><span class="n">key_name</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">clap_host_key_name</span> <span class="p">{</span>
   <span class="c1">// Informs the host that the drum map has changed.
</span>   <span class="c1">// [main-thread]
</span>   <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">changed</span><span class="p">)(</span><span class="k">struct</span> <span class="nc">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">struct</span> <span class="nc">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif</span>
</pre>
</div>
</div>
</div>
</body>
</html>
