<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>CLAP (CLever Audio Plugin)</title>
<style type="text/css">

.document {
    width: 755px;
}

.title {
    text-align: center;
}

.subtitle {
    text-align: center;
}

.reference, .toc-backref {
    text-decoration: none;
    color: #942;
}

.reference:hover, .toc-backref:hover {
    color: #294;
}

tt.docutils {
    color: #237;
    font-size: 100%;
}

</style>
<style type="text/css">

.code .hll { background-color: #49483e }
.code  { background: #272822; color: #f8f8f2 }
.code .c { color: #75715e } /* Comment */
.code .err { color: #960050; background-color: #1e0010 } /* Error */
.code .k { color: #66d9ef } /* Keyword */
.code .l { color: #ae81ff } /* Literal */
.code .n { color: #f8f8f2 } /* Name */
.code .o { color: #f92672 } /* Operator */
.code .p { color: #f8f8f2 } /* Punctuation */
.code .cm { color: #75715e } /* Comment.Multiline */
.code .cp { color: #75715e } /* Comment.Preproc */
.code .c1 { color: #75715e } /* Comment.Single */
.code .cs { color: #75715e } /* Comment.Special */
.code .ge { font-style: italic } /* Generic.Emph */
.code .gs { font-weight: bold } /* Generic.Strong */
.code .kc { color: #66d9ef } /* Keyword.Constant */
.code .kd { color: #66d9ef } /* Keyword.Declaration */
.code .kn { color: #f92672 } /* Keyword.Namespace */
.code .kp { color: #66d9ef } /* Keyword.Pseudo */
.code .kr { color: #66d9ef } /* Keyword.Reserved */
.code .kt { color: #66d9ef } /* Keyword.Type */
.code .ld { color: #e6db74 } /* Literal.Date */
.code .m { color: #ae81ff } /* Literal.Number */
.code .s { color: #e6db74 } /* Literal.String */
.code .na { color: #a6e22e } /* Name.Attribute */
.code .nb { color: #f8f8f2 } /* Name.Builtin */
.code .nc { color: #a6e22e } /* Name.Class */
.code .no { color: #66d9ef } /* Name.Constant */
.code .nd { color: #a6e22e } /* Name.Decorator */
.code .ni { color: #f8f8f2 } /* Name.Entity */
.code .ne { color: #a6e22e } /* Name.Exception */
.code .nf { color: #a6e22e } /* Name.Function */
.code .nl { color: #f8f8f2 } /* Name.Label */
.code .nn { color: #f8f8f2 } /* Name.Namespace */
.code .nx { color: #a6e22e } /* Name.Other */
.code .py { color: #f8f8f2 } /* Name.Property */
.code .nt { color: #f92672 } /* Name.Tag */
.code .nv { color: #f8f8f2 } /* Name.Variable */
.code .ow { color: #f92672 } /* Operator.Word */
.code .w { color: #f8f8f2 } /* Text.Whitespace */
.code .mf { color: #ae81ff } /* Literal.Number.Float */
.code .mh { color: #ae81ff } /* Literal.Number.Hex */
.code .mi { color: #ae81ff } /* Literal.Number.Integer */
.code .mo { color: #ae81ff } /* Literal.Number.Oct */
.code .sb { color: #e6db74 } /* Literal.String.Backtick */
.code .sc { color: #e6db74 } /* Literal.String.Char */
.code .sd { color: #e6db74 } /* Literal.String.Doc */
.code .s2 { color: #e6db74 } /* Literal.String.Double */
.code .se { color: #ae81ff } /* Literal.String.Escape */
.code .sh { color: #e6db74 } /* Literal.String.Heredoc */
.code .si { color: #e6db74 } /* Literal.String.Interpol */
.code .sx { color: #e6db74 } /* Literal.String.Other */
.code .sr { color: #e6db74 } /* Literal.String.Regex */
.code .s1 { color: #e6db74 } /* Literal.String.Single */
.code .ss { color: #e6db74 } /* Literal.String.Symbol */
.code .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
.code .vc { color: #f8f8f2 } /* Name.Variable.Class */
.code .vg { color: #f8f8f2 } /* Name.Variable.Global */
.code .vi { color: #f8f8f2 } /* Name.Variable.Instance */
.code .il { color: #ae81ff } /* Literal.Number.Integer.Long */

</style>
</head>
<body>
<div class="document" id="clap-clever-audio-plugin">
<h1 class="title">CLAP (CLever Audio Plugin)</h1>
<h2 class="subtitle" id="a-free-audio-plugin-format">A free audio plugin format</h2>

<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#goals" id="id2">Goals</a><ul>
<li><a class="reference internal" href="#later-goals" id="id3">Later goals</a></li>
<li><a class="reference internal" href="#design-choice" id="id4">Design choice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification" id="id5">Specification</a><ul>
<li><a class="reference internal" href="#how-to-read-the-specification" id="id6">How to read the specification</a></li>
<li><a class="reference internal" href="#encoding" id="id7">Encoding</a></li>
<li><a class="reference internal" href="#plugins-location" id="id8">Plugins location</a><ul>
<li><a class="reference internal" href="#common" id="id9">Common</a></li>
<li><a class="reference internal" href="#linux" id="id10">Linux</a></li>
<li><a class="reference internal" href="#windows" id="id11">Windows</a></li>
<li><a class="reference internal" href="#mac" id="id12">Mac</a></li>
<li><a class="reference internal" href="#multi-architecture-conventions" id="id13">Multi-architecture conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#instantiate-a-plugin" id="id14">Instantiate a plugin</a><ul>
<li><a class="reference internal" href="#precautions" id="id15">Precautions</a></li>
<li><a class="reference internal" href="#plugins-collection" id="id16">Plugins collection</a><ul>
<li><a class="reference internal" href="#sample-plugin-loader" id="id17">Sample plugin loader</a></li>
</ul>
</li>
<li><a class="reference internal" href="#description" id="id18">Description</a></li>
<li><a class="reference internal" href="#audio-ports-configuration" id="id19">Audio ports configuration</a><ul>
<li><a class="reference internal" href="#pin-layout" id="id20">Pin layout</a></li>
<li><a class="reference internal" href="#available-configurations" id="id21">Available configurations</a></li>
<li><a class="reference internal" href="#selecting-a-configuration" id="id22">Selecting a configuration</a></li>
<li><a class="reference internal" href="#repeatable-channels" id="id23">Repeatable channels</a></li>
<li><a class="reference internal" href="#feedback-stream" id="id24">Feedback stream</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#threading" id="id25">Threading</a></li>
<li><a class="reference internal" href="#activation" id="id26">Activation</a></li>
<li><a class="reference internal" href="#processing" id="id27">Processing</a><ul>
<li><a class="reference internal" href="#audio-buffers" id="id28">Audio buffers</a></li>
<li><a class="reference internal" href="#events" id="id29">Events</a><ul>
<li><a class="reference internal" href="#notes" id="id30">Notes</a></li>
<li><a class="reference internal" href="#parameters" id="id31">Parameters</a></li>
<li><a class="reference internal" href="#pitch" id="id32">Pitch</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id1" id="id33">Parameters</a><ul>
<li><a class="reference internal" href="#types" id="id34">Types</a></li>
<li><a class="reference internal" href="#scales" id="id35">Scales</a></li>
<li><a class="reference internal" href="#automation" id="id36">Automation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphical-user-interface" id="id37">Graphical User Interface</a><ul>
<li><a class="reference internal" href="#showing-the-gui" id="id38">Showing the GUI</a></li>
<li><a class="reference internal" href="#sending-events-to-the-host" id="id39">Sending events to the host</a></li>
<li><a class="reference internal" href="#hiding-the-gui" id="id40">Hiding the GUI</a></li>
<li><a class="reference internal" href="#embedding" id="id41">Embedding</a><ul>
<li><a class="reference internal" href="#sample-on-windows" id="id42">Sample on Windows</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#presets" id="id43">Presets</a><ul>
<li><a class="reference internal" href="#list-plugin-s-presets" id="id44">List plugin's presets</a></li>
<li><a class="reference internal" href="#load-a-preset" id="id45">Load a preset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#save-and-restore-plugin-s-state" id="id46">Save and restore plugin's state</a></li>
<li><a class="reference internal" href="#extension-system" id="id47">Extension system</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id48">Examples</a><ul>
<li><a class="reference internal" href="#samples-clap-info-c" id="id49">samples/clap-info.c</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id50">References</a><ul>
<li><a class="reference internal" href="#clap-h" id="id51">clap.h</a></li>
<li><a class="reference internal" href="#clap-embed-h" id="id52">clap-embed.h</a></li>
<li><a class="reference internal" href="#clap-embed-win32-h" id="id53">clap-embed-win32.h</a></li>
<li><a class="reference internal" href="#clap-embed-xlib-h" id="id54">clap-embed-xlib.h</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="goals">
<h1><a class="toc-backref" href="#id2">Goals</a></h1>
<ul class="simple">
<li>Make a free audio plugin format</li>
<li>Be easy to understand and implement</li>
<li>Bring new features missed in VST 2.4</li>
<li>Replace old concepts by modern ones. For example the specification tries
to not use MIDI as its internal event systems, which let us have
micro-tones. Yet MIDI events are possible.</li>
<li>Designed to work on any operating system</li>
<li>Be event oriented</li>
<li>Be extensible without breaking existing plugins</li>
<li>Be easy to bridge</li>
</ul>
<div class="section" id="later-goals">
<h2><a class="toc-backref" href="#id3">Later goals</a></h2>
<ul class="simple">
<li>Provide a reference host</li>
<li>Provide some reference plugins</li>
<li>Provide a validation plugin, which should signal anything wrong the host does</li>
<li>Provide a validation host, which should give hard time to the plugin and
ensure that basic functionnality are working</li>
</ul>
</div>
<div class="section" id="design-choice">
<h2><a class="toc-backref" href="#id4">Design choice</a></h2>
<ul class="simple">
<li>The plugin and the host interface must be thread-safe.</li>
<li>Avoid pointer exchange between the host and the plugin
whenever it is possible. The chosen way is to pass a buffer
as a parameter and let the host/plugin copy/read data from it.
Rationale: as the host and the plugin can be multi-threaded,
keeping pointers to the plugin or host internal memory can lead
to race conditions. Also it can lead to ambiguities about who's
responsible to free the memory. Also the host and the plugin
may use custom allocator.</li>
<li>Use the C language.</li>
<li>Have support for dynamic configuration, to let a modular plugin
add new parameters, new outputs/inputs, etc... dynamically.</li>
</ul>
</div>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id5">Specification</a></h1>
<div class="section" id="how-to-read-the-specification">
<h2><a class="toc-backref" href="#id6">How to read the specification</a></h2>
<p>The specification should be read along the reference headers.
<a class="reference external" href="https://abique.github.io/clap/">https://abique.github.io/clap/</a> gives a convinient view for that.</p>
</div>
<div class="section" id="encoding">
<h2><a class="toc-backref" href="#id7">Encoding</a></h2>
<p>All the strings exchanged through the CLAP interface must be encoded in UTF-8
and must be valid.</p>
</div>
<div class="section" id="plugins-location">
<h2><a class="toc-backref" href="#id8">Plugins location</a></h2>
<div class="section" id="common">
<h3><a class="toc-backref" href="#id9">Common</a></h3>
<ul class="simple">
<li>Directories should be scanned recursively.</li>
</ul>
</div>
<div class="section" id="linux">
<h3><a class="toc-backref" href="#id10">Linux</a></h3>
<ul class="simple">
<li>Plugins distributed with packages should be installed to: <tt class="docutils literal">/usr/lib/clap/</tt></li>
<li>Plugins installed in the user's home should be installed to: <tt class="docutils literal"><span class="pre">${HOME}/.clap/</span></tt></li>
</ul>
</div>
<div class="section" id="windows">
<h3><a class="toc-backref" href="#id11">Windows</a></h3>
<p>TBD</p>
</div>
<div class="section" id="mac">
<h3><a class="toc-backref" href="#id12">Mac</a></h3>
<p>TBD</p>
</div>
<div class="section" id="multi-architecture-conventions">
<h3><a class="toc-backref" href="#id13">Multi-architecture conventions</a></h3>
<p>Let's say that we have a plugin called <tt class="docutils literal">DigitalDragon</tt>. If we distribute
it for multiple architecture, then the host should be able to identify which
version is suited for the current architecture by reading its name.</p>
<p>For example:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Archtecture</th>
<th class="head">Filename</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>x86</td>
<td>DigitalDragon.x86.so</td>
</tr>
<tr><td>x86_64</td>
<td>DigitalDragon.x86_64.so</td>
</tr>
<tr><td>alpha</td>
<td>DigitalDragon.alpha.so</td>
</tr>
<tr><td>arm</td>
<td>DigitalDragon.arm.so</td>
</tr>
<tr><td>sparc</td>
<td>DigitalDragon.sparc.so</td>
</tr>
<tr><td>hppa</td>
<td>DigitalDragon.hppa.so</td>
</tr>
<tr><td>ppc</td>
<td>DigitalDragon.ppc.so</td>
</tr>
<tr><td>ppc64</td>
<td>DigitalDragon.ppc64.so</td>
</tr>
</tbody>
</table>
<p>If the name does not contain an indicator, then the plugin should be
built for the native/current architecture.</p>
</div>
</div>
<div class="section" id="instantiate-a-plugin">
<h2><a class="toc-backref" href="#id14">Instantiate a plugin</a></h2>
<p>Plugin instantiating can be done in a few steps:</p>
<ul class="simple">
<li>load the plugin library</li>
<li>find the symbol <tt class="docutils literal">clap_create</tt></li>
<li>instantiate the plugin by calling <tt class="docutils literal">clap_create</tt></li>
</ul>
<div class="section" id="precautions">
<h3><a class="toc-backref" href="#id15">Precautions</a></h3>
<ul class="simple">
<li>The function <tt class="docutils literal">clap_create</tt> must be thread-safe.</li>
<li>It must not throw exceptions.</li>
<li>It can return <tt class="docutils literal">NULL</tt>.</li>
</ul>
</div>
<div class="section" id="plugins-collection">
<h3><a class="toc-backref" href="#id16">Plugins collection</a></h3>
<p>A single dynamic library can contains multiple clap plugins.
To list them, you have to call <tt class="docutils literal">clap_create</tt> with an index of 0 and increment
the index until you reach <tt class="docutils literal">plugin_count</tt>.
<tt class="docutils literal">clap_create</tt> returns <tt class="docutils literal">NULL</tt> if the plugin creation failed or if
<tt class="docutils literal">plugin_index &gt;= plugin_count</tt>.</p>
<div class="section" id="sample-plugin-loader">
<h4><a class="toc-backref" href="#id17">Sample plugin loader</a></h4>
<p>See <a class="reference internal" href="#samples-clap-info-c">samples/clap-info.c</a></p>
</div>
</div>
<div class="section" id="description">
<h3><a class="toc-backref" href="#id18">Description</a></h3>
<p>Both the <tt class="docutils literal">struct clap_plugin;</tt> and <tt class="docutils literal">struct clap_host;</tt> have a few attribute giving
general plugin/host information.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>clap_version</td>
<td>Described the plugin format version implemented. Should be
initialized with CLAP_PLUGIN_VERSION,
or CLAP_VERSION_MAKE(1, 0, 0) if you want to only support
version 1.0.0</td>
</tr>
<tr><td>id</td>
<td>Unique identifier of the plugin. It should never change. It
should be the same on 32bits or 64bits or whatever.</td>
</tr>
<tr><td>name</td>
<td>The name of the product.</td>
</tr>
<tr><td>description</td>
<td>A brief description of the product.</td>
</tr>
<tr><td>manufacturer</td>
<td>Which company made the plugin.</td>
</tr>
<tr><td>version</td>
<td>A string describing the product version.</td>
</tr>
<tr><td>url</td>
<td>An URL to the product homepage.</td>
</tr>
<tr><td>license</td>
<td>The plugin license type, Custom, GPLv3, MIT, ...</td>
</tr>
<tr><td>support</td>
<td>A link to the support, it can be
<tt class="docutils literal">mailto:support&#64;company.com</tt> or
<tt class="docutils literal"><span class="pre">http://company.com/support</span></tt>.</td>
</tr>
<tr><td>categories</td>
<td>A string containing a list of categories, joined with <tt class="docutils literal">;</tt>.
For example: <tt class="docutils literal">fm;analogue;delay</tt>.</td>
</tr>
<tr><td>type</td>
<td>Bitfield describing what the plugin does. See
<tt class="docutils literal">enum clap_plugin_type</tt>.</td>
</tr>
<tr><td>chunk_size</td>
<td>The process buffer, must have a number of sample multiple of
<tt class="docutils literal">chunk_size</tt>.</td>
</tr>
<tr><td>latency</td>
<td>The latency introduced by the plugin.</td>
</tr>
<tr><td>has_gui</td>
<td>True if the plugin can show a graphical user interface</td>
</tr>
<tr><td>supports_tuning</td>
<td>True if the plugin supports tuning</td>
</tr>
<tr><td>supports_microtones</td>
<td>True if the plugin supports micro tones</td>
</tr>
<tr><td>host_data</td>
<td>Reserved pointer for the host.</td>
</tr>
<tr><td>plugin_data</td>
<td>Reserved pointer for the plugin.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="audio-ports-configuration">
<h3><a class="toc-backref" href="#id19">Audio ports configuration</a></h3>
<p>A plugin may have multiple audio ports, and so multiple audio ports
layout or configurations.</p>
<p>An audio port has a type: mono, stereo, surround and a role: main
input/output, sidechain, feedback.</p>
<div class="section" id="pin-layout">
<h4><a class="toc-backref" href="#id20">Pin layout</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="14%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">type</th>
<th class="head">pin</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>mono</td>
<td>0</td>
<td>mono</td>
</tr>
<tr><td rowspan="2">stereo</td>
<td>0</td>
<td>left</td>
</tr>
<tr><td>1</td>
<td>right</td>
</tr>
<tr><td rowspan="8">surround</td>
<td>0</td>
<td>front left</td>
</tr>
<tr><td>1</td>
<td>front right</td>
</tr>
<tr><td>2</td>
<td>center</td>
</tr>
<tr><td>3</td>
<td>low frequency</td>
</tr>
<tr><td>4</td>
<td>surround left</td>
</tr>
<tr><td>5</td>
<td>surround right</td>
</tr>
<tr><td>6</td>
<td>surround back left</td>
</tr>
<tr><td>7</td>
<td>surround back right</td>
</tr>
</tbody>
</table>
<p>So for the following configuration:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="15%" />
<col width="18%" />
<col width="31%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">in/out</th>
<th class="head">type</th>
<th class="head">role</th>
<th class="head">buffer</th>
<th class="head">desc</th>
</tr>
</thead>
<tbody valign="top">
<tr><td rowspan="2">input</td>
<td rowspan="2">stereo</td>
<td rowspan="2">inout</td>
<td>process-&gt;inputs[0]</td>
<td>left input</td>
</tr>
<tr><td>process-&gt;inputs[1]</td>
<td>right input</td>
</tr>
<tr><td rowspan="2">input</td>
<td rowspan="2">stereo</td>
<td rowspan="2">sidechain</td>
<td>process-&gt;inputs[2]</td>
<td>left sidechain</td>
</tr>
<tr><td>process-&gt;inputs[3]</td>
<td>right sidechain</td>
</tr>
<tr><td rowspan="2">input</td>
<td rowspan="2">stereo</td>
<td rowspan="2">feedback</td>
<td>process-&gt;inputs[4]</td>
<td>left feedback</td>
</tr>
<tr><td>process-&gt;inputs[5]</td>
<td>right feedback</td>
</tr>
<tr><td rowspan="2">output</td>
<td rowspan="2">stereo</td>
<td rowspan="2">inout</td>
<td>process-&gt;outputs[0]</td>
<td>left input</td>
</tr>
<tr><td>process-&gt;outputs[1]</td>
<td>right input</td>
</tr>
<tr><td rowspan="2">output</td>
<td rowspan="2">stereo</td>
<td rowspan="2">feedback</td>
<td>process-&gt;outputs[2]</td>
<td>left feedback</td>
</tr>
<tr><td>process-&gt;outputs[3]</td>
<td>right feedback</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="available-configurations">
<h4><a class="toc-backref" href="#id21">Available configurations</a></h4>
<p>It is possible to discover a plugin's port configurations by calling
<tt class="docutils literal"><span class="pre">plugin-&gt;get_ports_configs_count(plugin);</span></tt>. It returns the number of
configurations. Then for each configuration you have to call
<tt class="docutils literal"><span class="pre">plugin-&gt;get_ports_config(plugin,</span> config_index, &amp;config);</tt> which will
tell you the number of input and output ports. Then to get the port details,
you have to call
<tt class="docutils literal"><span class="pre">plugin-&gt;get_port_info(plugin,</span> config_index, port_index, &amp;port);</tt>.</p>
</div>
<div class="section" id="selecting-a-configuration">
<h4><a class="toc-backref" href="#id22">Selecting a configuration</a></h4>
<p>Selecting an audio configuration has to be done when the plugin is deactivated.
It is done by calling <tt class="docutils literal"><span class="pre">plugin-&gt;set_port_config(plugin,</span> config_index)</tt>.
If the call returns false, then the plugin is in failed state.</p>
</div>
<div class="section" id="repeatable-channels">
<h4><a class="toc-backref" href="#id23">Repeatable channels</a></h4>
<p>Repeatable channels are a special case. A channel can be identified as
repeatable if <tt class="docutils literal"><span class="pre">channel-&gt;is_repeatable</span> == true</tt>.</p>
<p>A useful case is for an analyzer. Imagine a spectroscope, to which you want to
plug any number of inputs. Each of those inputs can be named and displayed in
the spectrograph, so it is a convinient way analyze many tracks in the same
spectroscope.</p>
<p>For the special case of repeatable side chain input, the host
has to tell the plugin how many times the port should be repeated.
To do that it has to call <tt class="docutils literal"><span class="pre">plugin-&gt;set_port_repeat(plugin,</span> port_index, count)</tt>.
If it returns <tt class="docutils literal">false</tt> then the plugin is in the same state as before
the call.</p>
</div>
<div class="section" id="feedback-stream">
<h4><a class="toc-backref" href="#id24">Feedback stream</a></h4>
<p>Feedback stream are used to plug external audio processing into one
of the plugin feedback loop.</p>
<p>A practical usage is to put an effect in a delay feedback loop.</p>
<p>A feedback loop has it's both ends identified by <tt class="docutils literal"><span class="pre">clap_channel-&gt;stream_id</span></tt>.</p>
<p>During the audio processing, <tt class="docutils literal">struct clap_process</tt> contains a callback which
is used to process the feedback stream:</p>
<pre class="code c literal-block">
<span class="kt">void</span> <span class="nf">my_plugin_process</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">struct</span> <span class="n">clap_process</span> <span class="o">*</span><span class="n">process</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">fb_in</span><span class="p">;</span>     <span class="c1">// index to the stereo feedback input buffer
</span>  <span class="kt">uint32_t</span> <span class="n">fb_out</span><span class="p">;</span>    <span class="c1">// index to the stereo feedback output buffer
</span>  <span class="kt">uint32_t</span> <span class="n">stream_id</span><span class="p">;</span> <span class="c1">// the feedback stream id
</span>  <span class="kt">uint32_t</span> <span class="n">offset</span><span class="p">;</span>

  <span class="c1">// process all the buffer
</span>  <span class="k">for</span> <span class="p">(</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="n">process</span><span class="o">-&gt;</span><span class="n">nb_samples</span><span class="p">;</span>
       <span class="n">offset</span> <span class="o">+=</span> <span class="n">process</span><span class="o">-&gt;</span><span class="n">feedback_chunk_size</span><span class="p">)</span>
  <span class="p">{</span>

    <span class="c1">// ...
</span>
    <span class="c1">// prepare feedback output buffer
</span>    <span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">process</span><span class="o">-&gt;</span><span class="n">feedback_chunk_size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">process</span><span class="o">-&gt;</span><span class="n">output</span><span class="p">[</span><span class="n">fb_out</span><span class="p">][</span><span class="n">offset</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>     <span class="o">=</span> <span class="n">XXX</span><span class="p">;</span>
      <span class="n">process</span><span class="o">-&gt;</span><span class="n">output</span><span class="p">[</span><span class="n">fb_out</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">offset</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">XXX</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// process one sample feedback
</span>    <span class="n">process</span><span class="o">-&gt;</span><span class="n">feedback</span><span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="n">stream_id</span><span class="p">,</span> <span class="n">process</span><span class="o">-&gt;</span><span class="n">feedback_chunk_size</span><span class="p">);</span>

    <span class="c1">// audio processing of the feedback values:
</span>    <span class="c1">//   process-&gt;input[fb_in][offset + i]
</span>    <span class="c1">//   process-&gt;input[fb_in + 1][offset + i]
</span>  <span class="p">}</span>
<span class="p">}</span>
</pre>
</div>
</div>
</div>
<div class="section" id="threading">
<h2><a class="toc-backref" href="#id25">Threading</a></h2>
<p>The plugin must be thread safe.</p>
</div>
<div class="section" id="activation">
<h2><a class="toc-backref" href="#id26">Activation</a></h2>
<p>Before doing any processing, the plugin must be activated by calling
<tt class="docutils literal">bool succeed = <span class="pre">plugin-&gt;activate(plugin);</span></tt>.</p>
<p>If <tt class="docutils literal">succeed == true</tt> then the activation succeed. If the activation failed,
then the plugin is unusable.</p>
<p>The host must not call <tt class="docutils literal">activate()</tt> if the plugin is already activated.
Yet the plugin should handle correctly double calls to <tt class="docutils literal">activate()</tt>.</p>
<p>The plugin activation could be nothing, or could be a task which takes time,
like connecting a remote server. So the host should not activate plugins in
the audio processing thread.</p>
<p>To deactivate the plugin, just call <tt class="docutils literal"><span class="pre">plugin-&gt;deactivate(plugin)</span></tt>. Like
<tt class="docutils literal">activate()</tt>, <tt class="docutils literal">deactivate()</tt> should not be called from the audio processing
thread as it may take time.</p>
<p>Also <tt class="docutils literal">deactivate()</tt> should not be called if the plugin is not activated.
Yet the plugin should handle a call to <tt class="docutils literal">deactivate()</tt> even if it is
not activated.</p>
<p>It is preferable to de-activate the plugin before destroying it.</p>
</div>
<div class="section" id="processing">
<h2><a class="toc-backref" href="#id27">Processing</a></h2>
<p>The processing is done in one call: <tt class="docutils literal"><span class="pre">plugin-&gt;process(plugin,</span> process);</tt>.
The data structure process regroup everything needed by the plugin:</p>
<ul class="simple">
<li>audio buffers (in, out)</li>
<li>feedback process callback</li>
<li>events (in)</li>
<li>tempo, time, is offline? (in)</li>
<li>more processing needed (out)</li>
</ul>
<div class="section" id="audio-buffers">
<h3><a class="toc-backref" href="#id28">Audio buffers</a></h3>
<ul class="simple">
<li>The audio buffers are allocated by the host. They must be aligned by the
maximum requirement of the vector instructions currently available.</li>
<li>In-place processing is not supported.</li>
<li>The number of samples must be a multiple of <tt class="docutils literal"><span class="pre">plugin-&gt;chunk_size</span></tt>.</li>
<li>See <a class="reference internal" href="#pin-layout">Pin layout</a>.</li>
</ul>
</div>
<div class="section" id="events">
<h3><a class="toc-backref" href="#id29">Events</a></h3>
<ul class="simple">
<li>Event's time must be within the process duration:
<tt class="docutils literal"><span class="pre">[process-&gt;steady_time</span> .. <span class="pre">process-&gt;steady_time</span> + <span class="pre">process-&gt;nb_sambles]</span></tt>.</li>
<li>The plugin must not modify the input events (<tt class="docutils literal">in_events</tt>).</li>
</ul>
<div class="section" id="notes">
<h4><a class="toc-backref" href="#id30">Notes</a></h4>
<p>Notes are represented as a pair <tt class="docutils literal">note, division</tt>.
Division is the number of intervals between one note and an other note with
half or the double frequency. A division by 12 must be supported.</p>
<p>If a plugin plugin does not support micro tones, it should ignore
micro-tuned notes.</p>
<p>The host should not send micro tones to the plugin if
<tt class="docutils literal"><span class="pre">plugin-&gt;supports_microtones</span> == false</tt>.</p>
</div>
<div class="section" id="parameters">
<h4><a class="toc-backref" href="#id31">Parameters</a></h4>
<p>Parameters can be automated by the host using <tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> or
<tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt>.</p>
<p>When using <tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt>, the value of the parameter has to be
incremented by <tt class="docutils literal"><span class="pre">event-&gt;param.increment</span></tt> each steps until an other event
occur on this parameter.</p>
</div>
<div class="section" id="pitch">
<h4><a class="toc-backref" href="#id32">Pitch</a></h4>
<p>The pitch is the frequency of the note A4. Its default value is 440Hz.
The pitch can be changed by the host using the <tt class="docutils literal">CLAP_EVENT_PITCH_SET</tt> event.</p>
</div>
</div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id33">Parameters</a></h2>
<p>The host can get the plugin's parameters tree by calling:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">plugin-&gt;get_params_count(plugin);</span></tt> to know the number of parameters</li>
<li><tt class="docutils literal"><span class="pre">plugin-&gt;get_param(plugin,</span> param_index, &amp;param);</tt> to get the parameter
value and description</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">type</tt></td>
<td>The type of parameter. Must never change.</td>
</tr>
<tr><td><tt class="docutils literal">id</tt></td>
<td>What identifies the parameter. Must never change.
This field must be saved along automation.</td>
</tr>
<tr><td><tt class="docutils literal">name</tt></td>
<td>The name of the parameter. This can change.
Meant to be displayed.</td>
</tr>
<tr><td><tt class="docutils literal">desc</tt></td>
<td>The description of the parameter. This can change.
Meant to be displayed.</td>
</tr>
<tr><td><tt class="docutils literal">is_per_note</tt></td>
<td><tt class="docutils literal">true</tt> if the parameter can be automated per voice.</td>
</tr>
<tr><td><tt class="docutils literal">display_text</tt></td>
<td>How the value should be displayed. Only used for enum
types.</td>
</tr>
<tr><td><tt class="docutils literal">value</tt></td>
<td>The current value of the parameter.</td>
</tr>
<tr><td><tt class="docutils literal">min</tt></td>
<td>The minimum value of the parameter.</td>
</tr>
<tr><td><tt class="docutils literal">max</tt></td>
<td>The maximum value of the parameter.</td>
</tr>
<tr><td><tt class="docutils literal">scale</tt></td>
<td>The scale to use when exposing the parameter to the user.</td>
</tr>
</tbody>
</table>
<div class="section" id="types">
<h3><a class="toc-backref" href="#id34">Types</a></h3>
<p>There are a few parameter types:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="22%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">type</th>
<th class="head">value attribute</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>group</td>
<td>none</td>
<td>not a value, but the only parameter which can have
child. It should be used to organize parameters in
the host GUI.</td>
</tr>
<tr><td>bool</td>
<td><tt class="docutils literal">value.b</tt></td>
<td>a boolean value, can be true or false</td>
</tr>
<tr><td>float</td>
<td><tt class="docutils literal">value.f</tt></td>
<td>a float value</td>
</tr>
<tr><td>int</td>
<td><tt class="docutils literal">value.i</tt></td>
<td>an integer value</td>
</tr>
<tr><td>enum</td>
<td><tt class="docutils literal">value.i</tt></td>
<td>an enumeration, it uses integer values, and the host
should rely on <tt class="docutils literal">display_text</tt> to show its value.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="scales">
<h3><a class="toc-backref" href="#id35">Scales</a></h3>
<p>The plugin can inform the host, which scale to use for the parameter's UI
(knob, slider, ...). <tt class="docutils literal"><span class="pre">clap_param-&gt;scale</span></tt> can be set to <tt class="docutils literal">CLAP_PARAM_LINEAR</tt>
or <tt class="docutils literal">CLAP_PARAM_LOG</tt>. A logarithmic scale is convinient for a frequency
parameter.</p>
</div>
<div class="section" id="automation">
<h3><a class="toc-backref" href="#id36">Automation</a></h3>
<p>When a parameter is modified by the GUI, the plugin should send a
<tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> event must be sent to the host, using
<tt class="docutils literal"><span class="pre">host-&gt;events(host,</span> plugin, events);</tt> so the host can record the automation.</p>
<p>When a parameter is modified by an other parameter, for example imagine you
have a parameter modulating &quot;absolutely&quot; an other one through an XY mapping.
The host should record the modulation source but not the modulation target.
To do that the plugin uses <tt class="docutils literal"><span class="pre">clap_event_param-&gt;is_recordable</span></tt>.</p>
</div>
</div>
<div class="section" id="graphical-user-interface">
<h2><a class="toc-backref" href="#id37">Graphical User Interface</a></h2>
<div class="section" id="showing-the-gui">
<h3><a class="toc-backref" href="#id38">Showing the GUI</a></h3>
<p>The plugin should show the GUI after a call to <tt class="docutils literal"><span class="pre">plugin-&gt;show_gui(plugin)</span></tt>.
If the plugin could successfully show the GUI, it returns <tt class="docutils literal">true</tt>, <tt class="docutils literal">false</tt>
otherwise.</p>
</div>
<div class="section" id="sending-events-to-the-host">
<h3><a class="toc-backref" href="#id39">Sending events to the host</a></h3>
<p>The plugin can notify the host of parameter changes by sending events to:
<tt class="docutils literal"><span class="pre">host-&gt;events(host,</span> plugin, events);</tt>.</p>
<p>Events sent to the host should be stamped:</p>
<pre class="code c literal-block">
<span class="k">struct</span> <span class="n">clap_event</span> <span class="n">ev</span><span class="p">;</span>
<span class="c1">// ...
</span><span class="n">ev</span><span class="p">.</span><span class="n">sample_offset</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span><span class="p">(</span><span class="n">host</span><span class="p">);</span>
<span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="hiding-the-gui">
<h3><a class="toc-backref" href="#id40">Hiding the GUI</a></h3>
<p>The plugin should hide the GUI after a call to <tt class="docutils literal"><span class="pre">plugin-&gt;hide_gui(plugin)</span></tt>.
If the plugin window has been closed by the user, then the plugin should
send an event <tt class="docutils literal">CLAP_EVENT_GUI_CLOSED</tt> to the host.</p>
<pre class="code c literal-block">
<span class="k">struct</span> <span class="n">clap_event</span> <span class="n">ev</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">CLAP_EVENT_GUI_CLOSED</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">sample_offset</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span><span class="p">(</span><span class="n">host</span><span class="p">);</span>
<span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="embedding">
<h3><a class="toc-backref" href="#id41">Embedding</a></h3>
<p>Some host are designed to embed plugin's window.
As embedding is not a Clap requirement, it is offered as an extension.
Also the OS dependency brought by this feature makes it ideal as an extension.</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="32%" />
<col width="30%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">GUI</th>
<th class="head">header</th>
<th class="head">extension</th>
<th class="head">comment</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Generic</td>
<td><a class="reference internal" href="#clap-embed-h">clap-embed.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED</tt></td>
<td>For the host</td>
</tr>
<tr><td>Windows</td>
<td><a class="reference internal" href="#clap-embed-win32-h">clap-embed-win32.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED_WIN32</tt></td>
<td>For the plugin</td>
</tr>
<tr><td>X11</td>
<td><a class="reference internal" href="#clap-embed-xlib-h">clap-embed-xlib.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED_XLIB</tt></td>
<td>For the plugin</td>
</tr>
</tbody>
</table>
<div class="section" id="sample-on-windows">
<h4><a class="toc-backref" href="#id42">Sample on Windows</a></h4>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/clap.h&gt;
#include &lt;clap/clap-embed-win32.h&gt;
</span>
<span class="k">struct</span> <span class="n">clap_embed_win32</span> <span class="o">*</span><span class="n">embed</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">CLAP_EMBED_WIN32</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">embed</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// the plugin can embed
</span>  <span class="n">embed</span><span class="o">-&gt;</span><span class="n">embed</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">window</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">plugin</span><span class="o">-&gt;</span><span class="n">show_gui</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
</pre>
</div>
</div>
</div>
<div class="section" id="presets">
<h2><a class="toc-backref" href="#id43">Presets</a></h2>
<div class="section" id="list-plugin-s-presets">
<h3><a class="toc-backref" href="#id44">List plugin's presets</a></h3>
<p>The host can browse the plugin's preset by calling:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">plugin-&gt;get_presets_count(plugin);</span></tt> to know how many presets it has.</li>
<li><tt class="docutils literal"><span class="pre">plugin-&gt;get_preset(plugin,</span> preset_index, &amp;preset);</tt> to get a preset
details.</li>
</ul>
</div>
<div class="section" id="load-a-preset">
<h3><a class="toc-backref" href="#id45">Load a preset</a></h3>
<p>To load a preset, the host have to send an event <tt class="docutils literal">CLAP_EVENT_PRESET_SET</tt> to
the plugin.</p>
<p>When a preset is loaded from the plugin's GUI, the plugin must send a
<tt class="docutils literal">CLAP_EVENT_PRESET_SET</tt> to the host.</p>
</div>
</div>
<div class="section" id="save-and-restore-plugin-s-state">
<h2><a class="toc-backref" href="#id46">Save and restore plugin's state</a></h2>
<p>Saving the plugin's state is done by:</p>
<pre class="code c literal-block">
<span class="kt">void</span> <span class="o">*</span><span class="n">buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">plugin</span><span class="o">-&gt;</span><span class="n">save</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">size</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// save failed
</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// save succeed
</span><span class="p">}</span>
</pre>
<p>Restoring the plugin's state is done by:</p>
<pre class="code c literal-block">
<span class="n">plugin</span><span class="o">-&gt;</span><span class="n">restore</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
</pre>
<p>The state of the plugin should be independent of the machine: you can save a
plugin state on a little endian machine and send it through the network to a
big endian machine, it should load again successfully.</p>
</div>
<div class="section" id="extension-system">
<h2><a class="toc-backref" href="#id47">Extension system</a></h2>
<p>To extend clap's functionnality, there is a pretty simple mechanism:</p>
<pre class="code c literal-block">
<span class="kt">void</span> <span class="o">*</span><span class="n">plug_ext</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plug</span><span class="p">,</span> <span class="s">&quot;company/ext-name&quot;</span><span class="p">);</span>
<span class="kt">void</span> <span class="o">*</span><span class="n">host_ext</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="s">&quot;company/ext-name&quot;</span><span class="p">);</span>
</pre>
<p>If the extension is not supported, the plugin should return <tt class="docutils literal">NULL</tt>.</p>
</div>
</div>
<div class="section" id="examples">
<h1><a class="toc-backref" href="#id48">Examples</a></h1>
<div class="section" id="samples-clap-info-c">
<h2><a class="toc-backref" href="#id49">samples/clap-info.c</a></h2>
<pre class="code c literal-block">
<span class="cp">#include &lt;stdio.h&gt;
#include &lt;dlfcn.h&gt;
</span>
<span class="cp">#include &lt;clap/clap.h&gt;
</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">host_events</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span>   <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                        <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                        <span class="k">struct</span> <span class="n">clap_event</span>  <span class="o">*</span><span class="n">events</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">uint64_t</span> <span class="nf">host_steady_time</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">host_extension</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extension_id</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">initialize_host</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">clap_version</span> <span class="o">=</span> <span class="n">CLAP_VERSION</span><span class="p">;</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span>       <span class="o">=</span> <span class="n">host_events</span><span class="p">;</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span>  <span class="o">=</span> <span class="n">host_steady_time</span><span class="p">;</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">extension</span>    <span class="o">=</span> <span class="n">host_extension</span><span class="p">;</span>
  <span class="n">snprintf</span><span class="p">(</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">),</span> <span class="s">&quot;clap-info&quot;</span><span class="p">);</span>
  <span class="n">snprintf</span><span class="p">(</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">manufacturer</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">manufacturer</span><span class="p">),</span> <span class="s">&quot;clap&quot;</span><span class="p">);</span>
  <span class="n">snprintf</span><span class="p">(</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">version</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">host</span><span class="o">-&gt;</span><span class="n">version</span><span class="p">),</span> <span class="s">&quot;1.0&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">struct</span> <span class="n">clap_host</span> <span class="n">host</span><span class="p">;</span>
  <span class="n">initialize_host</span><span class="p">(</span><span class="o">&amp;</span><span class="n">host</span><span class="p">);</span>

  <span class="kt">void</span> <span class="o">*</span> <span class="n">handle</span> <span class="o">=</span> <span class="n">dlopen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RTLD_NOW</span> <span class="o">|</span> <span class="n">RTLD_LOCAL</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">handle</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;failed to load %s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dlerror</span><span class="p">());</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">union</span> <span class="p">{</span>
    <span class="kt">void</span>          <span class="o">*</span><span class="n">ptr</span><span class="p">;</span>
    <span class="n">clap_create_f</span>  <span class="n">clap_create</span><span class="p">;</span>
  <span class="p">}</span> <span class="n">symbol</span><span class="p">;</span>

  <span class="n">symbol</span><span class="p">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">dlsym</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s">&quot;clap_create&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">symbol</span><span class="p">.</span><span class="n">ptr</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;symbol not found: clap_create</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kt">uint32_t</span> <span class="n">plugin_count</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">plugin_count</span><span class="p">;</span> <span class="o">++</span><span class="n">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span> <span class="o">=</span> <span class="n">symbol</span><span class="p">.</span><span class="n">clap_create</span><span class="p">(</span>
      <span class="n">index</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">host</span><span class="p">,</span> <span class="mi">48000</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">plugin_count</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">plugin</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;failed to create plugin index %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; id: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; name: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; description: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">description</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; manufacturer: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">manufacturer</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; version: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">version</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; url: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">url</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; support: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">support</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; license: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">license</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; categories: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">categories</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; type:&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">plugin</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">CLAP_PLUGIN_INSTRUMENT</span><span class="p">)</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; instrument&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">plugin</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">CLAP_PLUGIN_EFFECT</span><span class="p">)</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; effect&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">plugin</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">CLAP_PLUGIN_EVENT_EFFECT</span><span class="p">)</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; event_effect&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">plugin</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">CLAP_PLUGIN_ANALYZER</span><span class="p">)</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; analyzer&quot;</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; chunk_size: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">chunk_size</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; has_gui: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">has_gui</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; supports_tunning: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">supports_tunning</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot; supports_microtones: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">supports_microtones</span><span class="p">);</span>

    <span class="c1">// destroy the plugin
</span>    <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">destroy</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id50">References</a></h1>
<div class="section" id="clap-h">
<h2><a class="toc-backref" href="#id51">clap.h</a></h2>
<pre class="code c literal-block">
<span class="cm">/**
 * CLAP - CLever Audio Plugin (&lt;--- needs to find a marketing ok name)
 * ~~~~~~~~~~~~~~~~~~~~~~~~~~
 *
 * Copyright (c) 2014 Alexandre BIQUE &lt;bique.alexandre&#64;gmail.com&gt;
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the &quot;Software&quot;), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */</span>

<span class="cp">#ifndef CLAP_H
# define CLAP_H
</span>
<span class="cp"># ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp"># endif
</span>
<span class="cp"># include &lt;stdbool.h&gt;
# include &lt;stdint.h&gt;
</span>
<span class="cp"># define CLAP_VERSION_MAKE(Major, Minor, Revision) \
  ((((Major) &amp; 0xff) &lt;&lt; 16) | (((Minor) &amp; 0xff) &lt;&lt; 8) | ((Revision) &amp; 0xff))
# define CLAP_VERSION CLAP_VERSION_MAKE(1, 0, 0)
# define CLAP_VERSION_MAJ(Version) (((Version) &gt;&gt; 16) &amp; 0xff)
# define CLAP_VERSION_MIN(Version) (((Version) &gt;&gt; 8) &amp; 0xff)
# define CLAP_VERSION_REV(Version) ((Version) &amp; 0xff)
</span>
<span class="c1">///////////////////////////
// FORWARD DELCLARATIONS //
///////////////////////////
</span>
<span class="k">struct</span> <span class="n">clap_plugin</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">clap_host</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">clap_string_size</span>
<span class="p">{</span>
  <span class="n">CLAP_ID_SIZE</span>         <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
  <span class="n">CLAP_NAME_SIZE</span>       <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
  <span class="n">CLAP_DESC_SIZE</span>       <span class="o">=</span> <span class="mi">256</span><span class="p">,</span>
  <span class="n">CLAP_DISPLAY_SIZE</span>    <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
  <span class="n">CLAP_TAGS_SIZE</span>       <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
  <span class="n">CLAP_URL_SIZE</span>        <span class="o">=</span> <span class="mi">256</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">clap_log_severity</span>
<span class="p">{</span>
  <span class="n">CLAP_LOG_DEBUG</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_LOG_INFO</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
  <span class="n">CLAP_LOG_WARNING</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
  <span class="n">CLAP_LOG_ERROR</span>   <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
  <span class="n">CLAP_LOG_FATAL</span>   <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">};</span>

<span class="c1">///////////
// PORTS //
///////////
</span>
<span class="k">enum</span> <span class="n">clap_port_type</span>
<span class="p">{</span>
  <span class="n">CLAP_PORT_MONO</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_PORT_STEREO</span>   <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
  <span class="n">CLAP_PORT_SURROUND</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">clap_port_role</span>
<span class="p">{</span>
  <span class="n">CLAP_PORT_INOUT</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_PORT_SIDECHAIN</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
  <span class="n">CLAP_PORT_FEEDBACK</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_port_info</span>
<span class="p">{</span>
  <span class="k">enum</span> <span class="n">clap_port_type</span>  <span class="n">type</span><span class="p">;</span>
  <span class="k">enum</span> <span class="n">clap_port_role</span>  <span class="n">role</span><span class="p">;</span>
  <span class="kt">char</span>                 <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">uint32_t</span>             <span class="n">stream_id</span><span class="p">;</span> <span class="c1">// used to connect feedback loops
</span>  <span class="kt">bool</span>                 <span class="n">is_repeatable</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_ports_config</span>
<span class="p">{</span>
  <span class="kt">char</span>     <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">uint32_t</span> <span class="n">inputs_count</span><span class="p">;</span>
  <span class="kt">uint32_t</span> <span class="n">outputs_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">////////////////
// PARAMETERS //
////////////////
</span>
<span class="k">enum</span> <span class="n">clap_param_type</span>
<span class="p">{</span>
  <span class="n">CLAP_PARAM_GROUP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// no value for this one
</span>  <span class="n">CLAP_PARAM_BOOL</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// uses value.b
</span>  <span class="n">CLAP_PARAM_FLOAT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">// uses value.f
</span>  <span class="n">CLAP_PARAM_INT</span>   <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">// uses value.i
</span>  <span class="n">CLAP_PARAM_ENUM</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="c1">// uses value.i
</span><span class="p">};</span>

<span class="k">enum</span> <span class="n">clap_param_scale</span>
<span class="p">{</span>
  <span class="n">CLAP_PARAM_LINEAR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_PARAM_LOG</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">clap_param_value</span>
<span class="p">{</span>
  <span class="kt">bool</span>    <span class="n">b</span><span class="p">;</span>
  <span class="kt">float</span>   <span class="n">f</span><span class="p">;</span>
  <span class="kt">int32_t</span> <span class="n">i</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_param</span>
<span class="p">{</span>
  <span class="cm">/* tree fields */</span>
  <span class="kt">uint32_t</span> <span class="n">index</span><span class="p">;</span>  <span class="c1">// parameter's index
</span>  <span class="kt">uint32_t</span> <span class="n">parent</span><span class="p">;</span> <span class="c1">// parent's index, -1 for no parent
</span>
  <span class="cm">/* param info */</span>
  <span class="k">enum</span> <span class="n">clap_param_type</span>    <span class="n">type</span><span class="p">;</span>
  <span class="kt">char</span>                    <span class="n">id</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>   <span class="c1">// a string which identify the param
</span>  <span class="kt">char</span>                    <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span> <span class="c1">// the display name
</span>  <span class="kt">char</span>                    <span class="n">desc</span><span class="p">[</span><span class="n">CLAP_DESC_SIZE</span><span class="p">];</span>
  <span class="kt">bool</span>                    <span class="n">is_per_note</span><span class="p">;</span>
  <span class="kt">char</span>                    <span class="n">display_text</span><span class="p">[</span><span class="n">CLAP_DISPLAY_SIZE</span><span class="p">];</span> <span class="c1">// the text used to display the value
</span>  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">value</span><span class="p">;</span>
  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">min</span><span class="p">;</span>
  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">max</span><span class="p">;</span>
  <span class="k">enum</span> <span class="n">clap_param_scale</span>   <span class="n">scale</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">/////////////
// PRESETS //
/////////////
</span>
<span class="k">struct</span> <span class="n">clap_preset</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">id</span><span class="p">;</span>                     <span class="c1">// preset id
</span>  <span class="kt">char</span>     <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>   <span class="c1">// display name
</span>  <span class="kt">char</span>     <span class="n">desc</span><span class="p">[</span><span class="n">CLAP_DESC_SIZE</span><span class="p">];</span>   <span class="c1">// desc and how to use it
</span>  <span class="kt">char</span>     <span class="n">author</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span>     <span class="n">tags</span><span class="p">[</span><span class="n">CLAP_TAGS_SIZE</span><span class="p">];</span>   <span class="c1">// &quot;tag1;tag2;tag3;...&quot;
</span><span class="p">};</span>

<span class="c1">////////////
// EVENTS //
////////////
</span>
<span class="k">enum</span> <span class="n">clap_event_type</span>
<span class="p">{</span>
  <span class="n">CLAP_EVENT_NOTE_ON</span>         <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// note attribute
</span>  <span class="n">CLAP_EVENT_NOTE_MODULATION</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// note attribute
</span>  <span class="n">CLAP_EVENT_NOTE_OFF</span>        <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">// note attribute
</span>
  <span class="n">CLAP_EVENT_PARAM_SET</span>  <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>    <span class="c1">// param attribute
</span>  <span class="n">CLAP_EVENT_PARAM_RAMP</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>    <span class="c1">// param attribute
</span>  <span class="n">CLAP_EVENT_PITCH_SET</span>  <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>    <span class="c1">// pitch attribute
</span>  <span class="n">CLAP_EVENT_PRESET_SET</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>    <span class="c1">// preset attribute
</span>
  <span class="n">CLAP_EVENT_MIDI</span>    <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>       <span class="c1">// midi attribute
</span>  <span class="n">CLAP_EVENT_CONTROL</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>       <span class="c1">// control attribute
</span>
  <span class="n">CLAP_EVENT_GUI_OPENED</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>    <span class="c1">// plugin to host, no attribute
</span>  <span class="n">CLAP_EVENT_GUI_CLOSED</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>   <span class="c1">// plugin to host, no attribute
</span>
  <span class="n">CLAP_EVENT_NEW_PRESETS</span>       <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="c1">// plugin to host, no attribute
</span>  <span class="n">CLAP_EVENT_NEW_PORTS_CONFIGS</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="c1">// plugin to host, no attribute
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_note</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">division</span><span class="p">;</span> <span class="c1">// 12 for a standard octave
</span>  <span class="kt">uint32_t</span> <span class="n">note</span><span class="p">;</span>     <span class="c1">// starts from 0
</span>  <span class="kt">float</span>    <span class="n">velocity</span><span class="p">;</span> <span class="c1">// 0 .. 1.0f
</span>
  <span class="k">struct</span> <span class="n">clap_event</span> <span class="o">*</span><span class="n">events</span><span class="p">;</span> <span class="c1">// events specific to this note
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_param</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span>                <span class="n">index</span><span class="p">;</span>
  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">value</span><span class="p">;</span>
  <span class="kt">float</span>                   <span class="n">increment</span><span class="p">;</span>        <span class="c1">// for param ramp
</span>  <span class="kt">char</span>                    <span class="n">display_text</span><span class="p">[</span><span class="n">CLAP_DISPLAY_SIZE</span><span class="p">];</span> <span class="c1">// use this for display if not NULL.
</span>  <span class="kt">bool</span>                    <span class="n">is_recordable</span><span class="p">;</span>    <span class="c1">// used to tell the host if this event
</span>                                            <span class="c1">// can be recorded
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_control</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">index</span><span class="p">;</span>
  <span class="kt">float</span>    <span class="n">value</span><span class="p">;</span> <span class="c1">// 0 .. 1.0f
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_pitch</span>
<span class="p">{</span>
  <span class="kt">float</span> <span class="n">freq_hz</span><span class="p">;</span> <span class="c1">// usually 440Hz
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_preset</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">id</span><span class="p">;</span> <span class="c1">// the preset id
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_midi</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span>  <span class="n">size</span><span class="p">;</span>
  <span class="kt">uint8_t</span>  <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event</span>
<span class="p">{</span>
  <span class="k">struct</span> <span class="n">clap_event</span>    <span class="o">*</span><span class="n">next</span><span class="p">;</span> <span class="c1">// linked list, NULL on end
</span>  <span class="k">enum</span> <span class="n">clap_event_type</span>  <span class="n">type</span><span class="p">;</span>
  <span class="kt">uint64_t</span>              <span class="n">steady_time</span><span class="p">;</span> <span class="c1">// steady_time of the event, see host-&gt;steady_time(host)
</span>
  <span class="k">union</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">clap_event_note</span>    <span class="n">note</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_param</span>   <span class="n">param</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_pitch</span>   <span class="n">pitch</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_preset</span>  <span class="n">preset</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_midi</span>    <span class="n">midi</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_control</span> <span class="n">control</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="c1">/////////////
// PROCESS //
/////////////
</span>
<span class="k">struct</span> <span class="n">clap_process</span>
<span class="p">{</span>
  <span class="cm">/* host custom ptr */</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">host_data</span><span class="p">;</span>

  <span class="cm">/* audio buffers */</span>
  <span class="kt">float</span>    <span class="o">**</span><span class="n">input</span><span class="p">;</span>
  <span class="kt">float</span>    <span class="o">**</span><span class="n">output</span><span class="p">;</span>
  <span class="kt">uint32_t</span>   <span class="n">nb_samples</span><span class="p">;</span>

  <span class="cm">/* feedback loops */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">feedback</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_process</span> <span class="o">*</span><span class="n">process</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">stream_id</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">nb_samples</span><span class="p">);</span>
  <span class="kt">uint32_t</span> <span class="n">feedback_chunk_size</span><span class="p">;</span>

  <span class="cm">/* process info */</span>
  <span class="kt">bool</span>     <span class="n">is_offline</span><span class="p">;</span>
  <span class="kt">uint32_t</span> <span class="n">tempo</span><span class="p">;</span>       <span class="c1">// the tempo in samples
</span>  <span class="kt">uint64_t</span> <span class="n">song_time</span><span class="p">;</span>   <span class="c1">// the song time in samples
</span>  <span class="kt">uint64_t</span> <span class="n">steady_time</span><span class="p">;</span> <span class="c1">// the steady time in samples
</span>
  <span class="cm">/* events */</span>
  <span class="k">struct</span> <span class="n">clap_event</span> <span class="o">*</span><span class="n">events</span><span class="p">;</span>

  <span class="cm">/* output values */</span>
  <span class="kt">bool</span> <span class="n">need_processing</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">//////////
// HOST //
//////////
</span>
<span class="k">struct</span> <span class="n">clap_host</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">clap_version</span><span class="p">;</span> <span class="c1">// initialized to CLAP_VERSION
</span>
  <span class="cm">/* host info */</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">manufacturer</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">version</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>

  <span class="cm">/* for events generated by the plugin. */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">events</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span>   <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                 <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                 <span class="k">struct</span> <span class="n">clap_event</span>  <span class="o">*</span><span class="n">events</span><span class="p">);</span>

  <span class="cm">/* The time in samples, this clock is monotonicaly increasing,
   * it means that each time you call this function, the return
   * value must be greater or equal to the previous one. */</span>
  <span class="kt">uint64_t</span> <span class="p">(</span><span class="o">*</span><span class="n">steady_time</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">);</span>

  <span class="cm">/* Log a message through the host. */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">log</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span>       <span class="o">*</span><span class="n">host</span><span class="p">,</span>
              <span class="k">enum</span> <span class="n">clap_log_severity</span>  <span class="n">severity</span><span class="p">,</span>
              <span class="k">const</span> <span class="kt">char</span>             <span class="o">*</span><span class="n">msg</span><span class="p">);</span>

  <span class="cm">/* future features */</span>
  <span class="kt">void</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">extension</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extention_id</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">////////////
// PLUGIN //
////////////
</span>
<span class="c1">// bitfield
</span><span class="k">enum</span> <span class="n">clap_plugin_type</span>
<span class="p">{</span>
  <span class="n">CLAP_PLUGIN_INSTRUMENT</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">),</span>
  <span class="n">CLAP_PLUGIN_EFFECT</span>       <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">),</span>
  <span class="n">CLAP_PLUGIN_EVENT_EFFECT</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">),</span> <span class="c1">// can be seen as midi effect
</span>  <span class="n">CLAP_PLUGIN_ANALYZER</span>     <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_plugin</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">clap_version</span><span class="p">;</span> <span class="c1">// initialized to CALP_VERSION
</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">host_data</span><span class="p">;</span>   <span class="c1">// reserved pointer for the host
</span>  <span class="kt">void</span> <span class="o">*</span><span class="n">plugin_data</span><span class="p">;</span> <span class="c1">// reserved pointer for the plugin
</span>
  <span class="cm">/* free plugin's resources */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">destroy</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

  <span class="cm">/* plugin info */</span>
  <span class="kt">char</span> <span class="n">id</span><span class="p">[</span><span class="n">CLAP_ID_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">description</span><span class="p">[</span><span class="n">CLAP_DESC_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">version</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">manufacturer</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">url</span><span class="p">[</span><span class="n">CLAP_URL_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">support</span><span class="p">[</span><span class="n">CLAP_URL_SIZE</span><span class="p">];</span>  <span class="c1">// a link to the support
</span>  <span class="kt">char</span> <span class="n">license</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">categories</span><span class="p">[</span><span class="n">CLAP_TAGS_SIZE</span><span class="p">];</span> <span class="c1">// fm;analogue;delay;...
</span>
  <span class="kt">uint32_t</span> <span class="n">type</span><span class="p">;</span> <span class="c1">// clap_plugin_type bitfield
</span>  <span class="kt">uint32_t</span> <span class="n">chunk_size</span><span class="p">;</span>

  <span class="kt">bool</span> <span class="n">has_gui</span><span class="p">;</span>
  <span class="kt">bool</span> <span class="n">supports_tuning</span><span class="p">;</span>
  <span class="kt">bool</span> <span class="n">supports_microtones</span><span class="p">;</span>

  <span class="kt">uint32_t</span> <span class="n">latency</span><span class="p">;</span> <span class="c1">// latency in samples
</span>
  <span class="cm">/* Audio ports.
   * The port configuration has to be done while the plugin is deactivated. */</span>
  <span class="kt">uint32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_ports_configs_count</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_ports_config</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>       <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                           <span class="kt">uint32_t</span>                  <span class="n">config_index</span><span class="p">,</span>
                           <span class="k">struct</span> <span class="n">clap_ports_config</span> <span class="o">*</span><span class="n">config</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_port_info</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>    <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                        <span class="kt">uint32_t</span>               <span class="n">config_index</span><span class="p">,</span>
                        <span class="kt">uint32_t</span>               <span class="n">port_index</span><span class="p">,</span>
                        <span class="k">struct</span> <span class="n">clap_port_info</span> <span class="o">*</span><span class="n">port</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">set_ports_config</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                           <span class="kt">uint32_t</span>            <span class="n">config_index</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">set_port_repeat</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>  <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                          <span class="kt">uint32_t</span>             <span class="n">port_index</span><span class="p">,</span>
                          <span class="kt">uint32_t</span>             <span class="n">count</span><span class="p">);</span>

  <span class="cm">/* Returns a newly allocated parameters tree. The caller has to free it. */</span>
  <span class="kt">uint32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_params_count</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_param</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                    <span class="kt">uint32_t</span>            <span class="n">index</span><span class="p">,</span>
                    <span class="k">struct</span> <span class="n">clap_param</span>  <span class="o">*</span><span class="n">param</span><span class="p">);</span>

  <span class="cm">/* Returns a newly allocated preset list. The caller has to free it. */</span>
  <span class="kt">uint32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_presets_count</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_preset</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                     <span class="kt">uint32_t</span>            <span class="n">index</span><span class="p">,</span>
                     <span class="k">struct</span> <span class="n">clap_preset</span> <span class="o">*</span><span class="n">preset</span><span class="p">);</span>

  <span class="cm">/* activation */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">activate</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">deactivate</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

  <span class="cm">/* work */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">process</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">struct</span> <span class="n">clap_process</span> <span class="o">*</span><span class="n">process</span><span class="p">);</span>

  <span class="cm">/* gui */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">open_gui</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">close_gui</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

  <span class="cm">/* The plugin has to allocate and save its state into *buffer.
   * The plugin is also responsible to free the buffer on the
   * next call to save() or when the plugin is destroyed. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">save</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">size_t</span> <span class="o">*</span><span class="n">size</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">restore</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>

  <span class="cm">/* future features */</span>
  <span class="kt">void</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">extension</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* typedef for dlsym() cast */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">clap_create_f</span><span class="p">)(</span><span class="kt">uint32_t</span>          <span class="n">plugin_index</span><span class="p">,</span>
                                             <span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                                             <span class="kt">uint32_t</span>          <span class="n">sample_rate</span><span class="p">,</span>
                                             <span class="kt">uint32_t</span>         <span class="o">*</span><span class="n">plugins_count</span><span class="p">);</span>

<span class="cm">/* Plugin entry point. If plugins_count is not null, then clap_create has
 * to store the number of plugins available in *plugins_count.
 * If clap_create failed to create a plugin, it returns NULL.
 * The return value has to be freed by calling plugin-&gt;destroy(plugin). */</span>
<span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span>
<span class="nf">clap_create</span><span class="p">(</span><span class="kt">uint32_t</span>          <span class="n">plugin_index</span><span class="p">,</span>
            <span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
            <span class="kt">uint32_t</span>          <span class="n">sample_rate</span><span class="p">,</span>
            <span class="kt">uint32_t</span>         <span class="o">*</span><span class="n">plugins_count</span><span class="p">);</span>

<span class="cp"># ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp"># endif
</span>
<span class="cp">#endif </span><span class="cm">/* !CLAP_H */</span>
</pre>
</div>
<div class="section" id="clap-embed-h">
<h2><a class="toc-backref" href="#id52">clap-embed.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EMBED_H
# define CLAP_EMBED_H
</span>
<span class="cp"># include &quot;clap.h&quot;
</span>
<span class="cp"># define CLAP_EMBED &quot;clap/embed&quot;
</span>
<span class="k">struct</span> <span class="n">clap_host_embed</span>
<span class="p">{</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">resize</span><span class="p">)(</span><span class="kt">uint32_t</span> <span class="n">width</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">height</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EMBED_H */</span><span class="cp">
</span>
</pre>
</div>
<div class="section" id="clap-embed-win32-h">
<h2><a class="toc-backref" href="#id53">clap-embed-win32.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EMBED_WIN32_H
# define CLAP_EMBED_WIN32_H
</span>
<span class="cp"># include &lt;windows.h&gt;
</span>
<span class="cp"># include &quot;clap.h&quot;
# include &quot;clap-embed.h&quot;
</span>
<span class="cp"># define CLAP_EMBED_WIN32 &quot;clap/embed/win32&quot;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_embed_win32</span>
<span class="p">{</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_size</span><span class="p">)(</span><span class="kt">uint32_t</span> <span class="o">*</span><span class="n">width</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">height</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">embed</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="n">HWND</span> <span class="n">window</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">disembed</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EMBED_WIN32_H */</span><span class="cp">
</span>
</pre>
</div>
<div class="section" id="clap-embed-xlib-h">
<h2><a class="toc-backref" href="#id54">clap-embed-xlib.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EMBED_XLIB_H
# define CLAP_EMBED_XLIB_H
</span>
<span class="cp"># include &lt;X11/Xlib.h&gt;
</span>
<span class="cp"># include &quot;clap.h&quot;
# include &quot;clap-embed.h&quot;
</span>
<span class="cp"># define CLAP_EMBED_XLIB &quot;clap/embed/xlib&quot;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_embed_xlib</span>
<span class="p">{</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_size</span><span class="p">)(</span><span class="kt">uint32_t</span> <span class="o">*</span><span class="n">width</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">height</span><span class="p">);</span>

  <span class="cm">/* the display_name can be retrieved from your own
   * display-&gt;display_name. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">embed</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                <span class="n">Window</span>              <span class="n">window</span><span class="p">,</span>
                <span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="n">display_name</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">disembed</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EMBED_XLIB_H */</span><span class="cp">
</span>
</pre>
</div>
</div>
</div>
</body>
</html>
