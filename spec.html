<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>CLAP (CLever Audio Plugin)</title>
<style type="text/css">

.document {
    width: 755px;
}

.title {
    text-align: center;
}

.subtitle {
    text-align: center;
}

.reference, .toc-backref {
    text-decoration: none;
    color: #942;
}

.reference:hover, .toc-backref:hover {
    color: #294;
}

tt.docutils {
    color: #237;
    font-size: 100%;
}

</style>
<style type="text/css">

.code .hll { background-color: #49483e }
.code  { background: #272822; color: #f8f8f2 }
.code .c { color: #75715e } /* Comment */
.code .err { color: #960050; background-color: #1e0010 } /* Error */
.code .k { color: #66d9ef } /* Keyword */
.code .l { color: #ae81ff } /* Literal */
.code .n { color: #f8f8f2 } /* Name */
.code .o { color: #f92672 } /* Operator */
.code .p { color: #f8f8f2 } /* Punctuation */
.code .cm { color: #A56E27 } /* Comment.Multiline */
.code .cp { color: #B5A869 } /* Comment.Preproc */
.code .c1 { color: #A56E27 } /* Comment.Single */
.code .cs { color: #A56E27 } /* Comment.Special */
.code .ge { font-style: italic } /* Generic.Emph */
.code .gs { font-weight: bold } /* Generic.Strong */
.code .kc { color: #66d9ef } /* Keyword.Constant */
.code .kd { color: #66d9ef } /* Keyword.Declaration */
.code .kn { color: #f92672 } /* Keyword.Namespace */
.code .kp { color: #66d9ef } /* Keyword.Pseudo */
.code .kr { color: #66d9ef } /* Keyword.Reserved */
.code .kt { color: #66d9ef } /* Keyword.Type */
.code .ld { color: #e6db74 } /* Literal.Date */
.code .m { color: #ae81ff } /* Literal.Number */
.code .s { color: #e6db74 } /* Literal.String */
.code .na { color: #a6e22e } /* Name.Attribute */
.code .nb { color: #f8f8f2 } /* Name.Builtin */
.code .nc { color: #a6e22e } /* Name.Class */
.code .no { color: #66d9ef } /* Name.Constant */
.code .nd { color: #a6e22e } /* Name.Decorator */
.code .ni { color: #f8f8f2 } /* Name.Entity */
.code .ne { color: #a6e22e } /* Name.Exception */
.code .nf { color: #a6e22e } /* Name.Function */
.code .nl { color: #f8f8f2 } /* Name.Label */
.code .nn { color: #f8f8f2 } /* Name.Namespace */
.code .nx { color: #a6e22e } /* Name.Other */
.code .py { color: #f8f8f2 } /* Name.Property */
.code .nt { color: #f92672 } /* Name.Tag */
.code .nv { color: #f8f8f2 } /* Name.Variable */
.code .ow { color: #f92672 } /* Operator.Word */
.code .w { color: #f8f8f2 } /* Text.Whitespace */
.code .mf { color: #ae81ff } /* Literal.Number.Float */
.code .mh { color: #ae81ff } /* Literal.Number.Hex */
.code .mi { color: #ae81ff } /* Literal.Number.Integer */
.code .mo { color: #ae81ff } /* Literal.Number.Oct */
.code .sb { color: #e6db74 } /* Literal.String.Backtick */
.code .sc { color: #e6db74 } /* Literal.String.Char */
.code .sd { color: #e6db74 } /* Literal.String.Doc */
.code .s2 { color: #e6db74 } /* Literal.String.Double */
.code .se { color: #ae81ff } /* Literal.String.Escape */
.code .sh { color: #e6db74 } /* Literal.String.Heredoc */
.code .si { color: #e6db74 } /* Literal.String.Interpol */
.code .sx { color: #e6db74 } /* Literal.String.Other */
.code .sr { color: #e6db74 } /* Literal.String.Regex */
.code .s1 { color: #e6db74 } /* Literal.String.Single */
.code .ss { color: #e6db74 } /* Literal.String.Symbol */
.code .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
.code .vc { color: #f8f8f2 } /* Name.Variable.Class */
.code .vg { color: #f8f8f2 } /* Name.Variable.Global */
.code .vi { color: #f8f8f2 } /* Name.Variable.Instance */
.code .il { color: #ae81ff } /* Literal.Number.Integer.Long */

</style>
</head>
<body>
<div class="document" id="clap-clever-audio-plugin">
<h1 class="title">CLAP (CLever Audio Plugin)</h1>
<h2 class="subtitle" id="a-free-audio-plugin-format">A free audio plugin format</h2>

<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#goals" id="id2">Goals</a><ul>
<li><a class="reference internal" href="#design-choice" id="id3">Design choice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification" id="id4">Specification</a><ul>
<li><a class="reference internal" href="#how-to-read-the-specification" id="id5">How to read the specification</a></li>
<li><a class="reference internal" href="#encoding" id="id6">Encoding</a></li>
<li><a class="reference internal" href="#plugins-location" id="id7">Plugins location</a><ul>
<li><a class="reference internal" href="#common" id="id8">Common</a></li>
<li><a class="reference internal" href="#linux" id="id9">Linux</a></li>
<li><a class="reference internal" href="#windows" id="id10">Windows</a></li>
<li><a class="reference internal" href="#mac" id="id11">Mac</a></li>
<li><a class="reference internal" href="#multi-architecture-conventions" id="id12">Multi-architecture conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#instantiate-a-plugin" id="id13">Instantiate a plugin</a><ul>
<li><a class="reference internal" href="#precautions" id="id14">Precautions</a></li>
<li><a class="reference internal" href="#release-a-plugin" id="id15">Release a plugin</a></li>
<li><a class="reference internal" href="#plugins-collection" id="id16">Plugins collection</a><ul>
<li><a class="reference internal" href="#sample-plugin-loader" id="id17">Sample plugin loader</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plugin-description" id="id18">Plugin description</a></li>
<li><a class="reference internal" href="#extension-system" id="id19">Extension system</a></li>
<li><a class="reference internal" href="#audio-ports-configuration" id="id20">Audio ports configuration</a><ul>
<li><a class="reference internal" href="#pin-layout" id="id21">Pin layout</a></li>
<li><a class="reference internal" href="#configurations" id="id22">Configurations</a></li>
<li><a class="reference internal" href="#getting-the-ports-configurations" id="id23">Getting the ports configurations</a></li>
<li><a class="reference internal" href="#selecting-a-configuration" id="id24">Selecting a configuration</a></li>
<li><a class="reference internal" href="#repeatable-channels" id="id25">Repeatable channels</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#activation" id="id26">Activation</a></li>
<li><a class="reference internal" href="#processing" id="id27">Processing</a><ul>
<li><a class="reference internal" href="#audio-buffers" id="id28">Audio buffers</a></li>
<li><a class="reference internal" href="#events" id="id29">Events</a><ul>
<li><a class="reference internal" href="#notes" id="id30">Notes</a></li>
<li><a class="reference internal" href="#parameters" id="id31">Parameters</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id1" id="id32">Parameters</a><ul>
<li><a class="reference internal" href="#types" id="id33">Types</a></li>
<li><a class="reference internal" href="#scales" id="id34">Scales</a></li>
<li><a class="reference internal" href="#automation" id="id35">Automation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphical-user-interface" id="id36">Graphical User Interface</a><ul>
<li><a class="reference internal" href="#showing-the-gui" id="id37">Showing the GUI</a></li>
<li><a class="reference internal" href="#sending-events-to-the-host" id="id38">Sending events to the host</a></li>
<li><a class="reference internal" href="#hiding-the-gui" id="id39">Hiding the GUI</a></li>
<li><a class="reference internal" href="#embedding" id="id40">Embedding</a><ul>
<li><a class="reference internal" href="#example-on-windows" id="id41">Example on Windows</a></li>
<li><a class="reference internal" href="#resizing-the-window" id="id42">Resizing the window</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#presets" id="id43">Presets</a><ul>
<li><a class="reference internal" href="#list-plugin-s-presets" id="id44">List plugin's presets</a></li>
<li><a class="reference internal" href="#load-a-preset" id="id45">Load a preset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#save-and-restore-plugin-s-state" id="id46">Save and restore plugin's state</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id47">Examples</a><ul>
<li><a class="reference internal" href="#examples-clap-info-clap-info-c" id="id48">examples/clap-info/clap-info.c</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id49">References</a><ul>
<li><a class="reference internal" href="#clap-clap-h" id="id50">clap/clap.h</a></li>
<li><a class="reference internal" href="#clap-ext-ports-h" id="id51">clap/ext/ports.h</a></li>
<li><a class="reference internal" href="#clap-ext-gui-h" id="id52">clap/ext/gui.h</a></li>
<li><a class="reference internal" href="#clap-ext-state-h" id="id53">clap/ext/state.h</a></li>
<li><a class="reference internal" href="#clap-ext-params-h" id="id54">clap/ext/params.h</a></li>
<li><a class="reference internal" href="#clap-ext-presets-h" id="id55">clap/ext/presets.h</a></li>
<li><a class="reference internal" href="#clap-ext-embed-h" id="id56">clap/ext/embed.h</a></li>
<li><a class="reference internal" href="#clap-ext-embed-win32-h" id="id57">clap/ext/embed-win32.h</a></li>
<li><a class="reference internal" href="#clap-ext-embed-xlib-h" id="id58">clap/ext/embed-xlib.h</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="goals">
<h1><a class="toc-backref" href="#id2">Goals</a></h1>
<ul class="simple">
<li>Make a free digital instrument and effect plugin format</li>
<li>Be easy to understand and implement</li>
<li>Bring new features missed in VST 2.4</li>
<li>Designed to work on any operating system and processor architecture</li>
<li>Be event oriented</li>
<li>Be extensible</li>
<li>Be easy to bridge</li>
<li>Support dynamic configuration: let a modular plugin dynamically
add new parameters, new outputs/inputs, etc...</li>
</ul>
<div class="section" id="design-choice">
<h2><a class="toc-backref" href="#id3">Design choice</a></h2>
<ul class="simple">
<li>Use the C language for the interface.</li>
<li>The host interface must be thread-safe.</li>
<li>The plugin interface is not thread-safe.</li>
</ul>
</div>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id4">Specification</a></h1>
<div class="section" id="how-to-read-the-specification">
<h2><a class="toc-backref" href="#id5">How to read the specification</a></h2>
<p>The specification should be read along the reference headers.
<a class="reference external" href="https://free-audio.github.io/clap/">https://free-audio.github.io/clap/</a> gives a convinient view for that.</p>
</div>
<div class="section" id="encoding">
<h2><a class="toc-backref" href="#id6">Encoding</a></h2>
<p>All the strings exchanged through the CLAP interface must be encoded in UTF-8
and must be valid.</p>
</div>
<div class="section" id="plugins-location">
<h2><a class="toc-backref" href="#id7">Plugins location</a></h2>
<div class="section" id="common">
<h3><a class="toc-backref" href="#id8">Common</a></h3>
<ul class="simple">
<li>Directories should be scanned recursively.</li>
</ul>
</div>
<div class="section" id="linux">
<h3><a class="toc-backref" href="#id9">Linux</a></h3>
<ul class="simple">
<li>Plugins distributed with packages should be installed to: <tt class="docutils literal">/usr/lib/clap/</tt></li>
<li>Plugins installed in the user's home should be installed to: <tt class="docutils literal"><span class="pre">${HOME}/.clap/</span></tt></li>
</ul>
</div>
<div class="section" id="windows">
<h3><a class="toc-backref" href="#id10">Windows</a></h3>
<p>TBD</p>
</div>
<div class="section" id="mac">
<h3><a class="toc-backref" href="#id11">Mac</a></h3>
<p>TBD</p>
</div>
<div class="section" id="multi-architecture-conventions">
<h3><a class="toc-backref" href="#id12">Multi-architecture conventions</a></h3>
<p>Let's say that we have a plugin called <tt class="docutils literal">DigitalDragon</tt>. If we distribute
it for multiple architecture, then the host should be able to identify which
version is suited for the current architecture by reading its name.</p>
<p>For example:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Archtecture</th>
<th class="head">Filename</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>x86</td>
<td>DigitalDragon.x86.so</td>
</tr>
<tr><td>x86_64</td>
<td>DigitalDragon.x86_64.so</td>
</tr>
<tr><td>alpha</td>
<td>DigitalDragon.alpha.so</td>
</tr>
<tr><td>arm</td>
<td>DigitalDragon.arm.so</td>
</tr>
<tr><td>sparc</td>
<td>DigitalDragon.sparc.so</td>
</tr>
<tr><td>hppa</td>
<td>DigitalDragon.hppa.so</td>
</tr>
<tr><td>ppc</td>
<td>DigitalDragon.ppc.so</td>
</tr>
<tr><td>ppc64</td>
<td>DigitalDragon.ppc64.so</td>
</tr>
</tbody>
</table>
<p>If the name does not contain an indicator, then the plugin should be
built for the native/current architecture.</p>
</div>
</div>
<div class="section" id="instantiate-a-plugin">
<h2><a class="toc-backref" href="#id13">Instantiate a plugin</a></h2>
<p>Plugin instantiation can be done in a few steps:</p>
<ul class="simple">
<li>load the plugin library with <tt class="docutils literal">dlopen</tt> or symilar functions</li>
<li>find the symbol <tt class="docutils literal">clap_create</tt></li>
<li>instantiate the plugin by calling <tt class="docutils literal">clap_create</tt></li>
</ul>
<div class="section" id="precautions">
<h3><a class="toc-backref" href="#id14">Precautions</a></h3>
<ul class="simple">
<li>The function <tt class="docutils literal">clap_create</tt> must be thread-safe.</li>
<li>It must not throw exceptions.</li>
<li>It can return <tt class="docutils literal">NULL</tt>.</li>
</ul>
</div>
<div class="section" id="release-a-plugin">
<h3><a class="toc-backref" href="#id15">Release a plugin</a></h3>
<p>To release a plugin, call <tt class="docutils literal"><span class="pre">plugin-&gt;destroy(plugin);</span></tt>.
It is required to deactivate the plugin prior to destroy it.</p>
</div>
<div class="section" id="plugins-collection">
<h3><a class="toc-backref" href="#id16">Plugins collection</a></h3>
<p>A single shared library can contains multiple clap plugins.
To list them, you have to call <tt class="docutils literal">clap_create</tt> with an index of 0.
<tt class="docutils literal">clap_create</tt> will store the number of plugins in the collection
into the parameter <tt class="docutils literal">*plugins_count</tt>. After that you can create any
of them by using an <tt class="docutils literal">index</tt> between <tt class="docutils literal">0</tt> and <tt class="docutils literal">*plugins_count</tt>.</p>
<p><tt class="docutils literal">clap_create</tt> returns <tt class="docutils literal">NULL</tt> if the plugin creation failed or if
<tt class="docutils literal">plugin_index &gt;= plugin_count</tt>.</p>
<div class="section" id="sample-plugin-loader">
<h4><a class="toc-backref" href="#id17">Sample plugin loader</a></h4>
<p>See <a class="reference internal" href="#examples-clap-info-clap-info-c">examples/clap-info/clap-info.c</a></p>
</div>
</div>
<div class="section" id="plugin-description">
<h3><a class="toc-backref" href="#id18">Plugin description</a></h3>
<p><tt class="docutils literal">struct clap_plugin</tt> only contains a interger <tt class="docutils literal">clap_version</tt> which
indicates which version of the clap interface has been used to build the plugin, and
a few methods. This attribute must be initialized by the plugin with
<tt class="docutils literal">CLAP_PLUGIN_VERSION</tt>.</p>
<p>Then to get plugin's attribute, you have to use <tt class="docutils literal"><span class="pre">plugin-&gt;get_attribute(plugin,</span> <span class="pre">...)</span></tt>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>CLAP_ATTR_ID</td>
<td>Unique identifier of the plugin. It should never change. It
should be the same on any plateform.</td>
</tr>
<tr><td>CLAP_ATTR_NAME</td>
<td>The name of the product.</td>
</tr>
<tr><td>CLAP_ATTR_DESCRIPTION</td>
<td>A brief description of the product.</td>
</tr>
<tr><td>CLAP_ATTR_MANUFACTURER</td>
<td>Which company made the plugin.</td>
</tr>
<tr><td>CLAP_ATTR_VERSION</td>
<td>A string describing the product version.</td>
</tr>
<tr><td>CLAP_ATTR_URL</td>
<td>An URL to the product homepage.</td>
</tr>
<tr><td>CLAP_ATTR_LICENSE</td>
<td>The plugin license type, Custom, GPLv3, MIT, ...</td>
</tr>
<tr><td>CLAP_ATTR_SUPPORT</td>
<td>A link to the support, it can be
<tt class="docutils literal">mailto:support&#64;company.com</tt> or
<tt class="docutils literal"><span class="pre">http://company.com/support</span></tt>.</td>
</tr>
<tr><td>CLAP_ATTR_CATEGORIES</td>
<td>A string containing a list of categories, joined with <tt class="docutils literal">;</tt>.
For example: <tt class="docutils literal">fm;analogue;delay</tt>.</td>
</tr>
<tr><td>CLAP_ATTR_TYPE</td>
<td>Bitfield describing what the plugin does. See
<tt class="docutils literal">enum clap_plugin_type</tt>.</td>
</tr>
<tr><td>CLAP_ATTR_CHUNK_SIZE</td>
<td>The process buffer must have a number of sample multiple of
<tt class="docutils literal">chunk_size</tt>.</td>
</tr>
<tr><td>CLAP_ATTR_LATENCY</td>
<td>The latency introduced by the plugin.</td>
</tr>
<tr><td>CLAP_ATTR_SUPPORTS_TUNING</td>
<td><tt class="docutils literal">1</tt> if the plugin supports tuning.</td>
</tr>
<tr><td>CLAP_ATTR_IS_REMOTE_PROCESSING</td>
<td><tt class="docutils literal">1</tt> if the plugin is doing remote processing. This can help
the DAW's task scheduling.</td>
</tr>
<tr><td>..._IN_PLACE_PROCESSING</td>
<td><tt class="docutils literal">1</tt> if the plugin supports in place processing.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="extension-system">
<h3><a class="toc-backref" href="#id19">Extension system</a></h3>
<p>To extend clap's functionnality, there is a pretty simple mechanism:</p>
<pre class="code c literal-block">
<span class="kt">void</span> <span class="o">*</span><span class="n">plug_ext</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plug</span><span class="p">,</span> <span class="s">&quot;company/ext-name&quot;</span><span class="p">);</span>
<span class="kt">void</span> <span class="o">*</span><span class="n">host_ext</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="s">&quot;company/ext-name&quot;</span><span class="p">);</span>
</pre>
<p>If the extension is not supported, the plugin should return <tt class="docutils literal">NULL</tt>.</p>
</div>
<div class="section" id="audio-ports-configuration">
<h3><a class="toc-backref" href="#id20">Audio ports configuration</a></h3>
<p>A plugin may have multiple audio ports, and so multiple audio ports
layout or configurations.</p>
<p>An audio port has a type: mono, stereo, surround and a role: main
input/output or sidechain. We might add a feedback role in the futur
if there is a need for it. Also, an instrument/effect can load and host
clap effects for its feedback loops.</p>
<div class="section" id="pin-layout">
<h4><a class="toc-backref" href="#id21">Pin layout</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="14%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">type</th>
<th class="head">pin</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>mono</td>
<td>0</td>
<td>mono</td>
</tr>
<tr><td rowspan="2">stereo</td>
<td>0</td>
<td>left</td>
</tr>
<tr><td>1</td>
<td>right</td>
</tr>
<tr><td rowspan="8">surround</td>
<td>0</td>
<td>front left</td>
</tr>
<tr><td>1</td>
<td>front right</td>
</tr>
<tr><td>2</td>
<td>center</td>
</tr>
<tr><td>3</td>
<td>low frequency</td>
</tr>
<tr><td>4</td>
<td>surround left</td>
</tr>
<tr><td>5</td>
<td>surround right</td>
</tr>
<tr><td>6</td>
<td>surround back left</td>
</tr>
<tr><td>7</td>
<td>surround back right</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configurations">
<h4><a class="toc-backref" href="#id22">Configurations</a></h4>
<p>After the call to <tt class="docutils literal">clap_create()</tt> the new plugin uses the default ports
configuration: 1 stereo input and 1 stereo output. So if you're fine with
it, there is nothing more to do.</p>
<p>If a plugins wants to offer more ports configuration to the host/user, it
has to use ports extension. See <a class="reference internal" href="#clap-ext-ports-h">clap/ext/ports.h</a>.</p>
<p>The host can select a ports configuration only if the plugin is in
the deactivated state.</p>
<p>Note that if the plugin does not support the default configuration
which is stereo input and stereo output, then it must return false
during the plugin activation (<tt class="docutils literal"><span class="pre">plugin-&gt;activate(plugin)</span></tt>).</p>
<p>Here is a configuration for a stereo sidechain compressor:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="15%" />
<col width="18%" />
<col width="31%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">in/out</th>
<th class="head">type</th>
<th class="head">role</th>
<th class="head">buffer</th>
<th class="head">desc</th>
</tr>
</thead>
<tbody valign="top">
<tr><td rowspan="2">input</td>
<td rowspan="2">stereo</td>
<td rowspan="2">inout</td>
<td>process-&gt;inputs[0]</td>
<td>left input</td>
</tr>
<tr><td>process-&gt;inputs[1]</td>
<td>right input</td>
</tr>
<tr><td rowspan="2">input</td>
<td rowspan="2">stereo</td>
<td rowspan="2">sidechain</td>
<td>process-&gt;inputs[2]</td>
<td>left sidechain</td>
</tr>
<tr><td>process-&gt;inputs[3]</td>
<td>right sidechain</td>
</tr>
<tr><td rowspan="2">output</td>
<td rowspan="2">stereo</td>
<td rowspan="2">inout</td>
<td>process-&gt;outputs[0]</td>
<td>left input</td>
</tr>
<tr><td>process-&gt;outputs[1]</td>
<td>right input</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="getting-the-ports-configurations">
<h4><a class="toc-backref" href="#id23">Getting the ports configurations</a></h4>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/ext/ports.h&gt;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_ports</span> <span class="o">*</span><span class="n">ports</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_PORTS</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ports</span><span class="p">)</span>
  <span class="k">return</span><span class="p">;</span> <span class="c1">// no ports extension
</span><span class="kt">uint32_t</span> <span class="n">count</span> <span class="o">=</span> <span class="n">ports</span><span class="o">-&gt;</span><span class="n">get_configs_count</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">struct</span> <span class="n">clap_ports_config</span> <span class="n">config</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ports</span><span class="o">-&gt;</span><span class="n">get_config</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">config</span><span class="p">))</span>
    <span class="k">continue</span><span class="p">;</span>
  <span class="c1">// ...
</span><span class="p">}</span>
</pre>
<p>It is possible to discover a plugin's port configurations by calling
<tt class="docutils literal"><span class="pre">ports-&gt;get_configs_count(plugin);</span></tt>. It returns the number of
configurations. Then for each configuration you have to call
<tt class="docutils literal"><span class="pre">ports-&gt;get_config(plugin,</span> config_index, &amp;config);</tt> which will
tell you the number of input and output ports. Then to get the port details,
you have to call
<tt class="docutils literal"><span class="pre">ports-&gt;get_info(plugin,</span> config_index, port_index, &amp;port);</tt>.</p>
</div>
<div class="section" id="selecting-a-configuration">
<h4><a class="toc-backref" href="#id24">Selecting a configuration</a></h4>
<p>Selecting an audio configuration has to be done when the plugin is deactivated.
It is done by calling <tt class="docutils literal"><span class="pre">plugin-&gt;set_port_config(plugin,</span> config_index)</tt>.
If the call returns false, then the plugin is in failed state.</p>
</div>
<div class="section" id="repeatable-channels">
<h4><a class="toc-backref" href="#id25">Repeatable channels</a></h4>
<p>Repeatable channels are a special case. A channel can be identified as
repeatable if <tt class="docutils literal"><span class="pre">channel-&gt;is_repeatable</span> == true</tt>.</p>
<p>A useful case is for an analyzer. Imagine a spectroscope, to which you want to
plug any number of inputs. Each of those inputs can be named and displayed in
the spectrograph, so it is a convinient way analyze many tracks in the same
spectroscope.</p>
<p>For the special case of repeatable side chain input, the host
has to tell the plugin how many times the port should be repeated.
To do that it has to call <tt class="docutils literal"><span class="pre">plugin-&gt;set_repeat(plugin,</span> port_index, count)</tt>.
If it returns <tt class="docutils literal">false</tt> then the plugin is in the same state as before
the call.</p>
<p>Only inputs can be repeatable.</p>
</div>
</div>
</div>
<div class="section" id="activation">
<h2><a class="toc-backref" href="#id26">Activation</a></h2>
<p>Before doing any processing, the plugin must be activated by calling
<tt class="docutils literal">bool succeed = <span class="pre">plugin-&gt;activate(plugin);</span></tt>.</p>
<p>If <tt class="docutils literal">succeed == true</tt> then the activation succeed. If the activation failed,
then the plugin is unusable.</p>
<p>The host must not call <tt class="docutils literal">activate()</tt> if the plugin is already activated.
Yet the plugin should handle correctly double calls to <tt class="docutils literal">activate()</tt>.</p>
<p>The plugin activation could be nothing, or could be a task which takes time,
like connecting a remote server or device.
So the host should not activate plugins in the audio processing thread.</p>
<p>To deactivate the plugin, just call <tt class="docutils literal"><span class="pre">plugin-&gt;deactivate(plugin)</span></tt>. Like
<tt class="docutils literal">activate()</tt>, <tt class="docutils literal">deactivate()</tt> should not be called from the audio processing
thread as it may take time.</p>
<p><tt class="docutils literal">deactivate()</tt> must not be called if the plugin is not activated.</p>
<p>The host must de-activate the plugin before destroying it.</p>
</div>
<div class="section" id="processing">
<h2><a class="toc-backref" href="#id27">Processing</a></h2>
<p>The processing is done in one call: <tt class="docutils literal"><span class="pre">plugin-&gt;process(plugin,</span> process);</tt>.
The data structure process regroup everything needed by the plugin:</p>
<ul class="simple">
<li>audio buffers (in, out)</li>
<li>events (in)</li>
<li>some time info</li>
</ul>
<p>Once the processing is finished, the methods returns a process status
which can be:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Status</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">CLAP_PROCESS_ERROR</tt></td>
<td>An error happened, and the buffers should be discarded</td>
</tr>
<tr><td><tt class="docutils literal">CLAP_PROCESS_CONTINUE</tt></td>
<td>Succeed, the plugins wants to process the next block</td>
</tr>
<tr><td><tt class="docutils literal">CLAP_PROCESS_STOP</tt></td>
<td>Succeed, every voices terminated, wake me up on a new event</td>
</tr>
</tbody>
</table>
<p>If <tt class="docutils literal">process()</tt> returns <tt class="docutils literal">CLAP_PROCESS_STOP</tt> and some parameters were ramping
(see <tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt> event), then the host must send a <tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt>
or  <tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt> for those parameters at the next call to process.</p>
<div class="section" id="audio-buffers">
<h3><a class="toc-backref" href="#id28">Audio buffers</a></h3>
<ul class="simple">
<li>The audio buffers are allocated by the host. They must be aligned by the
maximum requirement of the vector instructions currently available.</li>
<li>In-place processing is not supported by default, yet the host can use it
if the plugin has the attribute <tt class="docutils literal">CLAP_ATTR_SUPPORTS_IN_PLACE_PROCESSING</tt>.</li>
<li>The number of samples must be a multiple of the plugin chunk_size.</li>
<li>See <a class="reference internal" href="#pin-layout">Pin layout</a>.</li>
<li>See <a class="reference internal" href="#plugin-description">Plugin description</a></li>
</ul>
</div>
<div class="section" id="events">
<h3><a class="toc-backref" href="#id29">Events</a></h3>
<ul class="simple">
<li>Event's time must be within the process duration:
<tt class="docutils literal"><span class="pre">[process-&gt;steady_time</span> .. <span class="pre">process-&gt;steady_time</span> + <span class="pre">process-&gt;nb_sambles]</span></tt>.</li>
<li>The plugin must not modify the events.</li>
</ul>
<div class="section" id="notes">
<h4><a class="toc-backref" href="#id30">Notes</a></h4>
<p>A note is identified by a key. A key correspond to the keys of a midi keyboard (128 keys).
If the plugin supports tunning then it should use the <tt class="docutils literal"><span class="pre">event-&gt;note.pitch</span></tt> as
the note frequency.</p>
<p>The note A4 correspond to the key 57 and the frequency 440Hz.
The note A3 correspond to the key 45 and the frequency 220Hz.</p>
<p>If the plugin supports tunning, then the host could play the note A4 by sending
a NOTE_ON event with key = 0 and pitch = 440. Then to stop the the host can
send a NOTE_OFF event with the same key, so 0 in our case or it can send
a NOTE_ON event on the same key (0), which would terminate the note on the key
0 and start a new note on the key 0 with the given pitch.</p>
<p>Here is a scenario where the plugin does not support tunning:</p>
<ul class="simple">
<li>NOTE_ON, key = 60, pitch = 42; starts the note C4, with the pitch 493.88Hz</li>
<li>NOTE_OFF, key = 0, pitch = 493.88; ignored because no note has been started on key 0</li>
<li>NOTE_ON, key = 60, pitch = 54; retrigers the note C4, with the pitch 493.88Hz</li>
<li>NOTE_OFF, key = 60, pitch = 62; stops the note C4</li>
</ul>
<p>Here is a scenario where the plugin does support tunning:</p>
<ul class="simple">
<li>NOTE_ON, key = 60, pitch = 42; starts a note, with the pitch 42Hz</li>
<li>NOTE_OFF, key = 0, pitch = 493.88; ignored because no note has been started on key 0</li>
<li>NOTE_ON, key = 60, pitch = 54; stops the note with the pitch 42Hz and starts
a note with a pitch of 54Hz</li>
<li>NOTE_OFF, key = 60, pitch = 62; stops the note with a pitch of 54Hz</li>
</ul>
<p>The plugin is encouraged to use an array with 128 pointers to voice, so
it can quickly figure which voice is playing the given key.</p>
</div>
<div class="section" id="parameters">
<h4><a class="toc-backref" href="#id31">Parameters</a></h4>
<p>Parameters can be automated by the host using <tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> or
<tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt>.</p>
<p>When using <tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt>, the parameter is set to <tt class="docutils literal"><span class="pre">ev-&gt;param.value</span></tt>
and has to be incremented by <tt class="docutils literal"><span class="pre">event-&gt;param.increment</span></tt> for each samples, except
for the sample at <tt class="docutils literal"><span class="pre">ev-&gt;steady_time</span></tt>, until an event <tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> or
<tt class="docutils literal">CLAP_EVENT_PARAM_RAMP</tt> occur for this parameter.</p>
</div>
</div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id32">Parameters</a></h2>
<p>The host can get the plugin's parameters tree by using the params extension:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">params-&gt;count(plugin);</span></tt> to know the number of parameters</li>
<li><tt class="docutils literal"><span class="pre">params-&gt;get(plugin,</span> param_index, &amp;param);</tt> to get the parameter
value and description</li>
</ul>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/ext/params.h&gt;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_params</span> <span class="o">*</span><span class="n">params</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_PARAMS</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">params</span><span class="p">)</span>
  <span class="k">return</span><span class="p">;</span> <span class="c1">// no params extensions
</span><span class="kt">uint32_t</span> <span class="n">count</span> <span class="o">=</span> <span class="n">ports</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">struct</span> <span class="n">clap_param</span> <span class="n">param</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ports</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">param</span><span class="p">))</span>
    <span class="k">continue</span><span class="p">;</span>
  <span class="c1">// ...
</span><span class="p">}</span>
</pre>
<p>See <a class="reference internal" href="#clap-ext-params-h">clap/ext/params.h</a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">type</tt></td>
<td>The type of parameter. Must never change.</td>
</tr>
<tr><td><tt class="docutils literal">id</tt></td>
<td>What identifies the parameter. Must never change.
This field must be saved along automation.</td>
</tr>
<tr><td><tt class="docutils literal">name</tt></td>
<td>The name of the parameter. This can change.
Meant to be displayed.</td>
</tr>
<tr><td><tt class="docutils literal">desc</tt></td>
<td>The description of the parameter. This can change.
Meant to be displayed.</td>
</tr>
<tr><td><tt class="docutils literal">is_per_note</tt></td>
<td><tt class="docutils literal">true</tt> if the parameter can be automated per voice.</td>
</tr>
<tr><td><tt class="docutils literal">display_text</tt></td>
<td>How the value should be displayed. Only used for enum
types.</td>
</tr>
<tr><td><tt class="docutils literal">is_used</tt></td>
<td>True if the parameter is used by the current patch.</td>
</tr>
<tr><td><tt class="docutils literal">is_periodic</tt></td>
<td>Means that the parameter is periodic, so
<tt class="docutils literal">value = value % max</tt>.</td>
</tr>
<tr><td><tt class="docutils literal">value</tt></td>
<td>The current value of the parameter.</td>
</tr>
<tr><td><tt class="docutils literal">min</tt></td>
<td>The minimum value of the parameter.</td>
</tr>
<tr><td><tt class="docutils literal">max</tt></td>
<td>The maximum value of the parameter.</td>
</tr>
<tr><td><tt class="docutils literal">scale</tt></td>
<td>The scale to use when exposing the parameter to the user.</td>
</tr>
</tbody>
</table>
<div class="section" id="types">
<h3><a class="toc-backref" href="#id33">Types</a></h3>
<p>There are a few parameter types:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="22%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">type</th>
<th class="head">value attribute</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>group</td>
<td>none</td>
<td>not a value, but the only parameter which can have
child. It should be used to organize parameters in
the host GUI.</td>
</tr>
<tr><td>bool</td>
<td><tt class="docutils literal">value.b</tt></td>
<td>a boolean value, can be true or false</td>
</tr>
<tr><td>float</td>
<td><tt class="docutils literal">value.f</tt></td>
<td>a float value</td>
</tr>
<tr><td>int</td>
<td><tt class="docutils literal">value.i</tt></td>
<td>an integer value</td>
</tr>
<tr><td>enum</td>
<td><tt class="docutils literal">value.i</tt></td>
<td>an enumeration, it uses integer values, and the host
should rely on <tt class="docutils literal">display_text</tt> to show its value.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="scales">
<h3><a class="toc-backref" href="#id34">Scales</a></h3>
<p>The plugin can inform the host, which scale to use for the parameter's UI
(knob, slider, ...). <tt class="docutils literal"><span class="pre">clap_param-&gt;scale</span></tt> can be set to <tt class="docutils literal">CLAP_PARAM_LINEAR</tt>
or <tt class="docutils literal">CLAP_PARAM_LOG</tt>. A logarithmic scale is convinient for a frequency
parameter.</p>
</div>
<div class="section" id="automation">
<h3><a class="toc-backref" href="#id35">Automation</a></h3>
<p>When a parameter is modified by the GUI, the plugin should send a
<tt class="docutils literal">CLAP_EVENT_PARAM_SET</tt> event must be sent to the host, using
<tt class="docutils literal"><span class="pre">host-&gt;events(host,</span> plugin, events);</tt> so the host can record the automation.</p>
<p>When a parameter is modified by an other parameter (this is discouraged),
for example imagine you have a parameter modulating &quot;absolutely&quot; an other
one through an XY mapping.
The host should record the modulation source but not the modulation target.
To do that the plugin uses <tt class="docutils literal"><span class="pre">clap_event_param-&gt;is_recordable</span></tt>.</p>
</div>
</div>
<div class="section" id="graphical-user-interface">
<h2><a class="toc-backref" href="#id36">Graphical User Interface</a></h2>
<div class="section" id="showing-the-gui">
<h3><a class="toc-backref" href="#id37">Showing the GUI</a></h3>
<p>To show the plugin's GUI, you need to use the gui extension: <tt class="docutils literal"><span class="pre">gui-&gt;open(plugin)</span></tt>.
If the plugin succeed to show the GUI, it returns <tt class="docutils literal">true</tt>, <tt class="docutils literal">false</tt>
otherwise.</p>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/ext/gui.h&gt;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_gui</span> <span class="o">*</span><span class="n">gui</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_GUI</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">gui</span><span class="p">)</span>
  <span class="n">gui</span><span class="o">-&gt;</span><span class="n">open</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
</pre>
<p>See <a class="reference internal" href="#clap-ext-gui-h">clap/ext/gui.h</a>.</p>
</div>
<div class="section" id="sending-events-to-the-host">
<h3><a class="toc-backref" href="#id38">Sending events to the host</a></h3>
<p>The plugin can notify the host of parameter changes by sending events to:
<tt class="docutils literal"><span class="pre">host-&gt;events(host,</span> plugin, events);</tt>.</p>
<p>Events sent to the host should be stamped:</p>
<pre class="code c literal-block">
<span class="k">struct</span> <span class="n">clap_event</span> <span class="n">ev</span><span class="p">;</span>
<span class="c1">// ...
</span><span class="n">ev</span><span class="p">.</span><span class="n">steady_time</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span><span class="p">(</span><span class="n">host</span><span class="p">);</span>
<span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="hiding-the-gui">
<h3><a class="toc-backref" href="#id39">Hiding the GUI</a></h3>
<p>The plugin should hide the GUI after a call to <tt class="docutils literal"><span class="pre">gui-&gt;close(plugin)</span></tt>.
If the plugin window has been closed by the user, then the plugin should
send an event <tt class="docutils literal">CLAP_EVENT_GUI_CLOSED</tt> to the host.</p>
<pre class="code c literal-block">
<span class="k">struct</span> <span class="n">clap_event</span> <span class="n">ev</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">CLAP_EVENT_GUI_CLOSED</span><span class="p">;</span>
<span class="n">ev</span><span class="p">.</span><span class="n">sample_offset</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span><span class="p">(</span><span class="n">host</span><span class="p">);</span>
<span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ev</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="embedding">
<h3><a class="toc-backref" href="#id40">Embedding</a></h3>
<p>Some host are designed to embed plugin's window.
As embedding is not a requirement and is OS specific, it is then offered as
an extension.</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="35%" />
<col width="29%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">GUI</th>
<th class="head">header</th>
<th class="head">extension</th>
<th class="head">comment</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Generic</td>
<td><a class="reference internal" href="#clap-ext-embed-h">clap/ext/embed.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED</tt></td>
<td>For the host</td>
</tr>
<tr><td>Windows</td>
<td><a class="reference internal" href="#clap-ext-embed-win32-h">clap/ext/embed-win32.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED_WIN32</tt></td>
<td>For the plugin</td>
</tr>
<tr><td>X11</td>
<td><a class="reference internal" href="#clap-ext-embed-xlib-h">clap/ext/embed-xlib.h</a></td>
<td><tt class="docutils literal">CLAP_EMBED_XLIB</tt></td>
<td>For the plugin</td>
</tr>
</tbody>
</table>
<div class="section" id="example-on-windows">
<h4><a class="toc-backref" href="#id41">Example on Windows</a></h4>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/clap.h&gt;
#include &lt;clap/ext/gui.h&gt;
#include &lt;clap/ext/embed-win32.h&gt;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_embed_win32</span> <span class="o">*</span><span class="n">embed</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EMBED_WIN32</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">embed</span><span class="p">)</span>
  <span class="n">embed</span><span class="o">-&gt;</span><span class="n">embed</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">window</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">clap_plugin_gui</span> <span class="o">*</span><span class="n">gui</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_GUI</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">gui</span><span class="p">)</span>
  <span class="n">gui</span><span class="o">-&gt;</span><span class="n">open</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="resizing-the-window">
<h4><a class="toc-backref" href="#id42">Resizing the window</a></h4>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/clap.h&gt;
#include &lt;clap/ext/embed.h&gt;
</span>
<span class="c1">// plugin code
</span><span class="k">struct</span> <span class="n">clap_host_embed</span> <span class="o">*</span><span class="n">embed</span> <span class="o">=</span> <span class="n">host</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EMBED</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">embed</span> <span class="o">&amp;&amp;</span> <span class="n">embed</span><span class="o">-&gt;</span><span class="n">resize</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// resize succeed
</span><span class="p">}</span>
</pre>
</div>
</div>
</div>
<div class="section" id="presets">
<h2><a class="toc-backref" href="#id43">Presets</a></h2>
<div class="section" id="list-plugin-s-presets">
<h3><a class="toc-backref" href="#id44">List plugin's presets</a></h3>
<p>The host can browse the plugin's presets by using the preset extension:</p>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/clap.h&gt;
#include &lt;clap/ext/presets.h&gt;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_presets</span> <span class="o">*</span><span class="n">presets</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_PRESETS</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">clap_preset_iterator</span> <span class="o">*</span><span class="n">iter</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">clap_preset</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="n">presets</span> <span class="o">&amp;&amp;</span> <span class="n">presets</span><span class="o">-&gt;</span><span class="n">iter_begin</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iter</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">do</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">presets</span><span class="o">-&gt;</span><span class="n">iter_get</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">iter</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">preset</span><span class="p">))</span>
      <span class="k">break</span><span class="p">;</span>

    <span class="c1">// XXX: do your work with preset;
</span>  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">presets</span><span class="o">-&gt;</span><span class="n">iter_next</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">iter</span><span class="p">));</span>

  <span class="c1">// release the iterator
</span>  <span class="n">presets</span><span class="o">-&gt;</span><span class="n">iter_destroy</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">iter</span><span class="p">);</span>
<span class="p">}</span>
</pre>
<p>See <a class="reference internal" href="#clap-ext-presets-h">clap/ext/presets.h</a>.</p>
</div>
<div class="section" id="load-a-preset">
<h3><a class="toc-backref" href="#id45">Load a preset</a></h3>
<p>To load a preset, the host have to send an event <tt class="docutils literal">CLAP_EVENT_PRESET_SET</tt> to
the plugin.</p>
<p>When a preset is loaded from the plugin's GUI, the plugin must send a
<tt class="docutils literal">CLAP_EVENT_PRESET_SET</tt> to the host.</p>
</div>
</div>
<div class="section" id="save-and-restore-plugin-s-state">
<h2><a class="toc-backref" href="#id46">Save and restore plugin's state</a></h2>
<p>Saving the plugin's state is done by using the state extension:</p>
<pre class="code c literal-block">
<span class="cp">#include &lt;clap/clap.h&gt;
#include &lt;clap/ext/state.h&gt;
</span>
<span class="kt">void</span>   <span class="o">*</span><span class="n">buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="kt">size_t</span>  <span class="n">size</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">clap_plugin_state</span> <span class="o">*</span><span class="n">state</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">get_extension</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">CLAP_EXT_STATE</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">&amp;&amp;</span> <span class="n">state</span><span class="o">-&gt;</span><span class="n">save</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">size</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// save succeed
</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// save failed
</span><span class="p">}</span>
</pre>
<p>Restoring the plugin's state is done by:</p>
<pre class="code c literal-block">
<span class="n">state</span><span class="o">-&gt;</span><span class="n">restore</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
</pre>
<p>The state of the plugin should be independent of the machine: you can save a
plugin state on a little endian machine and send it through the network to a
big endian machine, it should load again successfully.</p>
<p>See <a class="reference internal" href="#clap-ext-state-h">clap/ext/state.h</a>.</p>
</div>
</div>
<div class="section" id="examples">
<h1><a class="toc-backref" href="#id47">Examples</a></h1>
<div class="section" id="examples-clap-info-clap-info-c">
<h2><a class="toc-backref" href="#id48">examples/clap-info/clap-info.c</a></h2>
<pre class="code c literal-block">
<span class="cp">#include &lt;stdio.h&gt;
#include &lt;dlfcn.h&gt;
</span>
<span class="cp">#include &lt;clap/clap.h&gt;
</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">host_events</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span>   <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                        <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                        <span class="k">struct</span> <span class="n">clap_event</span>  <span class="o">*</span><span class="n">events</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">uint64_t</span> <span class="nf">host_steady_time</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">host_extension</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extension_id</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">initialize_host</span><span class="p">(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">clap_version</span> <span class="o">=</span> <span class="n">CLAP_VERSION</span><span class="p">;</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">events</span>       <span class="o">=</span> <span class="n">host_events</span><span class="p">;</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">steady_time</span>  <span class="o">=</span> <span class="n">host_steady_time</span><span class="p">;</span>
  <span class="n">host</span><span class="o">-&gt;</span><span class="n">extension</span>    <span class="o">=</span> <span class="n">host_extension</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">struct</span> <span class="n">clap_host</span> <span class="n">host</span><span class="p">;</span>
  <span class="n">initialize_host</span><span class="p">(</span><span class="o">&amp;</span><span class="n">host</span><span class="p">);</span>

  <span class="kt">void</span> <span class="o">*</span> <span class="n">handle</span> <span class="o">=</span> <span class="n">dlopen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RTLD_NOW</span> <span class="o">|</span> <span class="n">RTLD_LOCAL</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">handle</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;failed to load %s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dlerror</span><span class="p">());</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">union</span> <span class="p">{</span>
    <span class="kt">void</span>          <span class="o">*</span><span class="n">ptr</span><span class="p">;</span>
    <span class="n">clap_create_f</span>  <span class="n">clap_create</span><span class="p">;</span>
  <span class="p">}</span> <span class="n">symbol</span><span class="p">;</span>

  <span class="n">symbol</span><span class="p">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">dlsym</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s">&quot;clap_create&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">symbol</span><span class="p">.</span><span class="n">ptr</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;symbol not found: clap_create</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kt">uint32_t</span> <span class="n">plugin_count</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">uint32_t</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">plugin_count</span><span class="p">;</span> <span class="o">++</span><span class="n">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span> <span class="o">=</span> <span class="n">symbol</span><span class="p">.</span><span class="n">clap_create</span><span class="p">(</span>
      <span class="n">index</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">host</span><span class="p">,</span> <span class="mi">48000</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">plugin_count</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">plugin</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;failed to create plugin index %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>

<span class="cp">#define print_attr(Attr)                                                \
    do {                                                                \
      plugin-&gt;get_attribute(                                            \
        plugin, CLAP_ATTR_##Attr, buffer, sizeof (buffer));             \
      fprintf(stdout, &quot; %s: %s\n&quot;, CLAP_ATTR_##Attr, buffer);           \
    } while (0)
</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">ID</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">NAME</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">DESCRIPTION</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">MANUFACTURER</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">VERSION</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">URL</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">SUPPORT</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">LICENSE</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">CATEGORIES</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">TYPE</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">CHUNK_SIZE</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">LATENCY</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">SUPPORTS_TUNING</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">SUPPORTS_IN_PLACE_PROCESSING</span><span class="p">);</span>
    <span class="n">print_attr</span><span class="p">(</span><span class="n">IS_REMOTE_PROCESSING</span><span class="p">);</span>

<span class="cp">#undef print_attr
</span>
    <span class="c1">// destroy the plugin
</span>    <span class="n">plugin</span><span class="o">-&gt;</span><span class="n">destroy</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">dlclose</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id49">References</a></h1>
<div class="section" id="clap-clap-h">
<h2><a class="toc-backref" href="#id50">clap/clap.h</a></h2>
<pre class="code c literal-block">
<span class="cm">/*
 * CLAP - CLever Audio Plugin (&lt;--- needs to find a marketing ok name)
 * ~~~~~~~~~~~~~~~~~~~~~~~~~~
 *
 * Copyright (c) 2014 Alexandre BIQUE &lt;bique.alexandre&#64;gmail.com&gt;
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the &quot;Software&quot;), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */</span>

<span class="cp">#ifndef CLAP_H
# define CLAP_H
</span>
<span class="cp"># ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<span class="cp"># endif
</span>
<span class="cp"># include &lt;stddef.h&gt;
# include &lt;stdbool.h&gt;
# include &lt;stdint.h&gt;
</span>
<span class="cp"># define CLAP_VERSION_MAKE(Major, Minor, Revision) \
  ((((Major) &amp; 0xff) &lt;&lt; 16) | (((Minor) &amp; 0xff) &lt;&lt; 8) | ((Revision) &amp; 0xff))
# define CLAP_VERSION CLAP_VERSION_MAKE(1, 0, 0)
# define CLAP_VERSION_MAJ(Version) (((Version) &gt;&gt; 16) &amp; 0xff)
# define CLAP_VERSION_MIN(Version) (((Version) &gt;&gt; 8) &amp; 0xff)
# define CLAP_VERSION_REV(Version) ((Version) &amp; 0xff)
</span>
<span class="c1">///////////////////////////
// FORWARD DELCLARATIONS //
///////////////////////////
</span>
<span class="k">struct</span> <span class="n">clap_plugin</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">clap_host</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">clap_string_size</span>
<span class="p">{</span>
  <span class="n">CLAP_ID_SIZE</span>         <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
  <span class="n">CLAP_NAME_SIZE</span>       <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
  <span class="n">CLAP_DESC_SIZE</span>       <span class="o">=</span> <span class="mi">256</span><span class="p">,</span>
  <span class="n">CLAP_DISPLAY_SIZE</span>    <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
  <span class="n">CLAP_TAGS_SIZE</span>       <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
  <span class="n">CLAP_URL_SIZE</span>        <span class="o">=</span> <span class="mi">256</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">clap_log_severity</span>
<span class="p">{</span>
  <span class="n">CLAP_LOG_DEBUG</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_LOG_INFO</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
  <span class="n">CLAP_LOG_WARNING</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
  <span class="n">CLAP_LOG_ERROR</span>   <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
  <span class="n">CLAP_LOG_FATAL</span>   <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp"># define CLAP_ATTR_ID              &quot;clap/id&quot;
# define CLAP_ATTR_NAME            &quot;clap/name&quot;
# define CLAP_ATTR_DESCRIPTION     &quot;clap/description&quot;
# define CLAP_ATTR_VERSION         &quot;clap/version&quot;
# define CLAP_ATTR_MANUFACTURER    &quot;clap/manufacturer&quot;
# define CLAP_ATTR_URL             &quot;clap/url&quot;
# define CLAP_ATTR_SUPPORT         &quot;clap/support&quot;
# define CLAP_ATTR_LICENSE         &quot;clap/license&quot;
# define CLAP_ATTR_CATEGORIES      &quot;clap/categories&quot;
# define CLAP_ATTR_TYPE            &quot;clap/type&quot;
# define CLAP_ATTR_CHUNK_SIZE      &quot;clap/chunk_size&quot;
# define CLAP_ATTR_LATENCY         &quot;clap/latency&quot;
</span><span class="c1">// Should be &quot;1&quot; if the plugin supports tunning.
</span><span class="cp"># define CLAP_ATTR_SUPPORTS_TUNING &quot;clap/supports_tuning&quot;
</span><span class="c1">// Shoudl be &quot;1&quot; if the plugin is doing remote processing.
// This is a hint for the host to optimize task scheduling.
</span><span class="cp"># define CLAP_ATTR_IS_REMOTE_PROCESSING &quot;clap/is_remote_processing&quot;
</span><span class="c1">// Should be &quot;1&quot; if the plugin supports in place processing.
</span><span class="cp"># define CLAP_ATTR_SUPPORTS_IN_PLACE_PROCESSING &quot;clap/supports_in_place_processing&quot;
</span>
<span class="c1">////////////////
// PARAMETERS //
////////////////
</span>
<span class="k">union</span> <span class="n">clap_param_value</span>
<span class="p">{</span>
  <span class="kt">bool</span>    <span class="n">b</span><span class="p">;</span>
  <span class="kt">float</span>   <span class="n">f</span><span class="p">;</span>
  <span class="kt">int32_t</span> <span class="n">i</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">////////////
// EVENTS //
////////////
</span>
<span class="k">enum</span> <span class="n">clap_event_type</span>
<span class="p">{</span>
  <span class="n">CLAP_EVENT_NOTE_ON</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// note attribute
</span>  <span class="n">CLAP_EVENT_NOTE_OFF</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// note attribute
</span>
  <span class="n">CLAP_EVENT_PARAM_SET</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>    <span class="c1">// param attribute
</span>  <span class="n">CLAP_EVENT_PARAM_RAMP</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>    <span class="c1">// param attribute
</span>  <span class="n">CLAP_EVENT_PRESET_SET</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>    <span class="c1">// preset attribute
</span>
  <span class="n">CLAP_EVENT_MIDI</span>    <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>       <span class="c1">// midi attribute
</span>  <span class="n">CLAP_EVENT_CONTROL</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>       <span class="c1">// control attribute
</span>
  <span class="n">CLAP_EVENT_GUI_OPENED</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>   <span class="c1">// plugin to host, no attribute
</span>  <span class="n">CLAP_EVENT_GUI_CLOSED</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>   <span class="c1">// plugin to host, no attribute
</span>
  <span class="n">CLAP_EVENT_NEW_PRESETS</span>       <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="c1">// plugin to host, no attribute
</span>  <span class="n">CLAP_EVENT_NEW_PORTS_CONFIGS</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="c1">// plugin to host, no attribute
</span>
  <span class="n">CLAP_EVENT_LATENCY_CHANGED</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="c1">// plugin to host, latency attribute
</span>
  <span class="n">CLAP_EVENT_PLAY</span>  <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="c1">// no attribute
</span>  <span class="n">CLAP_EVENT_PAUSE</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="c1">// no attribute
</span>  <span class="n">CLAP_EVENT_STOP</span>  <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="c1">// no attribute
</span>
  <span class="n">CLAP_EVENT_JUMP</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="c1">// attribute jump
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_note</span>
<span class="p">{</span>
  <span class="kt">uint8_t</span> <span class="n">key</span><span class="p">;</span>
  <span class="kt">float</span>   <span class="n">pitch</span><span class="p">;</span>
  <span class="kt">float</span>   <span class="n">velocity</span><span class="p">;</span> <span class="c1">// 0..1
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_param</span>
<span class="p">{</span>
  <span class="cm">/* key/voice index */</span>
  <span class="kt">bool</span>                    <span class="n">is_global</span><span class="p">;</span> <span class="c1">// is this event global?
</span>  <span class="kt">uint8_t</span>                 <span class="n">key</span><span class="p">;</span>       <span class="c1">// if !is_global, target key
</span>
  <span class="cm">/* parameter */</span>
  <span class="kt">uint32_t</span>                <span class="n">index</span><span class="p">;</span> <span class="c1">// parameter index
</span>  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">value</span><span class="p">;</span>
  <span class="kt">float</span>                   <span class="n">increment</span><span class="p">;</span>        <span class="c1">// for param ramp
</span>  <span class="kt">char</span>                    <span class="n">display_text</span><span class="p">[</span><span class="n">CLAP_DISPLAY_SIZE</span><span class="p">];</span> <span class="c1">// use this for display.
</span>  <span class="kt">bool</span>                    <span class="n">is_recordable</span><span class="p">;</span>    <span class="c1">// used to tell the host if this event
</span>                                            <span class="c1">// can be recorded
</span>  <span class="kt">bool</span>                    <span class="n">is_used</span><span class="p">;</span> <span class="c1">// is the parameter used in the patch?
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_control</span>
<span class="p">{</span>
  <span class="cm">/* voice/key index */</span>
  <span class="kt">bool</span>     <span class="n">is_global</span><span class="p">;</span> <span class="c1">// is this event global?
</span>  <span class="kt">uint8_t</span>  <span class="n">key</span><span class="p">;</span>       <span class="c1">// if !is_global, target key
</span>
  <span class="cm">/* control */</span>
  <span class="kt">uint32_t</span> <span class="n">index</span><span class="p">;</span>
  <span class="kt">float</span>    <span class="n">value</span><span class="p">;</span> <span class="c1">// 0 .. 1.0f
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_preset</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">url</span><span class="p">[</span><span class="n">CLAP_URL_SIZE</span><span class="p">];</span> <span class="c1">// the url to the preset
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_midi</span>
<span class="p">{</span>
  <span class="cm">/* voice/key index */</span>
  <span class="kt">bool</span>           <span class="n">is_global</span><span class="p">;</span> <span class="c1">// is this event global?
</span>  <span class="kt">uint8_t</span>        <span class="n">key</span><span class="p">;</span>       <span class="c1">// if !is_global, target key
</span>
  <span class="cm">/* midi event */</span>
  <span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>
  <span class="kt">uint32_t</span>       <span class="n">size</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_latency</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">latency</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event_jump</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">tempo</span><span class="p">;</span>      <span class="c1">// tempo in samples
</span>  <span class="kt">uint32_t</span> <span class="n">bar</span><span class="p">;</span>        <span class="c1">// the bar number
</span>  <span class="kt">uint32_t</span> <span class="n">bar_offset</span><span class="p">;</span> <span class="c1">// 0 &lt;= cycle_offset &lt; tsig_denom * tempo
</span>  <span class="kt">uint32_t</span> <span class="n">tsig_num</span><span class="p">;</span>   <span class="c1">// time signature numerator
</span>  <span class="kt">uint32_t</span> <span class="n">tsig_denom</span><span class="p">;</span> <span class="c1">// time signature denominator
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_event</span>
<span class="p">{</span>
  <span class="k">struct</span> <span class="n">clap_event</span>    <span class="o">*</span><span class="n">next</span><span class="p">;</span> <span class="c1">// linked list, NULL on end
</span>  <span class="k">enum</span> <span class="n">clap_event_type</span>  <span class="n">type</span><span class="p">;</span>
  <span class="kt">uint64_t</span>              <span class="n">steady_time</span><span class="p">;</span> <span class="c1">// steady_time of the event, see host-&gt;steady_time(host)
</span>
  <span class="k">union</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">clap_event_note</span>        <span class="n">note</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_param</span>       <span class="n">param</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_preset</span>      <span class="n">preset</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_midi</span>        <span class="n">midi</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_control</span>     <span class="n">control</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_latency</span>     <span class="n">latency</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">clap_event_jump</span>        <span class="n">jump</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="c1">/////////////
// PROCESS //
/////////////
</span>
<span class="k">enum</span> <span class="n">clap_process_status</span>
<span class="p">{</span>
  <span class="cm">/* Processing failed. The output buffer must be discarded. */</span>
  <span class="n">CLAP_PROCESS_ERROR</span>    <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

  <span class="cm">/* Processing succeed. */</span>
  <span class="n">CLAP_PROCESS_CONTINUE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>

  <span class="cm">/* Processing succeed, but no more processing is required, until next event. */</span>
  <span class="n">CLAP_PROCESS_STOP</span>     <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_process</span>
<span class="p">{</span>
  <span class="cm">/* audio buffers */</span>
  <span class="kt">float</span>    <span class="o">**</span><span class="n">input</span><span class="p">;</span>
  <span class="kt">float</span>    <span class="o">**</span><span class="n">output</span><span class="p">;</span>
  <span class="kt">uint32_t</span>   <span class="n">samples_count</span><span class="p">;</span>

  <span class="cm">/* process info */</span>
  <span class="kt">uint64_t</span> <span class="n">steady_time</span><span class="p">;</span> <span class="c1">// the steady time in samples
</span>
  <span class="cm">/* events */</span>
  <span class="k">struct</span> <span class="n">clap_event</span> <span class="o">*</span><span class="n">events</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">//////////
// HOST //
//////////
</span>
<span class="k">struct</span> <span class="n">clap_host</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">clap_version</span><span class="p">;</span> <span class="c1">// initialized to CLAP_VERSION
</span>
  <span class="cm">/* returns the size of the original string, 0 if not string */</span>
  <span class="kt">uint32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_attribute</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                            <span class="k">const</span> <span class="kt">char</span>       <span class="o">*</span><span class="n">attr</span><span class="p">,</span>
                            <span class="kt">char</span>             <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
                            <span class="kt">uint32_t</span>          <span class="n">size</span><span class="p">);</span>

  <span class="cm">/* for events generated by the plugin. */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">events</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span>   <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                 <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                 <span class="k">struct</span> <span class="n">clap_event</span>  <span class="o">*</span><span class="n">events</span><span class="p">);</span>

  <span class="cm">/* The time in samples, this clock is monotonicaly increasing,
   * it means that each time you call this function, the return
   * value must be greater or equal to the previous one. */</span>
  <span class="kt">uint64_t</span> <span class="p">(</span><span class="o">*</span><span class="n">steady_time</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">);</span>

  <span class="cm">/* Log a message through the host. */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">log</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span>       <span class="o">*</span><span class="n">host</span><span class="p">,</span>
              <span class="k">struct</span> <span class="n">clap_plugin</span>     <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
              <span class="k">enum</span> <span class="n">clap_log_severity</span>  <span class="n">severity</span><span class="p">,</span>
              <span class="k">const</span> <span class="kt">char</span>             <span class="o">*</span><span class="n">msg</span><span class="p">);</span>

  <span class="cm">/* feature extensions */</span>
  <span class="kt">void</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">extension</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extention_id</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">////////////
// PLUGIN //
////////////
</span>
<span class="c1">// bitfield
</span><span class="k">enum</span> <span class="n">clap_plugin_type</span>
<span class="p">{</span>
  <span class="n">CLAP_PLUGIN_INSTRUMENT</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">),</span>
  <span class="n">CLAP_PLUGIN_EFFECT</span>       <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">),</span>
  <span class="n">CLAP_PLUGIN_EVENT_EFFECT</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">),</span> <span class="c1">// can be seen as midi effect
</span>  <span class="n">CLAP_PLUGIN_ANALYZER</span>     <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_plugin</span>
<span class="p">{</span>
  <span class="kt">uint32_t</span> <span class="n">clap_version</span><span class="p">;</span> <span class="c1">// initialized to CALP_VERSION
</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">host_data</span><span class="p">;</span>   <span class="c1">// reserved pointer for the host
</span>  <span class="kt">void</span> <span class="o">*</span><span class="n">plugin_data</span><span class="p">;</span> <span class="c1">// reserved pointer for the plugin
</span>
  <span class="cm">/* Free the plugin and its resources.
   * It is not required to deactivate the plugin prior to this call. */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">destroy</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

  <span class="cm">/* Copy at most size of the attribute's value into buffer.
   * This function must place a '\0' byte at the end of the string.
   * Returns the size of the original string or 0 if there is no
   * value for this attributes. */</span>
  <span class="kt">uint32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_attribute</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                            <span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="n">attr</span><span class="p">,</span>
                            <span class="kt">char</span>               <span class="o">*</span><span class="n">buffer</span><span class="p">,</span>
                            <span class="kt">uint32_t</span>            <span class="n">size</span><span class="p">);</span>

  <span class="cm">/* activation */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">activate</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">deactivate</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

  <span class="cm">/* process */</span>
  <span class="k">enum</span> <span class="nf">clap_process_status</span> <span class="p">(</span><span class="o">*</span><span class="n">process</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>  <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                                      <span class="k">struct</span> <span class="n">clap_process</span> <span class="o">*</span><span class="n">process</span><span class="p">);</span>

  <span class="cm">/* features extensions */</span>
  <span class="kt">void</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">extension</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* typedef for dlsym() cast */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">clap_create_f</span><span class="p">)(</span><span class="kt">uint32_t</span>          <span class="n">plugin_index</span><span class="p">,</span>
                                             <span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
                                             <span class="kt">uint32_t</span>          <span class="n">sample_rate</span><span class="p">,</span>
                                             <span class="kt">uint32_t</span>         <span class="o">*</span><span class="n">plugins_count</span><span class="p">);</span>

<span class="cm">/* Plugin entry point. If plugins_count is not null, then clap_create has
 * to store the number of plugins available in *plugins_count.
 * If clap_create failed to create a plugin, it returns NULL.
 * The return value has to be freed by calling plugin-&gt;destroy(plugin).
 *
 * This function must be thread-safe. */</span>
<span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span>
<span class="nf">clap_create</span><span class="p">(</span><span class="kt">uint32_t</span>          <span class="n">plugin_index</span><span class="p">,</span>
            <span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span>
            <span class="kt">uint32_t</span>          <span class="n">sample_rate</span><span class="p">,</span>
            <span class="kt">uint32_t</span>         <span class="o">*</span><span class="n">plugins_count</span><span class="p">);</span>

<span class="cp"># ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp"># endif
</span>
<span class="cp">#endif </span><span class="cm">/* !CLAP_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-ports-h">
<h2><a class="toc-backref" href="#id51">clap/ext/ports.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_PORTS_H
# define CLAP_EXT_PORTS_H
</span>
<span class="cp"># include &quot;../clap.h&quot;
</span>
<span class="cp"># define CLAP_EXT_PORTS &quot;clap/ports&quot;
</span>
<span class="k">enum</span> <span class="n">clap_port_type</span>
<span class="p">{</span>
  <span class="n">CLAP_PORT_MONO</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_PORT_STEREO</span>   <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
  <span class="n">CLAP_PORT_SURROUND</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">clap_port_role</span>
<span class="p">{</span>
  <span class="n">CLAP_PORT_INOUT</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_PORT_SIDECHAIN</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_port_info</span>
<span class="p">{</span>
  <span class="k">enum</span> <span class="n">clap_port_type</span>  <span class="n">type</span><span class="p">;</span>
  <span class="k">enum</span> <span class="n">clap_port_role</span>  <span class="n">role</span><span class="p">;</span>
  <span class="kt">char</span>                 <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">bool</span>                 <span class="n">is_repeatable</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_ports_config</span>
<span class="p">{</span>
  <span class="kt">char</span>     <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">uint32_t</span> <span class="n">inputs_count</span><span class="p">;</span>
  <span class="kt">uint32_t</span> <span class="n">outputs_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* The audio ports configuration has to be done while the plugin is
 * deactivated. */</span>
<span class="k">struct</span> <span class="n">clap_plugin_ports</span>
<span class="p">{</span>
  <span class="cm">/* Returns the number of available configurations */</span>
  <span class="kt">uint32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">get_configs_count</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_config</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>       <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                     <span class="kt">uint32_t</span>                  <span class="n">config_index</span><span class="p">,</span>
                     <span class="k">struct</span> <span class="n">clap_ports_config</span> <span class="o">*</span><span class="n">config</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get_info</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>    <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                   <span class="kt">uint32_t</span>               <span class="n">config_index</span><span class="p">,</span>
                   <span class="kt">uint32_t</span>               <span class="n">port_index</span><span class="p">,</span>
                   <span class="k">struct</span> <span class="n">clap_port_info</span> <span class="o">*</span><span class="n">port</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">set_config</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                     <span class="kt">uint32_t</span>            <span class="n">config_index</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">set_repeat</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>  <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                     <span class="kt">uint32_t</span>             <span class="n">port_index</span><span class="p">,</span>
                     <span class="kt">uint32_t</span>             <span class="n">count</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_PORT_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-gui-h">
<h2><a class="toc-backref" href="#id52">clap/ext/gui.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_GUI_H
# define CLAP_EXT_GUI_H
</span>
<span class="cp"># include &quot;../clap.h&quot;
</span>
<span class="cp"># define CLAP_EXT_GUI &quot;clap/gui&quot;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_gui</span>
<span class="p">{</span>
  <span class="cm">/* gui */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">open</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">close</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_GUI_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-state-h">
<h2><a class="toc-backref" href="#id53">clap/ext/state.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_STATE_H
# define CLAP_EXT_STATE_H
</span>
<span class="cp"># include &quot;../clap.h&quot;
</span>
<span class="cp"># define CLAP_EXT_STATE &quot;clap/state&quot;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_state</span>
<span class="p">{</span>
  <span class="cm">/* The plugin has to allocate and save its state into *buffer.
   * The plugin is also responsible to free the buffer on the
   * next call to save() or when the plugin is destroyed. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">save</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">size</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">restore</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">size</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_STATE_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-params-h">
<h2><a class="toc-backref" href="#id54">clap/ext/params.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_PARAMS_H
# define CLAP_EXT_PARAMS_H
</span>
<span class="cp"># include &quot;../clap.h&quot;
</span>
<span class="cp"># define CLAP_EXT_PARAMS &quot;clap/params&quot;
</span>
<span class="k">enum</span> <span class="n">clap_param_type</span>
<span class="p">{</span>
  <span class="n">CLAP_PARAM_GROUP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// no value for this one
</span>  <span class="n">CLAP_PARAM_BOOL</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// uses value.b
</span>  <span class="n">CLAP_PARAM_FLOAT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">// uses value.f
</span>  <span class="n">CLAP_PARAM_INT</span>   <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">// uses value.i
</span>  <span class="n">CLAP_PARAM_ENUM</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="c1">// uses value.i
</span><span class="p">};</span>

<span class="k">enum</span> <span class="n">clap_param_scale</span>
<span class="p">{</span>
  <span class="n">CLAP_PARAM_LINEAR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">CLAP_PARAM_LOG</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_param</span>
<span class="p">{</span>
  <span class="cm">/* tree fields */</span>
  <span class="kt">uint32_t</span> <span class="n">index</span><span class="p">;</span>  <span class="c1">// parameter's index
</span>  <span class="kt">uint32_t</span> <span class="n">parent</span><span class="p">;</span> <span class="c1">// parent's index, -1 for no parent
</span>
  <span class="cm">/* param info */</span>
  <span class="kt">char</span>                    <span class="n">id</span><span class="p">[</span><span class="n">CLAP_ID_SIZE</span><span class="p">];</span> <span class="c1">// a string which identify the param
</span>  <span class="kt">char</span>                    <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span> <span class="c1">// the display name
</span>  <span class="kt">char</span>                    <span class="n">desc</span><span class="p">[</span><span class="n">CLAP_DESC_SIZE</span><span class="p">];</span>
  <span class="kt">char</span>                    <span class="n">display</span><span class="p">[</span><span class="n">CLAP_DISPLAY_SIZE</span><span class="p">];</span> <span class="c1">// the text used to display the value
</span>  <span class="k">enum</span> <span class="n">clap_param_type</span>    <span class="n">type</span><span class="p">;</span>
  <span class="kt">bool</span>                    <span class="n">is_per_note</span><span class="p">;</span>
  <span class="kt">bool</span>                    <span class="n">is_used</span><span class="p">;</span> <span class="c1">// is this parameter used by the patch?
</span>  <span class="kt">bool</span>                    <span class="n">is_periodic</span><span class="p">;</span>
  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">value</span><span class="p">;</span>
  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">min</span><span class="p">;</span>
  <span class="k">union</span> <span class="n">clap_param_value</span>  <span class="n">max</span><span class="p">;</span>
  <span class="k">enum</span> <span class="n">clap_param_scale</span>   <span class="n">scale</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_plugin_params</span>
<span class="p">{</span>
  <span class="cm">/* Returns the number of parameters. */</span>
  <span class="kt">uint32_t</span> <span class="p">(</span><span class="o">*</span><span class="n">count</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>

  <span class="cm">/* Copies the parameter's info to param and returns true.
   * If index is greater or equal to the number then return false. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
              <span class="kt">uint32_t</span>            <span class="n">index</span><span class="p">,</span>
              <span class="k">struct</span> <span class="n">clap_param</span>  <span class="o">*</span><span class="n">param</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_PARAMS_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-presets-h">
<h2><a class="toc-backref" href="#id55">clap/ext/presets.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_PRESETS_H
# define CLAP_EXT_PRESETS_H
</span>
<span class="cp"># include &quot;../clap.h&quot;
</span>
<span class="cp"># define CLAP_EXT_PRESETS &quot;clap/presets&quot;
</span>
<span class="k">struct</span> <span class="n">clap_preset</span>
<span class="p">{</span>
  <span class="kt">char</span>     <span class="n">url</span><span class="p">[</span><span class="n">CLAP_URL_SIZE</span><span class="p">];</span>     <span class="c1">// location to the patch
</span>  <span class="kt">char</span>     <span class="n">name</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>   <span class="c1">// display name
</span>  <span class="kt">char</span>     <span class="n">desc</span><span class="p">[</span><span class="n">CLAP_DESC_SIZE</span><span class="p">];</span>   <span class="c1">// desc and how to use it
</span>  <span class="kt">char</span>     <span class="n">author</span><span class="p">[</span><span class="n">CLAP_NAME_SIZE</span><span class="p">];</span>
  <span class="kt">char</span>     <span class="n">tags</span><span class="p">[</span><span class="n">CLAP_TAGS_SIZE</span><span class="p">];</span>   <span class="c1">// &quot;tag1;tag2;tag3;...&quot;
</span>  <span class="kt">uint8_t</span>  <span class="n">score</span><span class="p">;</span>                  <span class="c1">// 0 = garbage, ..., 4 = favorite
</span><span class="p">};</span>

<span class="k">struct</span> <span class="n">clap_preset_iterator</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">clap_plugin_presets</span>
<span class="p">{</span>
  <span class="cm">/* Allocate a new preset iterator positioned at the beginning of the
   * preset collection, store its pointer into (*iter).
   * Returns true on success, false otherwise.
   * If the collection is empty, then it must return false and (*iter)
   * should be NULL. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">iter_begin</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>             <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                     <span class="k">struct</span> <span class="n">clap_preset_iterator</span>   <span class="o">**</span><span class="n">iter</span><span class="p">);</span>

  <span class="cm">/* Iterate to the next value. If the iterator reached the end of the
   * collection, returns false.
   * Returns true on success. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">iter_next</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>              <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                    <span class="k">struct</span> <span class="n">clap_preset_iterator</span>     <span class="o">*</span><span class="n">iter</span><span class="p">);</span>

  <span class="cm">/* Release the iterator.
   * If iter is NULL, then do nothing. */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">iter_destroy</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>           <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                       <span class="k">struct</span> <span class="n">clap_preset_iterator</span>  <span class="o">*</span><span class="n">iter</span><span class="p">);</span>

  <span class="cm">/* Get preset at the current iterator position.
   * Returns true on success, false otherwise. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">iter_get</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span>               <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                   <span class="k">struct</span> <span class="n">clap_preset_iterator</span>      <span class="o">*</span><span class="n">iter</span><span class="p">,</span>
                   <span class="k">struct</span> <span class="n">clap_preset</span>               <span class="o">*</span><span class="n">preset</span><span class="p">);</span>

  <span class="cm">/* Get a preset info by its URL and returns true.
   * If the preset is not found, then it should return false. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">get</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
              <span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="n">url</span><span class="p">,</span>
              <span class="k">struct</span> <span class="n">clap_preset</span> <span class="o">*</span><span class="n">preset</span><span class="p">);</span>

  <span class="cm">/* Set the preset score. */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_score</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                    <span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="n">url</span><span class="p">,</span>
                    <span class="kt">uint8_t</span>             <span class="n">score</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_PRESETS_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-embed-h">
<h2><a class="toc-backref" href="#id56">clap/ext/embed.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_EMBED_H
# define CLAP_EXT_EMBED_H
</span>
<span class="cp"># include &quot;../clap.h&quot;
</span>
<span class="cp"># define CLAP_EXT_EMBED &quot;clap/embed&quot;
</span>
<span class="k">struct</span> <span class="n">clap_host_embed</span>
<span class="p">{</span>
  <span class="cm">/* Request the host to resize the client area to width, height.
   * Return true on success, false otherwise. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">resize</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_host</span> <span class="o">*</span><span class="n">host</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">width</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">height</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_EMBED_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-embed-win32-h">
<h2><a class="toc-backref" href="#id57">clap/ext/embed-win32.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_EMBED_WIN32_H
# define CLAP_EXT_EMBED_WIN32_H
</span>
<span class="cp"># include &lt;windows.h&gt;
</span>
<span class="cp"># include &quot;../clap.h&quot;
# include &quot;embed.h&quot;
</span>
<span class="cp"># define CLAP_EXT_EMBED_WIN32 &quot;clap/embed/win32&quot;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_embed_win32</span>
<span class="p">{</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_size</span><span class="p">)(</span><span class="kt">uint32_t</span> <span class="o">*</span><span class="n">width</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">height</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">attach</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span> <span class="n">HWND</span> <span class="n">window</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">detach</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EXT_EMBED_WIN32_H */</span>
</pre>
</div>
<div class="section" id="clap-ext-embed-xlib-h">
<h2><a class="toc-backref" href="#id58">clap/ext/embed-xlib.h</a></h2>
<pre class="code c literal-block">
<span class="cp">#ifndef CLAP_EXT_EMBED_XLIB_H
# define CLAP_EXT_EMBED_XLIB_H
</span>
<span class="cp"># include &lt;X11/Xlib.h&gt;
</span>
<span class="cp"># include &quot;../clap.h&quot;
# include &quot;embed.h&quot;
</span>
<span class="cp"># define CLAP_EXT_EMBED_XLIB &quot;clap/embed/xlib&quot;
</span>
<span class="k">struct</span> <span class="n">clap_plugin_embed_xlib</span>
<span class="p">{</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_size</span><span class="p">)(</span><span class="kt">uint32_t</span> <span class="o">*</span><span class="n">width</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">height</span><span class="p">);</span>

  <span class="cm">/* Note for the client, you can get a Display* by calling
   * XOpenDisplay(display_name).
   *
   * Note for the host, the display_name can be retrieved from your own
   * display-&gt;display_name. */</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">attach</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">,</span>
                 <span class="n">Window</span>              <span class="n">window</span><span class="p">,</span>
                 <span class="k">const</span> <span class="kt">char</span>         <span class="o">*</span><span class="n">display_name</span><span class="p">);</span>
  <span class="kt">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">detach</span><span class="p">)(</span><span class="k">struct</span> <span class="n">clap_plugin</span> <span class="o">*</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !CLAP_EMBED_XLIB_H */</span>
</pre>
</div>
</div>
</div>
</body>
</html>
